{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\thato\\\\Downloads\\\\car-app\\\\src\\\\components\\\\messages\\\\MessagesView.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef, useMemo } from 'react';\nimport { motion } from 'framer-motion';\nimport { MessageCircle, Search, Send, User, ArrowLeft, Check, CheckCheck, Phone, Video, Info } from 'lucide-react';\nimport { useApp } from '../../context/AppContext.tsx';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport function MessagesView() {\n  _s();\n  var _state$currentUser7, _state$currentUser9, _state$currentUser1;\n  const {\n    state,\n    sendMessage,\n    markMessagesAsRead\n  } = useApp();\n  const [selectedConversation, setSelectedConversation] = useState(null);\n  const [messageText, setMessageText] = useState('');\n  const [searchTerm, setSearchTerm] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [typingUsers, setTypingUsers] = useState([]);\n  const [isTyping, setIsTyping] = useState(false);\n  const messagesEndRef = useRef(null);\n  const typingTimeoutRef = useRef();\n\n  // Debug logging\n  useEffect(() => {\n    var _state$currentUser;\n    console.log('🔍 MessagesView Debug:', {\n      messagesCount: state.messages.length,\n      usersCount: state.users.length,\n      currentUser: (_state$currentUser = state.currentUser) === null || _state$currentUser === void 0 ? void 0 : _state$currentUser.username,\n      messages: state.messages.slice(0, 3).map(m => ({\n        id: m.id,\n        senderId: m.senderId,\n        receiverId: m.receiverId,\n        content: m.content.substring(0, 30) + '...'\n      })),\n      users: state.users.slice(0, 5).map(u => ({\n        id: u.id,\n        username: u.username\n      }))\n    });\n  }, [state.messages, state.users, state.currentUser]);\n\n  // Auto-scroll to bottom when new messages arrive\n  useEffect(() => {\n    // Use setTimeout to ensure DOM has been updated before scrolling\n    const timeoutId = setTimeout(() => {\n      scrollToBottom();\n    }, 50); // Reduced delay for smoother experience\n\n    return () => clearTimeout(timeoutId);\n  }, [state.messages, selectedConversation]);\n\n  // Scroll to bottom when conversation is first selected\n  useEffect(() => {\n    if (selectedConversation) {\n      const timeoutId = setTimeout(() => {\n        scrollToBottom();\n      }, 100);\n      return () => clearTimeout(timeoutId);\n    }\n  }, [selectedConversation]);\n\n  // Clean up typing indicators that are too old\n  useEffect(() => {\n    const interval = setInterval(() => {\n      const now = Date.now();\n      setTypingUsers(prev => prev.filter(typing => now - typing.timestamp < 3000));\n    }, 1000);\n    return () => clearInterval(interval);\n  }, []);\n  const scrollToBottom = () => {\n    if (messagesEndRef.current) {\n      messagesEndRef.current.scrollIntoView({\n        behavior: 'smooth',\n        block: 'end',\n        inline: 'nearest'\n      });\n    }\n  };\n\n  // Create conversations from messages\n  const conversations = useMemo(() => {\n    const convMap = new Map();\n    state.messages.forEach(message => {\n      var _message$senderId, _message$senderId2, _message$receiverId, _message$receiverId2, _state$currentUser2, _state$currentUser3;\n      // Handle both string IDs and populated user objects\n      const messageSenderId = typeof message.senderId === 'string' ? message.senderId : ((_message$senderId = message.senderId) === null || _message$senderId === void 0 ? void 0 : _message$senderId.id) || ((_message$senderId2 = message.senderId) === null || _message$senderId2 === void 0 ? void 0 : _message$senderId2._id);\n      const messageReceiverId = typeof message.receiverId === 'string' ? message.receiverId : ((_message$receiverId = message.receiverId) === null || _message$receiverId === void 0 ? void 0 : _message$receiverId.id) || ((_message$receiverId2 = message.receiverId) === null || _message$receiverId2 === void 0 ? void 0 : _message$receiverId2._id);\n      const otherUserId = messageSenderId === ((_state$currentUser2 = state.currentUser) === null || _state$currentUser2 === void 0 ? void 0 : _state$currentUser2.id) ? messageReceiverId : messageSenderId;\n      const conversationId = [(_state$currentUser3 = state.currentUser) === null || _state$currentUser3 === void 0 ? void 0 : _state$currentUser3.id, otherUserId].sort().join('-');\n      if (!convMap.has(conversationId)) {\n        var _state$currentUser4;\n        convMap.set(conversationId, {\n          id: conversationId,\n          participants: [(_state$currentUser4 = state.currentUser) === null || _state$currentUser4 === void 0 ? void 0 : _state$currentUser4.id, otherUserId],\n          lastMessage: message,\n          unreadCount: 0,\n          updatedAt: message.timestamp\n        });\n      } else {\n        const existing = convMap.get(conversationId);\n        if (new Date(message.timestamp) > new Date(existing.lastMessage.timestamp)) {\n          existing.lastMessage = message;\n          existing.updatedAt = message.timestamp;\n        }\n      }\n    });\n\n    // Calculate unread counts\n    convMap.forEach(conversation => {\n      const unreadMessages = state.messages.filter(msg => {\n        var _msg$receiverId, _msg$receiverId2, _msg$senderId, _msg$senderId2, _state$currentUser5;\n        // Handle populated user objects in unread count calculation too\n        const msgReceiverId = typeof msg.receiverId === 'string' ? msg.receiverId : ((_msg$receiverId = msg.receiverId) === null || _msg$receiverId === void 0 ? void 0 : _msg$receiverId.id) || ((_msg$receiverId2 = msg.receiverId) === null || _msg$receiverId2 === void 0 ? void 0 : _msg$receiverId2._id);\n        const msgSenderId = typeof msg.senderId === 'string' ? msg.senderId : ((_msg$senderId = msg.senderId) === null || _msg$senderId === void 0 ? void 0 : _msg$senderId.id) || ((_msg$senderId2 = msg.senderId) === null || _msg$senderId2 === void 0 ? void 0 : _msg$senderId2._id);\n        return msgReceiverId === ((_state$currentUser5 = state.currentUser) === null || _state$currentUser5 === void 0 ? void 0 : _state$currentUser5.id) && !msg.read && (msgSenderId === conversation.participants[0] || msgSenderId === conversation.participants[1]);\n      });\n      conversation.unreadCount = unreadMessages.length;\n    });\n    const conversationsArray = Array.from(convMap.values()).sort((a, b) => new Date(b.updatedAt).getTime() - new Date(a.updatedAt).getTime());\n\n    // Debug: Check for missing users\n    const missingUsers = conversationsArray.map(conv => {\n      const otherUserId = conv.participants.find(p => {\n        var _state$currentUser6;\n        return p !== ((_state$currentUser6 = state.currentUser) === null || _state$currentUser6 === void 0 ? void 0 : _state$currentUser6.id);\n      });\n      const otherUser = state.users.find(u => u.id === otherUserId);\n      return {\n        otherUserId,\n        found: !!otherUser,\n        username: otherUser === null || otherUser === void 0 ? void 0 : otherUser.username\n      };\n    });\n    console.log('🔍 Conversations Debug:', {\n      conversationsCount: conversationsArray.length,\n      missingUsers: missingUsers.filter(u => !u.found),\n      allUserMappings: missingUsers\n    });\n    return conversationsArray;\n  }, [state.messages, (_state$currentUser7 = state.currentUser) === null || _state$currentUser7 === void 0 ? void 0 : _state$currentUser7.id, state.users]);\n\n  // Filter conversations based on search\n  const filteredConversations = useMemo(() => {\n    if (!searchTerm) return conversations;\n    return conversations.filter(conversation => {\n      const otherUserId = conversation.participants.find(p => {\n        var _state$currentUser8;\n        return p !== ((_state$currentUser8 = state.currentUser) === null || _state$currentUser8 === void 0 ? void 0 : _state$currentUser8.id);\n      });\n      const otherUser = state.users.find(u => u.id === otherUserId);\n      return otherUser === null || otherUser === void 0 ? void 0 : otherUser.username.toLowerCase().includes(searchTerm.toLowerCase());\n    });\n  }, [conversations, searchTerm, state.users, (_state$currentUser9 = state.currentUser) === null || _state$currentUser9 === void 0 ? void 0 : _state$currentUser9.id]);\n\n  // Get messages for selected conversation\n  const conversationMessages = useMemo(() => {\n    if (!selectedConversation) return [];\n    const conversation = conversations.find(c => c.id === selectedConversation);\n    if (!conversation) return [];\n    return state.messages.filter(msg => {\n      var _msg$senderId3, _msg$senderId4, _msg$receiverId3, _msg$receiverId4;\n      // Handle populated user objects\n      const msgSenderId = typeof msg.senderId === 'string' ? msg.senderId : ((_msg$senderId3 = msg.senderId) === null || _msg$senderId3 === void 0 ? void 0 : _msg$senderId3.id) || ((_msg$senderId4 = msg.senderId) === null || _msg$senderId4 === void 0 ? void 0 : _msg$senderId4._id);\n      const msgReceiverId = typeof msg.receiverId === 'string' ? msg.receiverId : ((_msg$receiverId3 = msg.receiverId) === null || _msg$receiverId3 === void 0 ? void 0 : _msg$receiverId3.id) || ((_msg$receiverId4 = msg.receiverId) === null || _msg$receiverId4 === void 0 ? void 0 : _msg$receiverId4._id);\n      const participants = conversation.participants;\n      return msgSenderId === participants[0] && msgReceiverId === participants[1] || msgSenderId === participants[1] && msgReceiverId === participants[0];\n    }).sort((a, b) => new Date(a.timestamp).getTime() - new Date(b.timestamp).getTime());\n  }, [selectedConversation, conversations, state.messages]);\n\n  // Get other user in selected conversation\n  const selectedConversationUser = useMemo(() => {\n    if (!selectedConversation) return null;\n    const conversation = conversations.find(c => c.id === selectedConversation);\n    if (!conversation) return null;\n    const otherUserId = conversation.participants.find(p => {\n      var _state$currentUser0;\n      return p !== ((_state$currentUser0 = state.currentUser) === null || _state$currentUser0 === void 0 ? void 0 : _state$currentUser0.id);\n    });\n    return state.users.find(u => u.id === otherUserId) || null;\n  }, [selectedConversation, conversations, state.users, (_state$currentUser1 = state.currentUser) === null || _state$currentUser1 === void 0 ? void 0 : _state$currentUser1.id]);\n  const handleSendMessage = async () => {\n    if (!messageText.trim() || !selectedConversationUser || loading) return;\n    setLoading(true);\n    try {\n      await sendMessage({\n        senderId: state.currentUser.id,\n        receiverId: selectedConversationUser.id,\n        content: messageText.trim()\n      });\n      setMessageText('');\n      setIsTyping(false);\n    } catch (error) {\n      console.error('Error sending message:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const handleKeyPress = e => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage();\n    }\n  };\n  const handleTyping = value => {\n    setMessageText(value);\n    if (value.trim() && !isTyping) {\n      setIsTyping(true);\n      // In a real app, you'd emit typing indicator to other users via WebSocket\n    }\n\n    // Clear typing indicator after 2 seconds of no typing\n    if (typingTimeoutRef.current) {\n      clearTimeout(typingTimeoutRef.current);\n    }\n    typingTimeoutRef.current = setTimeout(() => {\n      setIsTyping(false);\n    }, 2000);\n  };\n  const handleConversationSelect = async conversationId => {\n    setSelectedConversation(conversationId);\n\n    // Mark messages as read\n    const conversation = conversations.find(c => c.id === conversationId);\n    if (conversation && conversation.unreadCount > 0) {\n      try {\n        await markMessagesAsRead(conversationId);\n      } catch (error) {\n        console.error('Error marking messages as read:', error);\n      }\n    }\n  };\n  const formatTime = timestamp => {\n    const date = new Date(timestamp);\n    const now = new Date();\n    const diffInHours = (now.getTime() - date.getTime()) / (1000 * 60 * 60);\n    if (diffInHours < 24) {\n      return date.toLocaleTimeString([], {\n        hour: '2-digit',\n        minute: '2-digit'\n      });\n    } else if (diffInHours < 168) {\n      // 7 days\n      return date.toLocaleDateString([], {\n        weekday: 'short'\n      });\n    } else {\n      return date.toLocaleDateString([], {\n        month: 'short',\n        day: 'numeric'\n      });\n    }\n  };\n  const formatMessageTime = timestamp => {\n    return new Date(timestamp).toLocaleTimeString([], {\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n  const renderConversationsList = () => /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"w-full lg:w-96 border-r border-primary-700/30 flex flex-col\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"p-4 border-b border-primary-700/30\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-xl font-bold text-primary-100 mb-4\",\n        children: \"Messages\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 298,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative\",\n        children: [/*#__PURE__*/_jsxDEV(Search, {\n          className: \"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-primary-400\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 302,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          placeholder: \"Search conversations...\",\n          value: searchTerm,\n          onChange: e => setSearchTerm(e.target.value),\n          className: \"input-field pl-10 text-sm\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 303,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 301,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 297,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-1 overflow-y-auto\",\n      children: filteredConversations.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-4 text-center\",\n        children: [/*#__PURE__*/_jsxDEV(MessageCircle, {\n          className: \"w-12 h-12 mx-auto mb-4 text-primary-400\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 317,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-primary-300\",\n          children: \"No conversations yet\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 318,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-primary-400 mt-1\",\n          children: \"Start trading to begin messaging with other users\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 319,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-1 p-2\",\n        children: filteredConversations.map(conversation => {\n          const otherUserId = conversation.participants.find(p => {\n            var _state$currentUser10;\n            return p !== ((_state$currentUser10 = state.currentUser) === null || _state$currentUser10 === void 0 ? void 0 : _state$currentUser10.id);\n          });\n          const otherUser = state.users.find(u => u.id === otherUserId);\n          const isSelected = selectedConversation === conversation.id;\n          return /*#__PURE__*/_jsxDEV(motion.div, {\n            whileHover: {\n              scale: 1.02\n            },\n            whileTap: {\n              scale: 0.98\n            },\n            onClick: () => handleConversationSelect(conversation.id),\n            className: `p-3 rounded-lg cursor-pointer transition-all ${isSelected ? 'bg-primary-600/30 border border-primary-500/50' : 'hover:bg-primary-800/30'}`,\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center space-x-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"relative\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"w-12 h-12 bg-primary-800/50 rounded-full flex items-center justify-center\",\n                  children: otherUser !== null && otherUser !== void 0 && otherUser.avatar ? /*#__PURE__*/_jsxDEV(\"img\", {\n                    src: otherUser.avatar,\n                    alt: otherUser.username,\n                    className: \"w-full h-full object-cover rounded-full\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 347,\n                    columnNumber: 27\n                  }, this) : /*#__PURE__*/_jsxDEV(User, {\n                    className: \"w-6 h-6 text-primary-300\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 353,\n                    columnNumber: 27\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 345,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 344,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex-1 min-w-0\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center justify-between\",\n                  children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                    className: \"font-medium text-primary-100 truncate\",\n                    children: [\"@\", (otherUser === null || otherUser === void 0 ? void 0 : otherUser.username) || 'Unknown']\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 362,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-xs text-primary-400\",\n                    children: formatTime(conversation.lastMessage.timestamp)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 365,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 361,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center justify-between mt-1\",\n                  children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"text-sm text-primary-300 truncate\",\n                    children: [((_conversation$lastMes, _conversation$lastMes2, _state$currentUser11) => {\n                      // Handle populated user objects for last message sender\n                      const lastMessageSenderId = typeof conversation.lastMessage.senderId === 'string' ? conversation.lastMessage.senderId : ((_conversation$lastMes = conversation.lastMessage.senderId) === null || _conversation$lastMes === void 0 ? void 0 : _conversation$lastMes.id) || ((_conversation$lastMes2 = conversation.lastMessage.senderId) === null || _conversation$lastMes2 === void 0 ? void 0 : _conversation$lastMes2._id);\n                      return lastMessageSenderId === ((_state$currentUser11 = state.currentUser) === null || _state$currentUser11 === void 0 ? void 0 : _state$currentUser11.id) ? 'You: ' : '';\n                    })(), conversation.lastMessage.content]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 371,\n                    columnNumber: 25\n                  }, this), conversation.unreadCount > 0 && /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"bg-blue-500 text-white text-xs px-2 py-1 rounded-full min-w-[20px] text-center\",\n                    children: conversation.unreadCount > 99 ? '99+' : conversation.unreadCount\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 382,\n                    columnNumber: 27\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 370,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 360,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 342,\n              columnNumber: 19\n            }, this)\n          }, conversation.id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 331,\n            columnNumber: 17\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 324,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 314,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 295,\n    columnNumber: 5\n  }, this);\n  const renderChatInterface = () => {\n    if (!selectedConversation || !selectedConversationUser) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex-1 flex items-center justify-center\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-center\",\n          children: [/*#__PURE__*/_jsxDEV(MessageCircle, {\n            className: \"w-16 h-16 mx-auto mb-4 text-primary-400\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 403,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-xl font-semibold text-primary-100 mb-2\",\n            children: \"Select a conversation\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 404,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-primary-300\",\n            children: \"Choose a conversation to start messaging\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 405,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 402,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 401,\n        columnNumber: 9\n      }, this);\n    }\n    const typingUsersInConversation = typingUsers.filter(t => t.conversationId === selectedConversation);\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-1 flex flex-col\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-4 border-b border-primary-700/30 flex items-center justify-between\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setSelectedConversation(null),\n            className: \"lg:hidden p-2 hover:bg-primary-800/50 rounded-full transition-colors\",\n            children: /*#__PURE__*/_jsxDEV(ArrowLeft, {\n              className: \"w-5 h-5 text-primary-300\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 422,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 418,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-10 h-10 bg-primary-800/50 rounded-full flex items-center justify-center\",\n            children: selectedConversationUser.avatar ? /*#__PURE__*/_jsxDEV(\"img\", {\n              src: selectedConversationUser.avatar,\n              alt: selectedConversationUser.username,\n              className: \"w-full h-full object-cover rounded-full\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 427,\n              columnNumber: 17\n            }, this) : /*#__PURE__*/_jsxDEV(User, {\n              className: \"w-5 h-5 text-primary-300\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 433,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 425,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"font-semibold text-primary-100\",\n              children: [\"@\", selectedConversationUser.username]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 438,\n              columnNumber: 15\n            }, this), typingUsersInConversation.length > 0 && /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm text-blue-400\",\n              children: \"typing...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 442,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 437,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 417,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"p-2 hover:bg-primary-800/50 rounded-full transition-colors\",\n            children: /*#__PURE__*/_jsxDEV(Phone, {\n              className: \"w-5 h-5 text-primary-300\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 449,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 448,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"p-2 hover:bg-primary-800/50 rounded-full transition-colors\",\n            children: /*#__PURE__*/_jsxDEV(Video, {\n              className: \"w-5 h-5 text-primary-300\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 452,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 451,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"p-2 hover:bg-primary-800/50 rounded-full transition-colors\",\n            children: /*#__PURE__*/_jsxDEV(Info, {\n              className: \"w-5 h-5 text-primary-300\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 455,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 454,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 447,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 416,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex-1 overflow-y-auto p-4 space-y-4 scrollbar-hide\",\n        style: {\n          scrollbarWidth: 'none',\n          msOverflowStyle: 'none'\n        },\n        children: conversationMessages.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-1 flex items-center justify-center\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-primary-300\",\n              children: \"No messages yet\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 465,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm text-primary-400 mt-1\",\n              children: \"Send a message to start the conversation\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 466,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 464,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 463,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-4\",\n          children: [conversationMessages.map((message, index) => {\n            var _message$senderId3, _message$senderId4, _conversationMessages, _conversationMessages2, _conversationMessages3, _conversationMessages4, _state$currentUser12;\n            // Handle populated user objects\n            const messageSenderId = typeof message.senderId === 'string' ? message.senderId : ((_message$senderId3 = message.senderId) === null || _message$senderId3 === void 0 ? void 0 : _message$senderId3.id) || ((_message$senderId4 = message.senderId) === null || _message$senderId4 === void 0 ? void 0 : _message$senderId4._id);\n            const prevMessageSenderId = index > 0 ? typeof conversationMessages[index - 1].senderId === 'string' ? conversationMessages[index - 1].senderId : ((_conversationMessages = conversationMessages[index - 1].senderId) === null || _conversationMessages === void 0 ? void 0 : _conversationMessages.id) || ((_conversationMessages2 = conversationMessages[index - 1].senderId) === null || _conversationMessages2 === void 0 ? void 0 : _conversationMessages2._id) : null;\n            const nextMessageSenderId = index < conversationMessages.length - 1 ? typeof conversationMessages[index + 1].senderId === 'string' ? conversationMessages[index + 1].senderId : ((_conversationMessages3 = conversationMessages[index + 1].senderId) === null || _conversationMessages3 === void 0 ? void 0 : _conversationMessages3.id) || ((_conversationMessages4 = conversationMessages[index + 1].senderId) === null || _conversationMessages4 === void 0 ? void 0 : _conversationMessages4._id) : null;\n            const isOwn = messageSenderId === ((_state$currentUser12 = state.currentUser) === null || _state$currentUser12 === void 0 ? void 0 : _state$currentUser12.id);\n            const showAvatar = index === 0 || prevMessageSenderId !== messageSenderId;\n            const isLastInGroup = index === conversationMessages.length - 1 || nextMessageSenderId !== messageSenderId;\n            return /*#__PURE__*/_jsxDEV(motion.div, {\n              initial: {\n                opacity: 0,\n                y: 10\n              },\n              animate: {\n                opacity: 1,\n                y: 0\n              },\n              transition: {\n                duration: 0.2\n              },\n              className: `flex ${isOwn ? 'justify-end' : 'justify-start'}`,\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: `flex items-end space-x-2 max-w-xs lg:max-w-md ${isOwn ? 'flex-row-reverse space-x-reverse' : ''}`,\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"w-8 h-8 flex-shrink-0\",\n                  children: showAvatar && !isOwn && /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"w-8 h-8 bg-primary-800/50 rounded-full flex items-center justify-center\",\n                    children: selectedConversationUser.avatar ? /*#__PURE__*/_jsxDEV(\"img\", {\n                      src: selectedConversationUser.avatar,\n                      alt: selectedConversationUser.username,\n                      className: \"w-full h-full object-cover rounded-full\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 505,\n                      columnNumber: 31\n                    }, this) : /*#__PURE__*/_jsxDEV(User, {\n                      className: \"w-4 h-4 text-primary-300\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 511,\n                      columnNumber: 31\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 503,\n                    columnNumber: 27\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 501,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: `px-4 py-2 rounded-2xl ${isOwn ? 'bg-blue-600 text-white' : 'bg-primary-700/50 text-primary-100'} ${isLastInGroup ? '' : 'mb-1'}`,\n                  children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"text-sm whitespace-pre-wrap\",\n                    children: message.content\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 527,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: `flex items-center justify-end mt-1 space-x-1 ${isOwn ? 'text-blue-200' : 'text-primary-400'}`,\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-xs\",\n                      children: formatMessageTime(message.timestamp)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 533,\n                      columnNumber: 27\n                    }, this), isOwn && /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"flex items-center\",\n                      children: message.read ? /*#__PURE__*/_jsxDEV(CheckCheck, {\n                        className: \"w-3 h-3\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 539,\n                        columnNumber: 33\n                      }, this) : /*#__PURE__*/_jsxDEV(Check, {\n                        className: \"w-3 h-3\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 541,\n                        columnNumber: 33\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 537,\n                      columnNumber: 29\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 530,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 518,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 499,\n                columnNumber: 21\n              }, this)\n            }, message.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 492,\n              columnNumber: 19\n            }, this);\n          }), typingUsersInConversation.length > 0 && /*#__PURE__*/_jsxDEV(motion.div, {\n            initial: {\n              opacity: 0,\n              y: 10\n            },\n            animate: {\n              opacity: 1,\n              y: 0\n            },\n            className: \"flex items-end space-x-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-8 h-8 bg-primary-800/50 rounded-full flex items-center justify-center\",\n              children: /*#__PURE__*/_jsxDEV(User, {\n                className: \"w-4 h-4 text-primary-300\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 560,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 559,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-primary-700/50 px-4 py-2 rounded-2xl\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex space-x-1\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"w-2 h-2 bg-primary-400 rounded-full animate-bounce\",\n                  style: {\n                    animationDelay: '0ms'\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 564,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"w-2 h-2 bg-primary-400 rounded-full animate-bounce\",\n                  style: {\n                    animationDelay: '150ms'\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 565,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"w-2 h-2 bg-primary-400 rounded-full animate-bounce\",\n                  style: {\n                    animationDelay: '300ms'\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 566,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 563,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 562,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 554,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            ref: messagesEndRef\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 572,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 470,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 461,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-4 border-t border-primary-700/30 bg-primary-900/50 backdrop-blur-sm\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex-1\",\n            children: /*#__PURE__*/_jsxDEV(\"textarea\", {\n              value: messageText,\n              onChange: e => handleTyping(e.target.value),\n              onKeyPress: handleKeyPress,\n              placeholder: \"Type a message...\",\n              className: \"w-full px-4 py-3 bg-primary-800/50 border border-primary-700/30 rounded-xl text-primary-100 placeholder-primary-400 resize-none focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-transparent transition-all flex items-center\",\n              rows: 1,\n              disabled: loading,\n              style: {\n                minHeight: '48px',\n                maxHeight: '120px',\n                lineHeight: '1.5',\n                paddingTop: '12px',\n                paddingBottom: '12px'\n              },\n              onInput: e => {\n                const target = e.target;\n                target.style.height = '48px';\n                target.style.height = Math.min(target.scrollHeight, 120) + 'px';\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 581,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 580,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleSendMessage,\n            disabled: !messageText.trim() || loading,\n            className: `p-3 rounded-xl transition-all flex-shrink-0 ${messageText.trim() && !loading ? 'bg-blue-600 hover:bg-blue-700 text-white shadow-lg hover:shadow-blue-500/25' : 'bg-primary-700/50 text-primary-400 cursor-not-allowed'}`,\n            children: /*#__PURE__*/_jsxDEV(Send, {\n              className: \"w-5 h-5\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 612,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 603,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 579,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 578,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 414,\n      columnNumber: 7\n    }, this);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"h-full flex\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"lg:hidden w-full\",\n      children: selectedConversation ? renderChatInterface() : renderConversationsList()\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 623,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"hidden lg:flex w-full\",\n      children: [renderConversationsList(), renderChatInterface()]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 628,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 621,\n    columnNumber: 5\n  }, this);\n}\n_s(MessagesView, \"KW46L92nh35Vj5WR5NmNFeqkjZE=\", false, function () {\n  return [useApp];\n});\n_c = MessagesView;\nvar _c;\n$RefreshReg$(_c, \"MessagesView\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useMemo","motion","MessageCircle","Search","Send","User","ArrowLeft","Check","CheckCheck","Phone","Video","Info","useApp","jsxDEV","_jsxDEV","MessagesView","_s","_state$currentUser7","_state$currentUser9","_state$currentUser1","state","sendMessage","markMessagesAsRead","selectedConversation","setSelectedConversation","messageText","setMessageText","searchTerm","setSearchTerm","loading","setLoading","typingUsers","setTypingUsers","isTyping","setIsTyping","messagesEndRef","typingTimeoutRef","_state$currentUser","console","log","messagesCount","messages","length","usersCount","users","currentUser","username","slice","map","m","id","senderId","receiverId","content","substring","u","timeoutId","setTimeout","scrollToBottom","clearTimeout","interval","setInterval","now","Date","prev","filter","typing","timestamp","clearInterval","current","scrollIntoView","behavior","block","inline","conversations","convMap","Map","forEach","message","_message$senderId","_message$senderId2","_message$receiverId","_message$receiverId2","_state$currentUser2","_state$currentUser3","messageSenderId","_id","messageReceiverId","otherUserId","conversationId","sort","join","has","_state$currentUser4","set","participants","lastMessage","unreadCount","updatedAt","existing","get","conversation","unreadMessages","msg","_msg$receiverId","_msg$receiverId2","_msg$senderId","_msg$senderId2","_state$currentUser5","msgReceiverId","msgSenderId","read","conversationsArray","Array","from","values","a","b","getTime","missingUsers","conv","find","p","_state$currentUser6","otherUser","found","conversationsCount","allUserMappings","filteredConversations","_state$currentUser8","toLowerCase","includes","conversationMessages","c","_msg$senderId3","_msg$senderId4","_msg$receiverId3","_msg$receiverId4","selectedConversationUser","_state$currentUser0","handleSendMessage","trim","error","handleKeyPress","e","key","shiftKey","preventDefault","handleTyping","value","handleConversationSelect","formatTime","date","diffInHours","toLocaleTimeString","hour","minute","toLocaleDateString","weekday","month","day","formatMessageTime","renderConversationsList","className","children","fileName","_jsxFileName","lineNumber","columnNumber","type","placeholder","onChange","target","_state$currentUser10","isSelected","div","whileHover","scale","whileTap","onClick","avatar","src","alt","_conversation$lastMes","_conversation$lastMes2","_state$currentUser11","lastMessageSenderId","renderChatInterface","typingUsersInConversation","t","style","scrollbarWidth","msOverflowStyle","index","_message$senderId3","_message$senderId4","_conversationMessages","_conversationMessages2","_conversationMessages3","_conversationMessages4","_state$currentUser12","prevMessageSenderId","nextMessageSenderId","isOwn","showAvatar","isLastInGroup","initial","opacity","y","animate","transition","duration","animationDelay","ref","onKeyPress","rows","disabled","minHeight","maxHeight","lineHeight","paddingTop","paddingBottom","onInput","height","Math","min","scrollHeight","_c","$RefreshReg$"],"sources":["C:/Users/thato/Downloads/car-app/src/components/messages/MessagesView.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef, useMemo } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { \r\n  MessageCircle, \r\n  Search, \r\n  Send, \r\n  User, \r\n  ArrowLeft, \r\n  MoreVertical,\r\n  Check,\r\n  CheckCheck,\r\n  Phone,\r\n  Video,\r\n  Info\r\n} from 'lucide-react';\r\nimport { useApp } from '../../context/AppContext.tsx';\r\nimport { Message, User as UserType, Conversation } from '../../types/index.ts';\r\n\r\ninterface TypingIndicator {\r\n  userId: string;\r\n  conversationId: string;\r\n  timestamp: number;\r\n}\r\n\r\nexport function MessagesView() {\r\n  const { state, sendMessage, markMessagesAsRead } = useApp();\r\n  const [selectedConversation, setSelectedConversation] = useState<string | null>(null);\r\n  const [messageText, setMessageText] = useState('');\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [typingUsers, setTypingUsers] = useState<TypingIndicator[]>([]);\r\n  const [isTyping, setIsTyping] = useState(false);\r\n  const messagesEndRef = useRef<HTMLDivElement>(null);\r\n  const typingTimeoutRef = useRef<NodeJS.Timeout>();\r\n\r\n  // Debug logging\r\n  useEffect(() => {\r\n    console.log('🔍 MessagesView Debug:', {\r\n      messagesCount: state.messages.length,\r\n      usersCount: state.users.length,\r\n      currentUser: state.currentUser?.username,\r\n      messages: state.messages.slice(0, 3).map(m => ({\r\n        id: m.id,\r\n        senderId: m.senderId,\r\n        receiverId: m.receiverId,\r\n        content: m.content.substring(0, 30) + '...'\r\n      })),\r\n      users: state.users.slice(0, 5).map(u => ({ id: u.id, username: u.username }))\r\n    });\r\n  }, [state.messages, state.users, state.currentUser]);\r\n\r\n  // Auto-scroll to bottom when new messages arrive\r\n  useEffect(() => {\r\n    // Use setTimeout to ensure DOM has been updated before scrolling\r\n    const timeoutId = setTimeout(() => {\r\n      scrollToBottom();\r\n    }, 50); // Reduced delay for smoother experience\r\n\r\n    return () => clearTimeout(timeoutId);\r\n  }, [state.messages, selectedConversation]);\r\n\r\n  // Scroll to bottom when conversation is first selected\r\n  useEffect(() => {\r\n    if (selectedConversation) {\r\n      const timeoutId = setTimeout(() => {\r\n        scrollToBottom();\r\n      }, 100);\r\n\r\n      return () => clearTimeout(timeoutId);\r\n    }\r\n  }, [selectedConversation]);\r\n\r\n  // Clean up typing indicators that are too old\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      const now = Date.now();\r\n      setTypingUsers(prev => prev.filter(typing => now - typing.timestamp < 3000));\r\n    }, 1000);\r\n\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  const scrollToBottom = () => {\r\n    if (messagesEndRef.current) {\r\n      messagesEndRef.current.scrollIntoView({ \r\n        behavior: 'smooth',\r\n        block: 'end',\r\n        inline: 'nearest'\r\n      });\r\n    }\r\n  };\r\n\r\n  // Create conversations from messages\r\n  const conversations = useMemo(() => {\r\n    const convMap = new Map<string, Conversation>();\r\n    \r\n    state.messages.forEach(message => {\r\n      // Handle both string IDs and populated user objects\r\n      const messageSenderId = typeof message.senderId === 'string' \r\n        ? message.senderId \r\n        : (message.senderId as any)?.id || (message.senderId as any)?._id;\r\n      const messageReceiverId = typeof message.receiverId === 'string' \r\n        ? message.receiverId \r\n        : (message.receiverId as any)?.id || (message.receiverId as any)?._id;\r\n\r\n      const otherUserId = messageSenderId === state.currentUser?.id \r\n        ? messageReceiverId \r\n        : messageSenderId;\r\n      \r\n      const conversationId = [state.currentUser?.id, otherUserId].sort().join('-');\r\n      \r\n      if (!convMap.has(conversationId)) {\r\n        convMap.set(conversationId, {\r\n          id: conversationId,\r\n          participants: [state.currentUser?.id!, otherUserId],\r\n          lastMessage: message,\r\n          unreadCount: 0,\r\n          updatedAt: message.timestamp\r\n        });\r\n      } else {\r\n        const existing = convMap.get(conversationId)!;\r\n        if (new Date(message.timestamp) > new Date(existing.lastMessage.timestamp)) {\r\n          existing.lastMessage = message;\r\n          existing.updatedAt = message.timestamp;\r\n        }\r\n      }\r\n    });\r\n\r\n    // Calculate unread counts\r\n    convMap.forEach(conversation => {\r\n      const unreadMessages = state.messages.filter(msg => {\r\n        // Handle populated user objects in unread count calculation too\r\n        const msgReceiverId = typeof msg.receiverId === 'string' \r\n          ? msg.receiverId \r\n          : (msg.receiverId as any)?.id || (msg.receiverId as any)?._id;\r\n        const msgSenderId = typeof msg.senderId === 'string' \r\n          ? msg.senderId \r\n          : (msg.senderId as any)?.id || (msg.senderId as any)?._id;\r\n\r\n        return msgReceiverId === state.currentUser?.id &&\r\n          !msg.read &&\r\n          (msgSenderId === conversation.participants[0] || msgSenderId === conversation.participants[1]);\r\n      });\r\n      conversation.unreadCount = unreadMessages.length;\r\n    });\r\n\r\n    const conversationsArray = Array.from(convMap.values()).sort((a, b) => \r\n      new Date(b.updatedAt).getTime() - new Date(a.updatedAt).getTime()\r\n    );\r\n\r\n    // Debug: Check for missing users\r\n    const missingUsers = conversationsArray.map(conv => {\r\n      const otherUserId = conv.participants.find(p => p !== state.currentUser?.id);\r\n      const otherUser = state.users.find(u => u.id === otherUserId);\r\n      return { otherUserId, found: !!otherUser, username: otherUser?.username };\r\n    });\r\n\r\n    console.log('🔍 Conversations Debug:', {\r\n      conversationsCount: conversationsArray.length,\r\n      missingUsers: missingUsers.filter(u => !u.found),\r\n      allUserMappings: missingUsers\r\n    });\r\n\r\n    return conversationsArray;\r\n  }, [state.messages, state.currentUser?.id, state.users]);\r\n\r\n  // Filter conversations based on search\r\n  const filteredConversations = useMemo(() => {\r\n    if (!searchTerm) return conversations;\r\n    \r\n    return conversations.filter(conversation => {\r\n      const otherUserId = conversation.participants.find(p => p !== state.currentUser?.id);\r\n      const otherUser = state.users.find(u => u.id === otherUserId);\r\n      return otherUser?.username.toLowerCase().includes(searchTerm.toLowerCase());\r\n    });\r\n  }, [conversations, searchTerm, state.users, state.currentUser?.id]);\r\n\r\n  // Get messages for selected conversation\r\n  const conversationMessages = useMemo(() => {\r\n    if (!selectedConversation) return [];\r\n    \r\n    const conversation = conversations.find(c => c.id === selectedConversation);\r\n    if (!conversation) return [];\r\n    \r\n    return state.messages\r\n      .filter(msg => {\r\n        // Handle populated user objects\r\n        const msgSenderId = typeof msg.senderId === 'string' \r\n          ? msg.senderId \r\n          : (msg.senderId as any)?.id || (msg.senderId as any)?._id;\r\n        const msgReceiverId = typeof msg.receiverId === 'string' \r\n          ? msg.receiverId \r\n          : (msg.receiverId as any)?.id || (msg.receiverId as any)?._id;\r\n\r\n        const participants = conversation.participants;\r\n        return (\r\n          (msgSenderId === participants[0] && msgReceiverId === participants[1]) ||\r\n          (msgSenderId === participants[1] && msgReceiverId === participants[0])\r\n        );\r\n      })\r\n      .sort((a, b) => new Date(a.timestamp).getTime() - new Date(b.timestamp).getTime());\r\n  }, [selectedConversation, conversations, state.messages]);\r\n\r\n  // Get other user in selected conversation\r\n  const selectedConversationUser = useMemo(() => {\r\n    if (!selectedConversation) return null;\r\n    \r\n    const conversation = conversations.find(c => c.id === selectedConversation);\r\n    if (!conversation) return null;\r\n    \r\n    const otherUserId = conversation.participants.find(p => p !== state.currentUser?.id);\r\n    return state.users.find(u => u.id === otherUserId) || null;\r\n  }, [selectedConversation, conversations, state.users, state.currentUser?.id]);\r\n\r\n  const handleSendMessage = async () => {\r\n    if (!messageText.trim() || !selectedConversationUser || loading) return;\r\n\r\n    setLoading(true);\r\n    try {\r\n      await sendMessage({\r\n        senderId: state.currentUser!.id,\r\n        receiverId: selectedConversationUser.id,\r\n        content: messageText.trim()\r\n      });\r\n      setMessageText('');\r\n      setIsTyping(false);\r\n    } catch (error) {\r\n      console.error('Error sending message:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleKeyPress = (e: React.KeyboardEvent) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      e.preventDefault();\r\n      handleSendMessage();\r\n    }\r\n  };\r\n\r\n  const handleTyping = (value: string) => {\r\n    setMessageText(value);\r\n    \r\n    if (value.trim() && !isTyping) {\r\n      setIsTyping(true);\r\n      // In a real app, you'd emit typing indicator to other users via WebSocket\r\n    }\r\n\r\n    // Clear typing indicator after 2 seconds of no typing\r\n    if (typingTimeoutRef.current) {\r\n      clearTimeout(typingTimeoutRef.current);\r\n    }\r\n    \r\n    typingTimeoutRef.current = setTimeout(() => {\r\n      setIsTyping(false);\r\n    }, 2000);\r\n  };\r\n\r\n  const handleConversationSelect = async (conversationId: string) => {\r\n    setSelectedConversation(conversationId);\r\n    \r\n    // Mark messages as read\r\n    const conversation = conversations.find(c => c.id === conversationId);\r\n    if (conversation && conversation.unreadCount > 0) {\r\n      try {\r\n        await markMessagesAsRead(conversationId);\r\n      } catch (error) {\r\n        console.error('Error marking messages as read:', error);\r\n      }\r\n    }\r\n  };\r\n\r\n  const formatTime = (timestamp: string) => {\r\n    const date = new Date(timestamp);\r\n    const now = new Date();\r\n    const diffInHours = (now.getTime() - date.getTime()) / (1000 * 60 * 60);\r\n    \r\n    if (diffInHours < 24) {\r\n      return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\r\n    } else if (diffInHours < 168) { // 7 days\r\n      return date.toLocaleDateString([], { weekday: 'short' });\r\n    } else {\r\n      return date.toLocaleDateString([], { month: 'short', day: 'numeric' });\r\n    }\r\n  };\r\n\r\n  const formatMessageTime = (timestamp: string) => {\r\n    return new Date(timestamp).toLocaleTimeString([], { \r\n      hour: '2-digit', \r\n      minute: '2-digit' \r\n    });\r\n  };\r\n\r\n  const renderConversationsList = () => (\r\n    <div className=\"w-full lg:w-96 border-r border-primary-700/30 flex flex-col\">\r\n      {/* Header */}\r\n      <div className=\"p-4 border-b border-primary-700/30\">\r\n        <h2 className=\"text-xl font-bold text-primary-100 mb-4\">Messages</h2>\r\n        \r\n        {/* Search */}\r\n        <div className=\"relative\">\r\n          <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-primary-400\" />\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Search conversations...\"\r\n            value={searchTerm}\r\n            onChange={(e) => setSearchTerm(e.target.value)}\r\n            className=\"input-field pl-10 text-sm\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Conversations List */}\r\n      <div className=\"flex-1 overflow-y-auto\">\r\n        {filteredConversations.length === 0 ? (\r\n          <div className=\"p-4 text-center\">\r\n            <MessageCircle className=\"w-12 h-12 mx-auto mb-4 text-primary-400\" />\r\n            <p className=\"text-primary-300\">No conversations yet</p>\r\n            <p className=\"text-sm text-primary-400 mt-1\">\r\n              Start trading to begin messaging with other users\r\n            </p>\r\n          </div>\r\n        ) : (\r\n          <div className=\"space-y-1 p-2\">\r\n            {filteredConversations.map((conversation) => {\r\n              const otherUserId = conversation.participants.find(p => p !== state.currentUser?.id);\r\n              const otherUser = state.users.find(u => u.id === otherUserId);\r\n              const isSelected = selectedConversation === conversation.id;\r\n              \r\n              return (\r\n                <motion.div\r\n                  key={conversation.id}\r\n                  whileHover={{ scale: 1.02 }}\r\n                  whileTap={{ scale: 0.98 }}\r\n                  onClick={() => handleConversationSelect(conversation.id)}\r\n                  className={`p-3 rounded-lg cursor-pointer transition-all ${\r\n                    isSelected\r\n                      ? 'bg-primary-600/30 border border-primary-500/50'\r\n                      : 'hover:bg-primary-800/30'\r\n                  }`}\r\n                >\r\n                  <div className=\"flex items-center space-x-3\">\r\n                    {/* Avatar */}\r\n                    <div className=\"relative\">\r\n                      <div className=\"w-12 h-12 bg-primary-800/50 rounded-full flex items-center justify-center\">\r\n                        {otherUser?.avatar ? (\r\n                          <img\r\n                            src={otherUser.avatar}\r\n                            alt={otherUser.username}\r\n                            className=\"w-full h-full object-cover rounded-full\"\r\n                          />\r\n                        ) : (\r\n                          <User className=\"w-6 h-6 text-primary-300\" />\r\n                        )}\r\n                      </div>\r\n                      {/* Online indicator could go here */}\r\n                    </div>\r\n                    \r\n                    {/* Content */}\r\n                    <div className=\"flex-1 min-w-0\">\r\n                      <div className=\"flex items-center justify-between\">\r\n                        <h4 className=\"font-medium text-primary-100 truncate\">\r\n                          @{otherUser?.username || 'Unknown'}\r\n                        </h4>\r\n                        <span className=\"text-xs text-primary-400\">\r\n                          {formatTime(conversation.lastMessage.timestamp)}\r\n                        </span>\r\n                      </div>\r\n                      \r\n                      <div className=\"flex items-center justify-between mt-1\">\r\n                        <p className=\"text-sm text-primary-300 truncate\">\r\n                          {(() => {\r\n                            // Handle populated user objects for last message sender\r\n                            const lastMessageSenderId = typeof conversation.lastMessage.senderId === 'string' \r\n                              ? conversation.lastMessage.senderId \r\n                              : (conversation.lastMessage.senderId as any)?.id || (conversation.lastMessage.senderId as any)?._id;\r\n                            return lastMessageSenderId === state.currentUser?.id ? 'You: ' : '';\r\n                          })()}\r\n                          {conversation.lastMessage.content}\r\n                        </p>\r\n                        {conversation.unreadCount > 0 && (\r\n                          <span className=\"bg-blue-500 text-white text-xs px-2 py-1 rounded-full min-w-[20px] text-center\">\r\n                            {conversation.unreadCount > 99 ? '99+' : conversation.unreadCount}\r\n                          </span>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </motion.div>\r\n              );\r\n            })}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  const renderChatInterface = () => {\r\n    if (!selectedConversation || !selectedConversationUser) {\r\n      return (\r\n        <div className=\"flex-1 flex items-center justify-center\">\r\n          <div className=\"text-center\">\r\n            <MessageCircle className=\"w-16 h-16 mx-auto mb-4 text-primary-400\" />\r\n            <h3 className=\"text-xl font-semibold text-primary-100 mb-2\">Select a conversation</h3>\r\n            <p className=\"text-primary-300\">Choose a conversation to start messaging</p>\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    const typingUsersInConversation = typingUsers.filter(t => t.conversationId === selectedConversation);\r\n\r\n    return (\r\n      <div className=\"flex-1 flex flex-col\">\r\n        {/* Chat Header */}\r\n        <div className=\"p-4 border-b border-primary-700/30 flex items-center justify-between\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            <button\r\n              onClick={() => setSelectedConversation(null)}\r\n              className=\"lg:hidden p-2 hover:bg-primary-800/50 rounded-full transition-colors\"\r\n            >\r\n              <ArrowLeft className=\"w-5 h-5 text-primary-300\" />\r\n            </button>\r\n            \r\n            <div className=\"w-10 h-10 bg-primary-800/50 rounded-full flex items-center justify-center\">\r\n              {selectedConversationUser.avatar ? (\r\n                <img\r\n                  src={selectedConversationUser.avatar}\r\n                  alt={selectedConversationUser.username}\r\n                  className=\"w-full h-full object-cover rounded-full\"\r\n                />\r\n              ) : (\r\n                <User className=\"w-5 h-5 text-primary-300\" />\r\n              )}\r\n            </div>\r\n            \r\n            <div>\r\n              <h3 className=\"font-semibold text-primary-100\">\r\n                @{selectedConversationUser.username}\r\n              </h3>\r\n              {typingUsersInConversation.length > 0 && (\r\n                <p className=\"text-sm text-blue-400\">typing...</p>\r\n              )}\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"flex items-center space-x-2\">\r\n            <button className=\"p-2 hover:bg-primary-800/50 rounded-full transition-colors\">\r\n              <Phone className=\"w-5 h-5 text-primary-300\" />\r\n            </button>\r\n            <button className=\"p-2 hover:bg-primary-800/50 rounded-full transition-colors\">\r\n              <Video className=\"w-5 h-5 text-primary-300\" />\r\n            </button>\r\n            <button className=\"p-2 hover:bg-primary-800/50 rounded-full transition-colors\">\r\n              <Info className=\"w-5 h-5 text-primary-300\" />\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Messages */}\r\n        <div className=\"flex-1 overflow-y-auto p-4 space-y-4 scrollbar-hide\" style={{ scrollbarWidth: 'none', msOverflowStyle: 'none' }}>\r\n          {conversationMessages.length === 0 ? (\r\n            <div className=\"flex-1 flex items-center justify-center\">\r\n              <div className=\"text-center\">\r\n                <p className=\"text-primary-300\">No messages yet</p>\r\n                <p className=\"text-sm text-primary-400 mt-1\">Send a message to start the conversation</p>\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <div className=\"space-y-4\">\r\n              {conversationMessages.map((message, index) => {\r\n                // Handle populated user objects\r\n                const messageSenderId = typeof message.senderId === 'string' \r\n                  ? message.senderId \r\n                  : (message.senderId as any)?.id || (message.senderId as any)?._id;\r\n                const prevMessageSenderId = index > 0 \r\n                  ? (typeof conversationMessages[index - 1].senderId === 'string' \r\n                      ? conversationMessages[index - 1].senderId \r\n                      : (conversationMessages[index - 1].senderId as any)?.id || (conversationMessages[index - 1].senderId as any)?._id)\r\n                  : null;\r\n                const nextMessageSenderId = index < conversationMessages.length - 1 \r\n                  ? (typeof conversationMessages[index + 1].senderId === 'string' \r\n                      ? conversationMessages[index + 1].senderId \r\n                      : (conversationMessages[index + 1].senderId as any)?.id || (conversationMessages[index + 1].senderId as any)?._id)\r\n                  : null;\r\n\r\n                const isOwn = messageSenderId === state.currentUser?.id;\r\n                const showAvatar = index === 0 || prevMessageSenderId !== messageSenderId;\r\n                const isLastInGroup = index === conversationMessages.length - 1 || nextMessageSenderId !== messageSenderId;\r\n                \r\n                return (\r\n                  <motion.div\r\n                    key={message.id}\r\n                    initial={{ opacity: 0, y: 10 }}\r\n                    animate={{ opacity: 1, y: 0 }}\r\n                    transition={{ duration: 0.2 }}\r\n                    className={`flex ${isOwn ? 'justify-end' : 'justify-start'}`}\r\n                  >\r\n                    <div className={`flex items-end space-x-2 max-w-xs lg:max-w-md ${isOwn ? 'flex-row-reverse space-x-reverse' : ''}`}>\r\n                      {/* Avatar */}\r\n                      <div className=\"w-8 h-8 flex-shrink-0\">\r\n                        {showAvatar && !isOwn && (\r\n                          <div className=\"w-8 h-8 bg-primary-800/50 rounded-full flex items-center justify-center\">\r\n                            {selectedConversationUser.avatar ? (\r\n                              <img\r\n                                src={selectedConversationUser.avatar}\r\n                                alt={selectedConversationUser.username}\r\n                                className=\"w-full h-full object-cover rounded-full\"\r\n                              />\r\n                            ) : (\r\n                              <User className=\"w-4 h-4 text-primary-300\" />\r\n                            )}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                      \r\n                      {/* Message Bubble */}\r\n                      <div\r\n                        className={`px-4 py-2 rounded-2xl ${\r\n                          isOwn\r\n                            ? 'bg-blue-600 text-white'\r\n                            : 'bg-primary-700/50 text-primary-100'\r\n                        } ${\r\n                          isLastInGroup ? '' : 'mb-1'\r\n                        }`}\r\n                      >\r\n                        <p className=\"text-sm whitespace-pre-wrap\">{message.content}</p>\r\n                        \r\n                        {/* Message metadata */}\r\n                        <div className={`flex items-center justify-end mt-1 space-x-1 ${\r\n                          isOwn ? 'text-blue-200' : 'text-primary-400'\r\n                        }`}>\r\n                          <span className=\"text-xs\">\r\n                            {formatMessageTime(message.timestamp)}\r\n                          </span>\r\n                          {isOwn && (\r\n                            <div className=\"flex items-center\">\r\n                              {message.read ? (\r\n                                <CheckCheck className=\"w-3 h-3\" />\r\n                              ) : (\r\n                                <Check className=\"w-3 h-3\" />\r\n                              )}\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </motion.div>\r\n                );\r\n              })}\r\n              \r\n              {/* Typing Indicator */}\r\n              {typingUsersInConversation.length > 0 && (\r\n                <motion.div\r\n                  initial={{ opacity: 0, y: 10 }}\r\n                  animate={{ opacity: 1, y: 0 }}\r\n                  className=\"flex items-end space-x-2\"\r\n                >\r\n                  <div className=\"w-8 h-8 bg-primary-800/50 rounded-full flex items-center justify-center\">\r\n                    <User className=\"w-4 h-4 text-primary-300\" />\r\n                  </div>\r\n                  <div className=\"bg-primary-700/50 px-4 py-2 rounded-2xl\">\r\n                    <div className=\"flex space-x-1\">\r\n                      <div className=\"w-2 h-2 bg-primary-400 rounded-full animate-bounce\" style={{ animationDelay: '0ms' }} />\r\n                      <div className=\"w-2 h-2 bg-primary-400 rounded-full animate-bounce\" style={{ animationDelay: '150ms' }} />\r\n                      <div className=\"w-2 h-2 bg-primary-400 rounded-full animate-bounce\" style={{ animationDelay: '300ms' }} />\r\n                    </div>\r\n                  </div>\r\n                </motion.div>\r\n              )}\r\n              \r\n              <div ref={messagesEndRef} />\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Message Input - Fixed at bottom */}\r\n        <div className=\"p-4 border-t border-primary-700/30 bg-primary-900/50 backdrop-blur-sm\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"flex-1\">\r\n              <textarea\r\n                value={messageText}\r\n                onChange={(e) => handleTyping(e.target.value)}\r\n                onKeyPress={handleKeyPress}\r\n                placeholder=\"Type a message...\"\r\n                className=\"w-full px-4 py-3 bg-primary-800/50 border border-primary-700/30 rounded-xl text-primary-100 placeholder-primary-400 resize-none focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-transparent transition-all flex items-center\"\r\n                rows={1}\r\n                disabled={loading}\r\n                style={{ \r\n                  minHeight: '48px',\r\n                  maxHeight: '120px',\r\n                  lineHeight: '1.5',\r\n                  paddingTop: '12px',\r\n                  paddingBottom: '12px'\r\n                }}\r\n                onInput={(e) => {\r\n                  const target = e.target as HTMLTextAreaElement;\r\n                  target.style.height = '48px';\r\n                  target.style.height = Math.min(target.scrollHeight, 120) + 'px';\r\n                }}\r\n              />\r\n            </div>\r\n            <button\r\n              onClick={handleSendMessage}\r\n              disabled={!messageText.trim() || loading}\r\n              className={`p-3 rounded-xl transition-all flex-shrink-0 ${\r\n                messageText.trim() && !loading\r\n                  ? 'bg-blue-600 hover:bg-blue-700 text-white shadow-lg hover:shadow-blue-500/25'\r\n                  : 'bg-primary-700/50 text-primary-400 cursor-not-allowed'\r\n              }`}\r\n            >\r\n              <Send className=\"w-5 h-5\" />\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"h-full flex\">\r\n      {/* Mobile: Show either conversations list or chat */}\r\n      <div className=\"lg:hidden w-full\">\r\n        {selectedConversation ? renderChatInterface() : renderConversationsList()}\r\n      </div>\r\n      \r\n      {/* Desktop: Show both side by side */}\r\n      <div className=\"hidden lg:flex w-full\">\r\n        {renderConversationsList()}\r\n        {renderChatInterface()}\r\n      </div>\r\n    </div>\r\n  );\r\n} "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}