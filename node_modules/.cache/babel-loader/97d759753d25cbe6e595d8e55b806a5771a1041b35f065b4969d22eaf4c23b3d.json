{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\thato\\\\Downloads\\\\car-app\\\\src\\\\context\\\\AppContext.tsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useReducer, useEffect, useState, useMemo, useCallback } from 'react';\nimport { AuthService } from '../services/authService.ts';\nimport ApiService from '../services/apiService.ts';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst initialState = {\n  currentUser: null,\n  vehicles: [],\n  listings: [],\n  allListings: [],\n  auctions: [],\n  trades: [],\n  messages: [],\n  conversations: [],\n  reviews: [],\n  sales: [],\n  users: [],\n  isAuthenticated: false,\n  loading: false,\n  error: null\n};\nfunction appReducer(state, action) {\n  switch (action.type) {\n    case 'SET_USER':\n      return {\n        ...state,\n        currentUser: action.payload,\n        isAuthenticated: action.payload !== null\n      };\n    case 'SET_CURRENT_USER':\n      return {\n        ...state,\n        currentUser: action.payload,\n        isAuthenticated: true\n      };\n    case 'LOGOUT':\n      return {\n        ...initialState,\n        // Reset to initial state\n        isAuthenticated: false\n      };\n    case 'SET_LOADING':\n      return {\n        ...state,\n        loading: action.payload\n      };\n    case 'SET_ERROR':\n      return {\n        ...state,\n        error: action.payload\n      };\n    case 'SET_VEHICLES':\n      return {\n        ...state,\n        vehicles: action.payload\n      };\n    case 'ADD_VEHICLE':\n      return {\n        ...state,\n        vehicles: [...state.vehicles, action.payload]\n      };\n    case 'UPDATE_VEHICLE':\n      return {\n        ...state,\n        vehicles: state.vehicles.map(v => v.id === action.payload.id ? action.payload : v)\n      };\n    case 'DELETE_VEHICLE':\n      return {\n        ...state,\n        vehicles: state.vehicles.filter(v => v.id !== action.payload)\n      };\n    case 'SET_LISTINGS':\n      return {\n        ...state,\n        listings: action.payload\n      };\n    case 'ADD_LISTING':\n      return {\n        ...state,\n        listings: [...state.listings, action.payload]\n      };\n    case 'UPDATE_LISTING':\n      return {\n        ...state,\n        listings: state.listings.map(l => l.id === action.payload.id ? action.payload : l)\n      };\n    case 'DELETE_LISTING':\n      return {\n        ...state,\n        listings: state.listings.filter(l => l.id !== action.payload)\n      };\n    case 'SET_TRADES':\n      return {\n        ...state,\n        trades: action.payload\n      };\n    case 'ADD_TRADE':\n      return {\n        ...state,\n        trades: [...state.trades, action.payload]\n      };\n    case 'UPDATE_TRADE':\n      return {\n        ...state,\n        trades: state.trades.map(t => t.id === action.payload.id ? action.payload : t)\n      };\n    case 'SET_MESSAGES':\n      return {\n        ...state,\n        messages: action.payload\n      };\n    case 'ADD_MESSAGE':\n      return {\n        ...state,\n        messages: [...state.messages, action.payload]\n      };\n    case 'SET_CONVERSATIONS':\n      return {\n        ...state,\n        conversations: action.payload\n      };\n    case 'SET_REVIEWS':\n      return {\n        ...state,\n        reviews: action.payload\n      };\n    case 'SET_USERS':\n      return {\n        ...state,\n        users: action.payload\n      };\n    case 'SET_ALL_LISTINGS':\n      return {\n        ...state,\n        allListings: action.payload\n      };\n    default:\n      return state;\n  }\n}\nconst AppContext = /*#__PURE__*/createContext(undefined);\nexport function AppProvider({\n  children\n}) {\n  _s();\n  const [state, dispatch] = useReducer(appReducer, initialState);\n  const [activeTab, setActiveTab] = React.useState('garage');\n  const [listingsCache, setListingsCache] = useState({\n    data: [],\n    timestamp: 0,\n    ttl: 30000\n  }); // 30 second cache\n\n  useEffect(() => {\n    // Initialize app state by checking API authentication\n    const initializeAuth = async () => {\n      try {\n        // Only check if there's a token present\n        const token = localStorage.getItem('carTrade_token');\n        if (!token) {\n          console.log('No token found, user not authenticated');\n          return;\n        }\n        const authCheck = await ApiService.verifyToken();\n        if (authCheck.valid && authCheck.user) {\n          const user = {\n            ...authCheck.user,\n            id: authCheck.user._id || authCheck.user.id\n          };\n          dispatch({\n            type: 'SET_CURRENT_USER',\n            payload: user\n          });\n          await loadUserData(user.id);\n          console.log('User authenticated and data loaded');\n        } else {\n          console.log('Token invalid, clearing authentication');\n          ApiService.logout();\n          AuthService.logout();\n        }\n      } catch (error) {\n        console.log('Authentication check failed:', error);\n        // Clear any stale tokens on error\n        ApiService.logout();\n        AuthService.logout();\n        dispatch({\n          type: 'LOGOUT'\n        });\n      }\n    };\n    initializeAuth();\n    // Load all users for the seller profiles using API\n    loadAllUsers();\n  }, []);\n  const loadUserData = async userId => {\n    try {\n      const [vehicles, listings, messages, trades] = await Promise.all([ApiService.getUserVehicles(), ApiService.getUserListings(), ApiService.getUserMessages(), ApiService.getUserTrades()]);\n\n      // Convert MongoDB _id to id for frontend compatibility\n      const vehiclesWithId = vehicles.map(v => ({\n        ...v,\n        id: v._id || v.id\n      }));\n      const listingsWithId = listings.map(l => ({\n        ...l,\n        id: l._id || l.id\n      }));\n      const messagesWithId = messages.map(m => ({\n        ...m,\n        id: m._id || m.id\n      }));\n      const tradesWithId = trades.map(t => ({\n        ...t,\n        id: t._id || t.id\n      }));\n      dispatch({\n        type: 'SET_VEHICLES',\n        payload: vehiclesWithId\n      });\n      dispatch({\n        type: 'SET_LISTINGS',\n        payload: listingsWithId\n      });\n      dispatch({\n        type: 'SET_MESSAGES',\n        payload: messagesWithId\n      });\n      dispatch({\n        type: 'SET_TRADES',\n        payload: tradesWithId\n      });\n    } catch (error) {\n      console.error('Error loading user data:', error);\n    }\n  };\n  const loadAllUsers = async () => {\n    try {\n      const users = await ApiService.getAllUsers();\n      const usersWithId = users.map(u => ({\n        ...u,\n        id: u._id || u.id\n      }));\n      console.log('Loaded users:', usersWithId.map(u => ({\n        id: u.id,\n        username: u.username\n      })));\n      dispatch({\n        type: 'SET_USERS',\n        payload: usersWithId\n      });\n    } catch (error) {\n      console.error('Error loading users:', error);\n      // Fallback to empty array if API fails\n      dispatch({\n        type: 'SET_USERS',\n        payload: []\n      });\n    }\n  };\n\n  // Memoize callback functions to prevent unnecessary re-renders\n  const loadAllListings = useCallback(async (forceRefresh = false) => {\n    try {\n      // Check cache first (unless force refresh)\n      const now = Date.now();\n      if (!forceRefresh && listingsCache.data.length > 0 && now - listingsCache.timestamp < listingsCache.ttl) {\n        console.log('Using cached listings data');\n        dispatch({\n          type: 'SET_ALL_LISTINGS',\n          payload: listingsCache.data\n        });\n        return;\n      }\n      console.time('loadAllListings');\n      console.time('API call');\n\n      // Load all public listings from the API\n      const response = await ApiService.getAllListings();\n      console.timeEnd('API call');\n      console.log('Raw API response:', response);\n      console.time('Data processing');\n\n      // Optimize data processing - avoid complex operations in map\n      const listingsWithId = response.listings.map(l => {\n        // Simple ID conversion only\n        const listing = {\n          ...l,\n          id: l._id || l.id,\n          vehicleId: l.vehicleId,\n          sellerId: l.sellerId\n        };\n\n        // Add populated data if it exists from backend aggregation\n        if (l.vehicle && typeof l.vehicle === 'object' && l.vehicle._id) {\n          listing.vehicle = {\n            ...l.vehicle,\n            id: l.vehicle._id || l.vehicle.id\n          };\n        }\n        if (l.seller && typeof l.seller === 'object' && l.seller._id) {\n          listing.seller = {\n            ...l.seller,\n            id: l.seller._id || l.seller.id\n          };\n        }\n        return listing;\n      });\n      console.timeEnd('Data processing');\n      console.log('Processed listings count:', listingsWithId.length);\n\n      // Also load all users to ensure seller profiles are available\n      // This ensures getUserProfile can find sellers even if they're not in the populated data\n      try {\n        await loadAllUsers();\n        console.log('Users loaded alongside listings');\n      } catch (error) {\n        console.warn('Failed to load users alongside listings:', error);\n      }\n\n      // Update cache\n      setListingsCache({\n        data: listingsWithId,\n        timestamp: now,\n        ttl: 30000\n      });\n      dispatch({\n        type: 'SET_ALL_LISTINGS',\n        payload: listingsWithId\n      });\n      console.timeEnd('loadAllListings');\n    } catch (error) {\n      console.error('Error loading all listings:', error);\n      // Fallback to empty array if API fails\n      dispatch({\n        type: 'SET_ALL_LISTINGS',\n        payload: []\n      });\n    }\n  }, [listingsCache.data, listingsCache.timestamp, listingsCache.ttl]);\n\n  // Memoize other frequently used functions\n  const login = useCallback(async (username, password, rememberMe = false) => {\n    try {\n      const response = await ApiService.login(username, password);\n      // The ApiService.login should automatically store the token\n      const user = {\n        ...response.user,\n        id: response.user._id || response.user.id\n      };\n      dispatch({\n        type: 'SET_CURRENT_USER',\n        payload: user\n      });\n      // Load user data after successful login\n      await loadUserData(user.id);\n      return {\n        success: true\n      };\n    } catch (error) {\n      console.error('Login error:', error);\n      return {\n        success: false,\n        error: error.message || 'Login failed'\n      };\n    }\n  }, []);\n  const logout = useCallback(() => {\n    // Clear both API token and AuthService localStorage data\n    ApiService.logout();\n    AuthService.logout();\n\n    // Clear any additional auth-related localStorage items\n    localStorage.removeItem('carTrade_remember');\n    dispatch({\n      type: 'LOGOUT'\n    });\n    setActiveTab('garage');\n    // Clear cache on logout\n    setListingsCache({\n      data: [],\n      timestamp: 0,\n      ttl: 30000\n    });\n    console.log('Logout completed - all tokens and data cleared');\n  }, []);\n  const register = useCallback(async userData => {\n    try {\n      const response = await ApiService.register(userData);\n      const user = {\n        ...response.user,\n        id: response.user._id || response.user.id\n      };\n      dispatch({\n        type: 'SET_CURRENT_USER',\n        payload: user\n      });\n      // Load user data after successful registration\n      await loadUserData(user.id);\n      return {\n        success: true\n      };\n    } catch (error) {\n      console.error('Registration error:', error);\n      return {\n        success: false,\n        error: error.message || 'Registration failed'\n      };\n    }\n  }, []);\n  const updateUser = user => {\n    try {\n      console.log('Context updateUser called with:', user);\n      AuthService.updateUser(user);\n      dispatch({\n        type: 'SET_USER',\n        payload: user\n      });\n      console.log('User updated successfully in context');\n    } catch (error) {\n      console.error('Error in context updateUser:', error);\n      throw error;\n    }\n  };\n  const addVehicle = async vehicleData => {\n    if (!state.currentUser) return;\n    try {\n      console.log('Adding vehicle with data:', vehicleData);\n      const newVehicle = await ApiService.createVehicle(vehicleData);\n      console.log('Vehicle created by API:', newVehicle);\n\n      // Convert MongoDB _id to id for frontend compatibility\n      const mongoVehicle = newVehicle;\n      const vehicleWithId = {\n        ...newVehicle,\n        id: mongoVehicle._id || newVehicle.id,\n        // Ensure boolean fields have default values\n        isListed: newVehicle.isListed || false,\n        isAuctioned: newVehicle.isAuctioned || false\n      };\n      console.log('Vehicle with ID conversion:', vehicleWithId);\n      dispatch({\n        type: 'ADD_VEHICLE',\n        payload: vehicleWithId\n      });\n      console.log('Vehicle added to state, current vehicles count:', state.vehicles.length + 1);\n\n      // Reload user data to ensure everything is in sync\n      if (state.currentUser) {\n        console.log('Reloading user data after vehicle addition');\n        await loadUserData(state.currentUser.id);\n        console.log('User data reloaded, vehicles count:', state.vehicles.length);\n      }\n    } catch (error) {\n      console.error('Error adding vehicle:', error);\n    }\n  };\n  const updateVehicle = async updatedVehicle => {\n    try {\n      const vehicle = await ApiService.updateVehicle(updatedVehicle.id, updatedVehicle);\n      dispatch({\n        type: 'UPDATE_VEHICLE',\n        payload: vehicle\n      });\n    } catch (error) {\n      console.error('Error updating vehicle:', error);\n    }\n  };\n  const deleteVehicle = async vehicleId => {\n    try {\n      await ApiService.deleteVehicle(vehicleId);\n      dispatch({\n        type: 'DELETE_VEHICLE',\n        payload: vehicleId\n      });\n    } catch (error) {\n      console.error('Error deleting vehicle:', error);\n    }\n  };\n  const addListing = async listingData => {\n    if (!state.currentUser) return;\n    try {\n      const newListing = await ApiService.createListing(listingData);\n      // Convert MongoDB _id to id for frontend compatibility\n      const mongoListing = newListing;\n      const listingWithId = {\n        ...newListing,\n        id: mongoListing._id || newListing.id\n      };\n      dispatch({\n        type: 'ADD_LISTING',\n        payload: listingWithId\n      });\n\n      // Update vehicle to mark as listed immediately in local state\n      const vehicle = state.vehicles.find(v => v.id === listingData.vehicleId);\n      if (vehicle) {\n        const updatedVehicle = {\n          ...vehicle,\n          isListed: true,\n          listingId: listingWithId.id,\n          updatedAt: new Date().toISOString()\n        };\n        // Update local state immediately\n        dispatch({\n          type: 'UPDATE_VEHICLE',\n          payload: updatedVehicle\n        });\n      }\n\n      // Reload all user data to ensure everything is in sync\n      if (state.currentUser) {\n        await loadUserData(state.currentUser.id);\n      }\n\n      // Also refresh all listings to ensure new listing appears immediately\n      await loadAllListings(true);\n    } catch (error) {\n      console.error('Error adding listing:', error);\n    }\n  };\n  const updateListing = async updatedListing => {\n    try {\n      const listing = await ApiService.updateListing(updatedListing.id, updatedListing);\n      dispatch({\n        type: 'UPDATE_LISTING',\n        payload: listing\n      });\n\n      // Reload user data to ensure everything is in sync\n      if (state.currentUser) {\n        await loadUserData(state.currentUser.id);\n      }\n\n      // Also refresh all listings to ensure price changes are visible immediately\n      await loadAllListings(true);\n    } catch (error) {\n      console.error('Error updating listing:', error);\n    }\n  };\n  const deleteListing = async listingId => {\n    try {\n      await ApiService.deleteListing(listingId);\n      dispatch({\n        type: 'DELETE_LISTING',\n        payload: listingId\n      });\n\n      // Reload user data to ensure everything is in sync\n      if (state.currentUser) {\n        await loadUserData(state.currentUser.id);\n      }\n    } catch (error) {\n      console.error('Error deleting listing:', error);\n    }\n  };\n  const renewListing = async listingId => {\n    try {\n      const response = await ApiService.renewListing(listingId);\n      const renewedListing = {\n        ...response.listing,\n        id: response.listing.id\n      };\n      dispatch({\n        type: 'UPDATE_LISTING',\n        payload: renewedListing\n      });\n\n      // Reload user data to ensure everything is in sync\n      if (state.currentUser) {\n        await loadUserData(state.currentUser.id);\n      }\n\n      // Also refresh all listings to show updated renewal time\n      await loadAllListings(true);\n    } catch (error) {\n      console.error('Error renewing listing:', error);\n    }\n  };\n  const incrementListingViews = async listingId => {\n    try {\n      // The backend automatically increments views when getting a listing\n      await ApiService.getListing(listingId);\n\n      // Update local state by incrementing views\n      const listing = state.listings.find(l => l.id === listingId);\n      if (listing) {\n        const updatedListing = {\n          ...listing,\n          views: listing.views + 1,\n          updatedAt: new Date().toISOString()\n        };\n        dispatch({\n          type: 'UPDATE_LISTING',\n          payload: updatedListing\n        });\n      }\n    } catch (error) {\n      console.error('Error incrementing listing views:', error);\n    }\n  };\n  const addReview = async reviewData => {\n    try {\n      const response = await ApiService.createReview(reviewData);\n      // Reload all data to update ratings\n      await loadAllListings();\n    } catch (error) {\n      console.error('Error adding review:', error);\n    }\n  };\n  const getUserProfile = userId => {\n    console.log('getUserProfile called with userId:', userId);\n    console.log('Available users:', state.users.map(u => ({\n      id: u.id,\n      username: u.username\n    })));\n\n    // Try direct match first\n    let user = state.users.find(u => u.id === userId);\n\n    // If not found, try matching with MongoDB ObjectId format\n    if (!user) {\n      user = state.users.find(u => {\n        const uId = u._id || u.id;\n        return uId === userId;\n      });\n    }\n    console.log('getUserProfile result:', user ? {\n      id: user.id,\n      username: user.username\n    } : null);\n    return user || null;\n  };\n  const sendMessage = async messageData => {\n    try {\n      const newMessage = await ApiService.sendMessage(messageData);\n      dispatch({\n        type: 'ADD_MESSAGE',\n        payload: newMessage\n      });\n\n      // For now, we'll skip reloading conversations since the API method doesn't exist yet\n      // TODO: Implement getUserConversations in ApiService\n    } catch (error) {\n      console.error('Error sending message:', error);\n    }\n  };\n  const markMessagesAsRead = async conversationId => {\n    if (!state.currentUser) return;\n    try {\n      await ApiService.markMessagesAsRead(conversationId);\n      const messages = await ApiService.getUserMessages();\n      dispatch({\n        type: 'SET_MESSAGES',\n        payload: messages\n      });\n      // TODO: Reload conversations when API method is available\n    } catch (error) {\n      console.error('Error marking messages as read:', error);\n    }\n  };\n  const addTrade = async tradeData => {\n    try {\n      const newTrade = await ApiService.createTrade(tradeData);\n      // Convert MongoDB _id to id for frontend compatibility\n      const mongoTrade = newTrade;\n      const tradeWithId = {\n        ...newTrade,\n        id: mongoTrade._id || newTrade.id\n      };\n      dispatch({\n        type: 'ADD_TRADE',\n        payload: tradeWithId\n      });\n    } catch (error) {\n      console.error('Error adding trade:', error);\n    }\n  };\n  const updateTrade = async updatedTrade => {\n    try {\n      const trade = await ApiService.updateTrade(updatedTrade.id, updatedTrade);\n      dispatch({\n        type: 'UPDATE_TRADE',\n        payload: trade\n      });\n    } catch (error) {\n      console.error('Error updating trade:', error);\n    }\n  };\n\n  // Memoize the context value to prevent unnecessary re-renders\n  const contextValue = useMemo(() => ({\n    state,\n    dispatch,\n    login,\n    register,\n    logout,\n    updateUser,\n    addVehicle,\n    updateVehicle,\n    deleteVehicle,\n    addListing,\n    updateListing,\n    deleteListing,\n    renewListing,\n    incrementListingViews,\n    loadAllListings,\n    addReview,\n    getUserProfile,\n    sendMessage,\n    markMessagesAsRead,\n    addTrade,\n    updateTrade,\n    activeTab,\n    setActiveTab\n  }), [state, dispatch, login, logout, updateUser, addVehicle, updateVehicle, deleteVehicle, addListing, updateListing, deleteListing, renewListing, incrementListingViews, loadAllListings, addReview, getUserProfile, sendMessage, markMessagesAsRead, addTrade, updateTrade, activeTab, setActiveTab]);\n  return /*#__PURE__*/_jsxDEV(AppContext.Provider, {\n    value: contextValue,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 657,\n    columnNumber: 10\n  }, this);\n}\n_s(AppProvider, \"Cp54A8QDW415lIvb0Bpjq0X1Go4=\");\n_c = AppProvider;\nexport function useApp() {\n  _s2();\n  const context = useContext(AppContext);\n  if (context === undefined) {\n    throw new Error('useApp must be used within an AppProvider');\n  }\n  return context;\n}\n_s2(useApp, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nvar _c;\n$RefreshReg$(_c, \"AppProvider\");","map":{"version":3,"names":["React","createContext","useContext","useReducer","useEffect","useState","useMemo","useCallback","AuthService","ApiService","jsxDEV","_jsxDEV","initialState","currentUser","vehicles","listings","allListings","auctions","trades","messages","conversations","reviews","sales","users","isAuthenticated","loading","error","appReducer","state","action","type","payload","map","v","id","filter","l","t","AppContext","undefined","AppProvider","children","_s","dispatch","activeTab","setActiveTab","listingsCache","setListingsCache","data","timestamp","ttl","initializeAuth","token","localStorage","getItem","console","log","authCheck","verifyToken","valid","user","_id","loadUserData","logout","loadAllUsers","userId","Promise","all","getUserVehicles","getUserListings","getUserMessages","getUserTrades","vehiclesWithId","listingsWithId","messagesWithId","m","tradesWithId","getAllUsers","usersWithId","u","username","loadAllListings","forceRefresh","now","Date","length","time","response","getAllListings","timeEnd","listing","vehicleId","sellerId","vehicle","seller","warn","login","password","rememberMe","success","message","removeItem","register","userData","updateUser","addVehicle","vehicleData","newVehicle","createVehicle","mongoVehicle","vehicleWithId","isListed","isAuctioned","updateVehicle","updatedVehicle","deleteVehicle","addListing","listingData","newListing","createListing","mongoListing","listingWithId","find","listingId","updatedAt","toISOString","updateListing","updatedListing","deleteListing","renewListing","renewedListing","incrementListingViews","getListing","views","addReview","reviewData","createReview","getUserProfile","uId","sendMessage","messageData","newMessage","markMessagesAsRead","conversationId","addTrade","tradeData","newTrade","createTrade","mongoTrade","tradeWithId","updateTrade","updatedTrade","trade","contextValue","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","useApp","_s2","context","Error","$RefreshReg$"],"sources":["C:/Users/thato/Downloads/car-app/src/context/AppContext.tsx"],"sourcesContent":["import React, { createContext, useContext, useReducer, useEffect, ReactNode, useState, useMemo, useCallback } from 'react';\nimport { AppState, User, Vehicle, Listing, Auction, Trade, Message, Conversation, Review, NavigationTab } from '../types/index.ts';\nimport { AuthService } from '../services/authService.ts';\nimport { DataService } from '../services/dataService.ts';\nimport ApiService from '../services/apiService.ts';\n\ninterface AppContextType {\n  state: AppState;\n  dispatch: React.Dispatch<AppAction>;\n  login: (username: string, password: string, rememberMe?: boolean) => Promise<{ success: boolean; error?: string }>;\n  register: (userData: Omit<User, 'id' | 'createdAt'>) => Promise<{ success: boolean; error?: string }>;\n  logout: () => void;\n  updateUser: (user: User) => void;\n  addVehicle: (vehicle: {\n    make: string;\n    model: string;\n    year: number;\n    vin: string;\n    mileage: number;\n    transmission: 'manual' | 'automatic';\n    estimatedValue: number;\n    customPrice?: number;\n    images?: string[];\n  }) => Promise<void>;\n  updateVehicle: (vehicle: Vehicle) => Promise<void>;\n  deleteVehicle: (vehicleId: string) => Promise<void>;\n  addListing: (listing: Omit<Listing, 'id' | 'createdAt' | 'updatedAt' | 'views'>) => Promise<void>;\n  updateListing: (listing: Listing) => Promise<void>;\n  deleteListing: (listingId: string) => Promise<void>;\n  renewListing: (listingId: string) => Promise<void>;\n  incrementListingViews: (listingId: string) => Promise<void>;\n  loadAllListings: (forceRefresh?: boolean) => Promise<void>;\n  addReview: (review: Omit<Review, 'id' | 'createdAt'>) => Promise<void>;\n  getUserProfile: (userId: string) => User | null;\n  sendMessage: (message: Omit<Message, 'id' | 'timestamp' | 'read'>) => Promise<void>;\n  markMessagesAsRead: (conversationId: string) => Promise<void>;\n  addTrade: (trade: Omit<Trade, 'id' | 'createdAt' | 'updatedAt'>) => Promise<void>;\n  updateTrade: (trade: Trade) => Promise<void>;\n  activeTab: NavigationTab;\n  setActiveTab: (tab: NavigationTab) => void;\n}\n\ntype AppAction = \n  | { type: 'SET_USER'; payload: User | null }\n  | { type: 'SET_CURRENT_USER'; payload: User }\n  | { type: 'LOGOUT' }\n  | { type: 'SET_LOADING'; payload: boolean }\n  | { type: 'SET_ERROR'; payload: string | null }\n  | { type: 'SET_VEHICLES'; payload: Vehicle[] }\n  | { type: 'ADD_VEHICLE'; payload: Vehicle }\n  | { type: 'UPDATE_VEHICLE'; payload: Vehicle }\n  | { type: 'DELETE_VEHICLE'; payload: string }\n  | { type: 'SET_LISTINGS'; payload: Listing[] }\n  | { type: 'SET_ALL_LISTINGS'; payload: Listing[] }\n  | { type: 'ADD_LISTING'; payload: Listing }\n  | { type: 'UPDATE_LISTING'; payload: Listing }\n  | { type: 'DELETE_LISTING'; payload: string }\n  | { type: 'SET_TRADES'; payload: Trade[] }\n  | { type: 'ADD_TRADE'; payload: Trade }\n  | { type: 'UPDATE_TRADE'; payload: Trade }\n  | { type: 'SET_MESSAGES'; payload: Message[] }\n  | { type: 'ADD_MESSAGE'; payload: Message }\n  | { type: 'SET_CONVERSATIONS'; payload: Conversation[] }\n  | { type: 'SET_REVIEWS'; payload: Review[] }\n  | { type: 'SET_USERS'; payload: User[] }\n  | { type: 'SET_ACTIVE_TAB'; payload: NavigationTab };\n\nconst initialState: AppState = {\n  currentUser: null,\n  vehicles: [],\n  listings: [],\n  allListings: [],\n  auctions: [],\n  trades: [],\n  messages: [],\n  conversations: [],\n  reviews: [],\n  sales: [],\n  users: [],\n  isAuthenticated: false,\n  loading: false,\n  error: null,\n};\n\nfunction appReducer(state: AppState, action: AppAction): AppState {\n  switch (action.type) {\n    case 'SET_USER':\n      return {\n        ...state,\n        currentUser: action.payload,\n        isAuthenticated: action.payload !== null,\n      };\n    case 'SET_CURRENT_USER':\n      return {\n        ...state,\n        currentUser: action.payload,\n        isAuthenticated: true,\n      };\n    case 'LOGOUT':\n      return {\n        ...initialState, // Reset to initial state\n        isAuthenticated: false,\n      };\n    case 'SET_LOADING':\n      return { ...state, loading: action.payload };\n    case 'SET_ERROR':\n      return { ...state, error: action.payload };\n    case 'SET_VEHICLES':\n      return { ...state, vehicles: action.payload };\n    case 'ADD_VEHICLE':\n      return { ...state, vehicles: [...state.vehicles, action.payload] };\n    case 'UPDATE_VEHICLE':\n      return {\n        ...state,\n        vehicles: state.vehicles.map(v => v.id === action.payload.id ? action.payload : v),\n      };\n    case 'DELETE_VEHICLE':\n      return {\n        ...state,\n        vehicles: state.vehicles.filter(v => v.id !== action.payload),\n      };\n    case 'SET_LISTINGS':\n      return { ...state, listings: action.payload };\n    case 'ADD_LISTING':\n      return { ...state, listings: [...state.listings, action.payload] };\n    case 'UPDATE_LISTING':\n      return {\n        ...state,\n        listings: state.listings.map(l => l.id === action.payload.id ? action.payload : l),\n      };\n    case 'DELETE_LISTING':\n      return {\n        ...state,\n        listings: state.listings.filter(l => l.id !== action.payload),\n      };\n    case 'SET_TRADES':\n      return { ...state, trades: action.payload };\n    case 'ADD_TRADE':\n      return { ...state, trades: [...state.trades, action.payload] };\n    case 'UPDATE_TRADE':\n      return {\n        ...state,\n        trades: state.trades.map(t => t.id === action.payload.id ? action.payload : t),\n      };\n    case 'SET_MESSAGES':\n      return { ...state, messages: action.payload };\n    case 'ADD_MESSAGE':\n      return { ...state, messages: [...state.messages, action.payload] };\n    case 'SET_CONVERSATIONS':\n      return { ...state, conversations: action.payload };\n    case 'SET_REVIEWS':\n      return { ...state, reviews: action.payload };\n    case 'SET_USERS':\n      return { ...state, users: action.payload };\n    case 'SET_ALL_LISTINGS':\n      return { ...state, allListings: action.payload };\n    default:\n      return state;\n  }\n}\n\nconst AppContext = createContext<AppContextType | undefined>(undefined);\n\ninterface AppProviderProps {\n  children: ReactNode;\n}\n\nexport function AppProvider({ children }: AppProviderProps) {\n  const [state, dispatch] = useReducer(appReducer, initialState);\n  const [activeTab, setActiveTab] = React.useState<NavigationTab>('garage');\n  const [listingsCache, setListingsCache] = useState<{\n    data: any[];\n    timestamp: number;\n    ttl: number;\n  }>({ data: [], timestamp: 0, ttl: 30000 }); // 30 second cache\n\n  useEffect(() => {\n    // Initialize app state by checking API authentication\n    const initializeAuth = async () => {\n      try {\n        // Only check if there's a token present\n        const token = localStorage.getItem('carTrade_token');\n        if (!token) {\n          console.log('No token found, user not authenticated');\n          return;\n        }\n\n        const authCheck = await ApiService.verifyToken();\n        if (authCheck.valid && authCheck.user) {\n          const user = { ...authCheck.user, id: (authCheck.user as any)._id || authCheck.user.id };\n          dispatch({ type: 'SET_CURRENT_USER', payload: user });\n          await loadUserData(user.id);\n          console.log('User authenticated and data loaded');\n        } else {\n          console.log('Token invalid, clearing authentication');\n          ApiService.logout();\n          AuthService.logout();\n        }\n      } catch (error) {\n        console.log('Authentication check failed:', error);\n        // Clear any stale tokens on error\n        ApiService.logout();\n        AuthService.logout();\n        dispatch({ type: 'LOGOUT' });\n      }\n    };\n\n    initializeAuth();\n    // Load all users for the seller profiles using API\n    loadAllUsers();\n  }, []);\n\n  const loadUserData = async (userId: string) => {\n    try {\n      const [vehicles, listings, messages, trades] = await Promise.all([\n        ApiService.getUserVehicles(),\n        ApiService.getUserListings(),\n        ApiService.getUserMessages(),\n        ApiService.getUserTrades()\n      ]);\n\n      // Convert MongoDB _id to id for frontend compatibility\n      const vehiclesWithId = vehicles.map((v: any) => ({ ...v, id: v._id || v.id }));\n      const listingsWithId = listings.map((l: any) => ({ ...l, id: l._id || l.id }));\n      const messagesWithId = messages.map((m: any) => ({ ...m, id: m._id || m.id }));\n      const tradesWithId = trades.map((t: any) => ({ ...t, id: t._id || t.id }));\n\n      dispatch({ type: 'SET_VEHICLES', payload: vehiclesWithId });\n      dispatch({ type: 'SET_LISTINGS', payload: listingsWithId });\n      dispatch({ type: 'SET_MESSAGES', payload: messagesWithId });\n      dispatch({ type: 'SET_TRADES', payload: tradesWithId });\n    } catch (error) {\n      console.error('Error loading user data:', error);\n    }\n  };\n\n  const loadAllUsers = async () => {\n    try {\n      const users = await ApiService.getAllUsers();\n      const usersWithId = users.map((u: any) => ({ \n        ...u, \n        id: u._id || u.id \n      }));\n      console.log('Loaded users:', usersWithId.map(u => ({ id: u.id, username: u.username })));\n      dispatch({ type: 'SET_USERS', payload: usersWithId });\n    } catch (error) {\n      console.error('Error loading users:', error);\n      // Fallback to empty array if API fails\n      dispatch({ type: 'SET_USERS', payload: [] });\n    }\n  };\n\n  // Memoize callback functions to prevent unnecessary re-renders\n  const loadAllListings = useCallback(async (forceRefresh: boolean = false) => {\n    try {\n      // Check cache first (unless force refresh)\n      const now = Date.now();\n      if (!forceRefresh && listingsCache.data.length > 0 && (now - listingsCache.timestamp) < listingsCache.ttl) {\n        console.log('Using cached listings data');\n        dispatch({ type: 'SET_ALL_LISTINGS', payload: listingsCache.data });\n        return;\n      }\n\n      console.time('loadAllListings');\n      console.time('API call');\n      \n      // Load all public listings from the API\n      const response = await ApiService.getAllListings();\n      console.timeEnd('API call');\n      console.log('Raw API response:', response);\n      \n      console.time('Data processing');\n      \n      // Optimize data processing - avoid complex operations in map\n      const listingsWithId = response.listings.map((l: any) => {\n        // Simple ID conversion only\n        const listing = {\n          ...l, \n          id: l._id || l.id,\n          vehicleId: l.vehicleId,\n          sellerId: l.sellerId,\n        };\n        \n        // Add populated data if it exists from backend aggregation\n        if (l.vehicle && typeof l.vehicle === 'object' && l.vehicle._id) {\n          listing.vehicle = { \n            ...l.vehicle, \n            id: l.vehicle._id || l.vehicle.id \n          };\n        }\n        \n        if (l.seller && typeof l.seller === 'object' && l.seller._id) {\n          listing.seller = { \n            ...l.seller, \n            id: l.seller._id || l.seller.id \n          };\n        }\n        \n        return listing;\n      });\n      \n      console.timeEnd('Data processing');\n      console.log('Processed listings count:', listingsWithId.length);\n      \n      // Also load all users to ensure seller profiles are available\n      // This ensures getUserProfile can find sellers even if they're not in the populated data\n      try {\n        await loadAllUsers();\n        console.log('Users loaded alongside listings');\n      } catch (error) {\n        console.warn('Failed to load users alongside listings:', error);\n      }\n      \n      // Update cache\n      setListingsCache({\n        data: listingsWithId,\n        timestamp: now,\n        ttl: 30000\n      });\n      \n      dispatch({ type: 'SET_ALL_LISTINGS', payload: listingsWithId });\n      console.timeEnd('loadAllListings');\n      \n    } catch (error) {\n      console.error('Error loading all listings:', error);\n      // Fallback to empty array if API fails\n      dispatch({ type: 'SET_ALL_LISTINGS', payload: [] });\n    }\n  }, [listingsCache.data, listingsCache.timestamp, listingsCache.ttl]);\n\n  // Memoize other frequently used functions\n  const login = useCallback(async (username: string, password: string, rememberMe: boolean = false) => {\n    try {\n      const response = await ApiService.login(username, password);\n      // The ApiService.login should automatically store the token\n      const user = { ...response.user, id: (response.user as any)._id || response.user.id };\n      dispatch({ type: 'SET_CURRENT_USER', payload: user });\n      // Load user data after successful login\n      await loadUserData(user.id);\n      return { success: true };\n    } catch (error: any) {\n      console.error('Login error:', error);\n      return { success: false, error: error.message || 'Login failed' };\n    }\n  }, []);\n\n  const logout = useCallback(() => {\n    // Clear both API token and AuthService localStorage data\n    ApiService.logout();\n    AuthService.logout();\n    \n    // Clear any additional auth-related localStorage items\n    localStorage.removeItem('carTrade_remember');\n    \n    dispatch({ type: 'LOGOUT' });\n    setActiveTab('garage');\n    // Clear cache on logout\n    setListingsCache({ data: [], timestamp: 0, ttl: 30000 });\n    \n    console.log('Logout completed - all tokens and data cleared');\n  }, []);\n\n  const register = useCallback(async (userData: Omit<User, 'id' | 'createdAt'>) => {\n    try {\n      const response = await ApiService.register(userData);\n      const user = { ...response.user, id: (response.user as any)._id || response.user.id };\n      dispatch({ type: 'SET_CURRENT_USER', payload: user });\n      // Load user data after successful registration\n      await loadUserData(user.id);\n      return { success: true };\n    } catch (error: any) {\n      console.error('Registration error:', error);\n      return { success: false, error: error.message || 'Registration failed' };\n    }\n  }, []);\n\n  const updateUser = (user: User) => {\n    try {\n      console.log('Context updateUser called with:', user);\n      AuthService.updateUser(user);\n      dispatch({ type: 'SET_USER', payload: user });\n      console.log('User updated successfully in context');\n    } catch (error) {\n      console.error('Error in context updateUser:', error);\n      throw error;\n    }\n  };\n\n  const addVehicle = async (vehicleData: {\n    make: string;\n    model: string;\n    year: number;\n    vin: string;\n    mileage: number;\n    transmission: 'manual' | 'automatic';\n    estimatedValue: number;\n    customPrice?: number;\n    images?: string[];\n  }) => {\n    if (!state.currentUser) return;\n\n    try {\n      console.log('Adding vehicle with data:', vehicleData);\n      const newVehicle = await ApiService.createVehicle(vehicleData);\n      console.log('Vehicle created by API:', newVehicle);\n      \n      // Convert MongoDB _id to id for frontend compatibility\n      const mongoVehicle = newVehicle as any;\n      const vehicleWithId = { \n        ...newVehicle, \n        id: mongoVehicle._id || newVehicle.id,\n        // Ensure boolean fields have default values\n        isListed: newVehicle.isListed || false,\n        isAuctioned: newVehicle.isAuctioned || false\n      };\n      \n      console.log('Vehicle with ID conversion:', vehicleWithId);\n      dispatch({ type: 'ADD_VEHICLE', payload: vehicleWithId });\n      console.log('Vehicle added to state, current vehicles count:', state.vehicles.length + 1);\n      \n      // Reload user data to ensure everything is in sync\n      if (state.currentUser) {\n        console.log('Reloading user data after vehicle addition');\n        await loadUserData(state.currentUser.id);\n        console.log('User data reloaded, vehicles count:', state.vehicles.length);\n      }\n    } catch (error) {\n      console.error('Error adding vehicle:', error);\n    }\n  };\n\n  const updateVehicle = async (updatedVehicle: Vehicle) => {\n    try {\n      const vehicle = await ApiService.updateVehicle(updatedVehicle.id, updatedVehicle);\n      dispatch({ type: 'UPDATE_VEHICLE', payload: vehicle });\n    } catch (error) {\n      console.error('Error updating vehicle:', error);\n    }\n  };\n\n  const deleteVehicle = async (vehicleId: string) => {\n    try {\n      await ApiService.deleteVehicle(vehicleId);\n      dispatch({ type: 'DELETE_VEHICLE', payload: vehicleId });\n    } catch (error) {\n      console.error('Error deleting vehicle:', error);\n    }\n  };\n\n  const addListing = async (listingData: Omit<Listing, 'id' | 'createdAt' | 'updatedAt' | 'views'>) => {\n    if (!state.currentUser) return;\n\n    try {\n      const newListing = await ApiService.createListing(listingData);\n      // Convert MongoDB _id to id for frontend compatibility\n      const mongoListing = newListing as any;\n      const listingWithId = { ...newListing, id: mongoListing._id || newListing.id };\n      dispatch({ type: 'ADD_LISTING', payload: listingWithId });\n\n      // Update vehicle to mark as listed immediately in local state\n      const vehicle = state.vehicles.find(v => v.id === listingData.vehicleId);\n      if (vehicle) {\n        const updatedVehicle: Vehicle = {\n          ...vehicle,\n          isListed: true,\n          listingId: listingWithId.id,\n          updatedAt: new Date().toISOString(),\n        };\n        // Update local state immediately\n        dispatch({ type: 'UPDATE_VEHICLE', payload: updatedVehicle });\n      }\n\n      // Reload all user data to ensure everything is in sync\n      if (state.currentUser) {\n        await loadUserData(state.currentUser.id);\n      }\n      \n      // Also refresh all listings to ensure new listing appears immediately\n      await loadAllListings(true);\n      \n    } catch (error) {\n      console.error('Error adding listing:', error);\n    }\n  };\n\n  const updateListing = async (updatedListing: Listing) => {\n    try {\n      const listing = await ApiService.updateListing(updatedListing.id, updatedListing);\n      dispatch({ type: 'UPDATE_LISTING', payload: listing });\n      \n      // Reload user data to ensure everything is in sync\n      if (state.currentUser) {\n        await loadUserData(state.currentUser.id);\n      }\n      \n      // Also refresh all listings to ensure price changes are visible immediately\n      await loadAllListings(true);\n    } catch (error) {\n      console.error('Error updating listing:', error);\n    }\n  };\n\n  const deleteListing = async (listingId: string) => {\n    try {\n      await ApiService.deleteListing(listingId);\n      dispatch({ type: 'DELETE_LISTING', payload: listingId });\n\n      // Reload user data to ensure everything is in sync\n      if (state.currentUser) {\n        await loadUserData(state.currentUser.id);\n      }\n    } catch (error) {\n      console.error('Error deleting listing:', error);\n    }\n  };\n\n  const renewListing = async (listingId: string) => {\n    try {\n      const response = await ApiService.renewListing(listingId);\n      const renewedListing = { ...response.listing, id: response.listing.id };\n      dispatch({ type: 'UPDATE_LISTING', payload: renewedListing });\n      \n      // Reload user data to ensure everything is in sync\n      if (state.currentUser) {\n        await loadUserData(state.currentUser.id);\n      }\n      \n      // Also refresh all listings to show updated renewal time\n      await loadAllListings(true);\n    } catch (error) {\n      console.error('Error renewing listing:', error);\n    }\n  };\n\n  const incrementListingViews = async (listingId: string) => {\n    try {\n      // The backend automatically increments views when getting a listing\n      await ApiService.getListing(listingId);\n      \n      // Update local state by incrementing views\n      const listing = state.listings.find(l => l.id === listingId);\n      if (listing) {\n        const updatedListing: Listing = {\n          ...listing,\n          views: listing.views + 1,\n          updatedAt: new Date().toISOString(),\n        };\n        dispatch({ type: 'UPDATE_LISTING', payload: updatedListing });\n      }\n    } catch (error) {\n      console.error('Error incrementing listing views:', error);\n    }\n  };\n\n  const addReview = async (reviewData: Omit<Review, 'id' | 'createdAt'>) => {\n    try {\n      const response = await ApiService.createReview(reviewData);\n      // Reload all data to update ratings\n      await loadAllListings();\n    } catch (error) {\n      console.error('Error adding review:', error);\n    }\n  };\n\n  const getUserProfile = (userId: string): User | null => {\n    console.log('getUserProfile called with userId:', userId);\n    console.log('Available users:', state.users.map(u => ({ id: u.id, username: u.username })));\n    \n    // Try direct match first\n    let user = state.users.find(u => u.id === userId);\n    \n    // If not found, try matching with MongoDB ObjectId format\n    if (!user) {\n      user = state.users.find(u => {\n        const uId = (u as any)._id || u.id;\n        return uId === userId;\n      });\n    }\n    \n    console.log('getUserProfile result:', user ? { id: user.id, username: user.username } : null);\n    return user || null;\n  };\n\n  const sendMessage = async (messageData: Omit<Message, 'id' | 'timestamp' | 'read'>) => {\n    try {\n      const newMessage = await ApiService.sendMessage(messageData);\n      dispatch({ type: 'ADD_MESSAGE', payload: newMessage });\n      \n      // For now, we'll skip reloading conversations since the API method doesn't exist yet\n      // TODO: Implement getUserConversations in ApiService\n    } catch (error) {\n      console.error('Error sending message:', error);\n    }\n  };\n\n  const markMessagesAsRead = async (conversationId: string) => {\n    if (!state.currentUser) return;\n    \n    try {\n      await ApiService.markMessagesAsRead(conversationId);\n      const messages = await ApiService.getUserMessages();\n      dispatch({ type: 'SET_MESSAGES', payload: messages });\n      // TODO: Reload conversations when API method is available\n    } catch (error) {\n      console.error('Error marking messages as read:', error);\n    }\n  };\n\n  const addTrade = async (tradeData: Omit<Trade, 'id' | 'createdAt' | 'updatedAt'>) => {\n    try {\n      const newTrade = await ApiService.createTrade(tradeData);\n      // Convert MongoDB _id to id for frontend compatibility\n      const mongoTrade = newTrade as any;\n      const tradeWithId = { ...newTrade, id: mongoTrade._id || newTrade.id };\n      dispatch({ type: 'ADD_TRADE', payload: tradeWithId });\n    } catch (error) {\n      console.error('Error adding trade:', error);\n    }\n  };\n\n  const updateTrade = async (updatedTrade: Trade) => {\n    try {\n      const trade = await ApiService.updateTrade(updatedTrade.id, updatedTrade);\n      dispatch({ type: 'UPDATE_TRADE', payload: trade });\n    } catch (error) {\n      console.error('Error updating trade:', error);\n    }\n  };\n\n  // Memoize the context value to prevent unnecessary re-renders\n  const contextValue = useMemo(() => ({\n    state,\n    dispatch,\n    login,\n    register,\n    logout,\n    updateUser,\n    addVehicle,\n    updateVehicle,\n    deleteVehicle,\n    addListing,\n    updateListing,\n    deleteListing,\n    renewListing,\n    incrementListingViews,\n    loadAllListings,\n    addReview,\n    getUserProfile,\n    sendMessage,\n    markMessagesAsRead,\n    addTrade,\n    updateTrade,\n    activeTab,\n    setActiveTab,\n  }), [state, dispatch, login, logout, updateUser, addVehicle, updateVehicle, deleteVehicle, addListing, updateListing, deleteListing, renewListing, incrementListingViews, loadAllListings, addReview, getUserProfile, sendMessage, markMessagesAsRead, addTrade, updateTrade, activeTab, setActiveTab]);\n\n  return <AppContext.Provider value={contextValue}>{children}</AppContext.Provider>;\n}\n\nexport function useApp() {\n  const context = useContext(AppContext);\n  if (context === undefined) {\n    throw new Error('useApp must be used within an AppProvider');\n  }\n  return context;\n} "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}