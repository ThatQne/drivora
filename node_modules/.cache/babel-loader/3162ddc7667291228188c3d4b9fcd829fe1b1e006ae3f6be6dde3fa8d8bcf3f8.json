{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\thato\\\\Downloads\\\\car-app\\\\src\\\\components\\\\trades\\\\TradeOfferModal.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useMemo, useEffect } from 'react';\nimport { motion } from 'framer-motion';\nimport { X, Car, DollarSign, Plus, Minus, Search, Check, ArrowRight, AlertCircle } from 'lucide-react';\nimport { useApp } from '../../context/AppContext.tsx';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport function TradeOfferModal({\n  onClose,\n  selectedListing,\n  existingTrade\n}) {\n  _s();\n  var _state$currentUser2, _state$currentUser6, _state$currentUser8;\n  const {\n    state,\n    addTrade,\n    updateTrade,\n    reloadTrades,\n    deleteTrade,\n    getUserVehicles\n  } = useApp();\n  const [step, setStep] = useState(selectedListing || existingTrade ? 'build-offer' : 'select-listing');\n  const [searchTerm, setSearchTerm] = useState('');\n  const [targetListing, setTargetListing] = useState(selectedListing || null);\n  const [selectedVehicles, setSelectedVehicles] = useState(() => {\n    if (existingTrade) {\n      // We need to wait for targetListing to be set, so start with empty array\n      // The initialization will be handled in a useEffect after targetListing is available\n      return [];\n    }\n    return [];\n  });\n  const [cashAmount, setCashAmount] = useState(() => {\n    if (existingTrade) {\n      // Start with the most recent offer amount as reference\n      // We'll refine this in a useEffect once targetListing is available\n      if (existingTrade.status === 'countered' && existingTrade.receiverCashAmount !== undefined) {\n        return existingTrade.receiverCashAmount;\n      } else {\n        return existingTrade.offererCashAmount;\n      }\n    }\n    return 0;\n  });\n  const [message, setMessage] = useState((existingTrade === null || existingTrade === void 0 ? void 0 : existingTrade.message) || '');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [cashDirection, setCashDirection] = useState(existingTrade ? existingTrade.offererCashAmount >= 0 ? 'add' : 'request' : 'add');\n  const [offererVehicles, setOffererVehicles] = useState([]);\n  const [loadingOffererVehicles, setLoadingOffererVehicles] = useState(false);\n\n  // Initialize target listing from existing trade\n  useEffect(() => {\n    if (existingTrade && !targetListing) {\n      // Find the listing from the existing trade\n      const listing = state.allListings.find(l => l.id === existingTrade.listingId);\n      if (listing) {\n        setTargetListing(listing);\n      }\n    }\n  }, [existingTrade, targetListing, state.allListings]);\n\n  // Initialize selected vehicles and cash amount once targetListing is available\n  useEffect(() => {\n    if (existingTrade && targetListing && state.currentUser) {\n      const listingOwnerId = targetListing.sellerId;\n      const isOriginalReceiver = state.currentUser.id === listingOwnerId;\n      console.log('🔧 Initializing trade modal:', {\n        listingOwnerId,\n        currentUserId: state.currentUser.id,\n        isOriginalReceiver,\n        existingTradeStatus: existingTrade.status,\n        existingOffererCash: existingTrade.offererCashAmount,\n        existingReceiverCash: existingTrade.receiverCashAmount,\n        existingOffererVehicles: existingTrade.offererVehicleIds,\n        existingReceiverVehicles: existingTrade.receiverVehicleIds\n      });\n\n      // Initialize selected vehicles based on role\n      if (isOriginalReceiver) {\n        // Original receiver countering - pre-select the offerer's vehicles as reference\n        setSelectedVehicles(existingTrade.offererVehicleIds);\n        console.log('🎯 Original receiver - pre-selecting offerer vehicles:', existingTrade.offererVehicleIds);\n      } else {\n        // Original offerer or subsequent counter - start with empty selection\n        setSelectedVehicles([]);\n        console.log('🎯 Original offerer/subsequent counter - starting with empty vehicles');\n      }\n\n      // Initialize cash amount based on role and trade status\n      let initialCashAmount = 0;\n      if (isOriginalReceiver) {\n        // Original receiver countering - start with the most recent offer amount as reference\n        if (existingTrade.status === 'countered' && existingTrade.receiverCashAmount !== undefined) {\n          initialCashAmount = existingTrade.receiverCashAmount;\n        } else {\n          initialCashAmount = existingTrade.offererCashAmount;\n        }\n      } else {\n        // Original offerer or subsequent counter - use most recent offer as reference\n        if (existingTrade.status === 'countered' && existingTrade.receiverCashAmount !== undefined) {\n          initialCashAmount = existingTrade.receiverCashAmount;\n        } else {\n          initialCashAmount = existingTrade.offererCashAmount;\n        }\n      }\n      console.log('💰 Setting initial cash amount:', initialCashAmount);\n      setCashAmount(initialCashAmount);\n    }\n  }, [existingTrade, targetListing, state.currentUser]);\n\n  // Fetch offerer's vehicles when original receiver is countering\n  useEffect(() => {\n    const fetchOffererVehicles = async () => {\n      if (existingTrade && targetListing) {\n        var _state$currentUser;\n        const listingOwnerId = targetListing.sellerId;\n        const isOriginalReceiver = ((_state$currentUser = state.currentUser) === null || _state$currentUser === void 0 ? void 0 : _state$currentUser.id) === listingOwnerId;\n        if (isOriginalReceiver) {\n          var _existingTrade$offere, _existingTrade$offere2;\n          // Get the offerer's user ID\n          const offererId = typeof existingTrade.offererUserId === 'string' ? existingTrade.offererUserId : ((_existingTrade$offere = existingTrade.offererUserId) === null || _existingTrade$offere === void 0 ? void 0 : _existingTrade$offere._id) || ((_existingTrade$offere2 = existingTrade.offererUserId) === null || _existingTrade$offere2 === void 0 ? void 0 : _existingTrade$offere2.id);\n          if (offererId) {\n            setLoadingOffererVehicles(true);\n            try {\n              const vehicles = await getUserVehicles(offererId);\n              setOffererVehicles(vehicles);\n            } catch (error) {\n              console.error('Error fetching offerer vehicles:', error);\n            } finally {\n              setLoadingOffererVehicles(false);\n            }\n          }\n        }\n      }\n    };\n    fetchOffererVehicles();\n  }, [existingTrade, targetListing, (_state$currentUser2 = state.currentUser) === null || _state$currentUser2 === void 0 ? void 0 : _state$currentUser2.id, getUserVehicles]);\n\n  // Available vehicles (user's own vehicles that are NOT auctioned)\n  const availableVehicles = useMemo(() => {\n    if (existingTrade) {\n      var _state$currentUser3;\n      // Determine the original listing owner (receiver) vs original offerer\n      // We need to check the trade history to find the original roles\n      const originalTradeEntry = existingTrade.tradeHistory.find(entry => entry.action === 'created');\n      const originalOffererId = originalTradeEntry === null || originalTradeEntry === void 0 ? void 0 : originalTradeEntry.userId;\n\n      // If we can't find the original trade entry, fall back to checking listing ownership\n      const listingOwnerId = targetListing === null || targetListing === void 0 ? void 0 : targetListing.sellerId;\n      const isOriginalReceiver = ((_state$currentUser3 = state.currentUser) === null || _state$currentUser3 === void 0 ? void 0 : _state$currentUser3.id) === listingOwnerId;\n      if (isOriginalReceiver) {\n        // Original receiver (listing owner) - show ALL offerer's vehicles to choose what they want\n        return loadingOffererVehicles ? [] : offererVehicles.filter(vehicle => !vehicle.isAuctioned);\n      } else {\n        // Original offerer or subsequent counter - show your own vehicles\n        return state.vehicles.filter(vehicle => {\n          var _state$currentUser4;\n          return !vehicle.isAuctioned && vehicle.ownerId === ((_state$currentUser4 = state.currentUser) === null || _state$currentUser4 === void 0 ? void 0 : _state$currentUser4.id);\n        });\n      }\n    } else {\n      // For new trades, show user's own vehicles\n      return state.vehicles.filter(vehicle => {\n        var _state$currentUser5;\n        return !vehicle.isAuctioned && vehicle.ownerId === ((_state$currentUser5 = state.currentUser) === null || _state$currentUser5 === void 0 ? void 0 : _state$currentUser5.id);\n      });\n    }\n  }, [state.vehicles, (_state$currentUser6 = state.currentUser) === null || _state$currentUser6 === void 0 ? void 0 : _state$currentUser6.id, existingTrade, targetListing, offererVehicles, loadingOffererVehicles]);\n\n  // Available listings to trade for (exclude user's own listings)\n  const availableListings = useMemo(() => {\n    return state.allListings.filter(listing => {\n      var _state$currentUser7;\n      return listing.isActive && listing.sellerId !== ((_state$currentUser7 = state.currentUser) === null || _state$currentUser7 === void 0 ? void 0 : _state$currentUser7.id) && (!searchTerm || listing.title.toLowerCase().includes(searchTerm.toLowerCase()));\n    });\n  }, [state.allListings, (_state$currentUser8 = state.currentUser) === null || _state$currentUser8 === void 0 ? void 0 : _state$currentUser8.id, searchTerm]);\n\n  // Calculate total offer value\n  const totalOfferValue = useMemo(() => {\n    const vehicleValue = selectedVehicles.reduce((sum, vId) => {\n      const vehicle = availableVehicles.find(v => v.id === vId);\n      return sum + ((vehicle === null || vehicle === void 0 ? void 0 : vehicle.customPrice) || (vehicle === null || vehicle === void 0 ? void 0 : vehicle.estimatedValue) || 0);\n    }, 0);\n    return vehicleValue + cashAmount;\n  }, [selectedVehicles, cashAmount, availableVehicles]);\n  const handleVehicleToggle = vehicleId => {\n    setSelectedVehicles(prev => prev.includes(vehicleId) ? prev.filter(id => id !== vehicleId) : [...prev, vehicleId]);\n  };\n  const handleSubmitTrade = async () => {\n    if (!targetListing) return;\n    setLoading(true);\n    setError(null); // Clear any previous errors\n    try {\n      if (existingTrade) {\n        var _state$currentUser9;\n        // Determine if current user is the original listing owner\n        const listingOwnerId = targetListing.sellerId;\n        const isOriginalReceiver = ((_state$currentUser9 = state.currentUser) === null || _state$currentUser9 === void 0 ? void 0 : _state$currentUser9.id) === listingOwnerId;\n        if (isOriginalReceiver) {\n          // Original receiver (listing owner) is countering - update existing trade\n          const updatedTrade = {\n            ...existingTrade,\n            status: 'countered',\n            receiverCashAmount: cashAmount,\n            receiverVehicleIds: selectedVehicles,\n            counterMessage: message,\n            updatedAt: new Date().toISOString(),\n            tradeHistory: [...existingTrade.tradeHistory, {\n              id: `history_${Date.now()}`,\n              action: 'countered',\n              userId: state.currentUser.id,\n              timestamp: new Date().toISOString(),\n              offererCashAmount: existingTrade.offererCashAmount,\n              offererVehicleIds: existingTrade.offererVehicleIds,\n              receiverCashAmount: cashAmount,\n              receiverVehicleIds: selectedVehicles,\n              message: `Counter offer: ${message || 'No message'}`\n            }]\n          };\n          await updateTrade(updatedTrade);\n          await reloadTrades();\n        } else {\n          var _existingTrade$offere3, _existingTrade$offere4, _existingTrade$receiv, _existingTrade$receiv2;\n          // Original offerer or subsequent counter - delete and create new trade\n          await deleteTrade(existingTrade.id);\n\n          // Determine the other party (whoever is not the current user)\n          const originalOffererId = typeof existingTrade.offererUserId === 'string' ? existingTrade.offererUserId : ((_existingTrade$offere3 = existingTrade.offererUserId) === null || _existingTrade$offere3 === void 0 ? void 0 : _existingTrade$offere3._id) || ((_existingTrade$offere4 = existingTrade.offererUserId) === null || _existingTrade$offere4 === void 0 ? void 0 : _existingTrade$offere4.id);\n          const originalReceiverId = typeof existingTrade.receiverUserId === 'string' ? existingTrade.receiverUserId : ((_existingTrade$receiv = existingTrade.receiverUserId) === null || _existingTrade$receiv === void 0 ? void 0 : _existingTrade$receiv._id) || ((_existingTrade$receiv2 = existingTrade.receiverUserId) === null || _existingTrade$receiv2 === void 0 ? void 0 : _existingTrade$receiv2.id);\n\n          // The other party is whoever is NOT the current user\n          const otherPartyId = originalOffererId === state.currentUser.id ? originalReceiverId : originalOffererId;\n\n          // Create new trade with current user as offerer and other party as receiver\n          const tradeData = {\n            listingId: targetListing.id,\n            offererUserId: state.currentUser.id,\n            receiverUserId: otherPartyId,\n            status: 'countered',\n            offererCashAmount: cashAmount,\n            offererVehicleIds: selectedVehicles,\n            message,\n            tradeHistory: [...existingTrade.tradeHistory, {\n              id: `history_${Date.now()}`,\n              action: 'countered',\n              userId: state.currentUser.id,\n              timestamp: new Date().toISOString(),\n              offererCashAmount: cashAmount,\n              offererVehicleIds: selectedVehicles,\n              message: `Counter offer: ${message || 'No message'}`\n            }]\n          };\n          console.log('🔄 Creating counter trade:', {\n            cashAmount,\n            selectedVehicles,\n            otherPartyId,\n            tradeData\n          });\n          await addTrade(tradeData);\n          await reloadTrades();\n        }\n      } else {\n        // This is a new trade offer\n        const tradeData = {\n          listingId: targetListing.id,\n          offererUserId: state.currentUser.id,\n          receiverUserId: targetListing.sellerId,\n          status: 'pending',\n          offererCashAmount: cashAmount,\n          offererVehicleIds: selectedVehicles,\n          message,\n          tradeHistory: [{\n            id: `history_${Date.now()}`,\n            action: 'created',\n            userId: state.currentUser.id,\n            timestamp: new Date().toISOString(),\n            offererCashAmount: cashAmount,\n            offererVehicleIds: selectedVehicles,\n            message\n          }]\n        };\n        await addTrade(tradeData);\n      }\n      onClose();\n    } catch (error) {\n      var _error$response, _error$response$data;\n      console.error('Error creating trade:', error);\n\n      // Handle specific error cases\n      if ((_error$response = error.response) !== null && _error$response !== void 0 && (_error$response$data = _error$response.data) !== null && _error$response$data !== void 0 && _error$response$data.message) {\n        const errorMessage = error.response.data.message;\n        if (errorMessage.includes('already have an active trade')) {\n          setError('You already have an active trade for this listing. Please cancel or complete your existing trade first.');\n        } else if (errorMessage.includes('not found or inactive')) {\n          setError('This listing is no longer available or has been sold.');\n        } else {\n          setError(errorMessage);\n        }\n      } else {\n        setError('Failed to create trade. Please try again.');\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n  const renderListingSelection = () => /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"space-y-6\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-2xl font-bold text-primary-100 mb-2\",\n        children: \"Select a Listing to Trade For\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 344,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-primary-300\",\n        children: \"Choose which vehicle you'd like to make a trade offer on\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 345,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 343,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"relative\",\n      children: [/*#__PURE__*/_jsxDEV(Search, {\n        className: \"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-primary-400\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 350,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        placeholder: \"Search listings...\",\n        value: searchTerm,\n        onChange: e => setSearchTerm(e.target.value),\n        className: \"input-field pl-10\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 351,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 349,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"max-h-96 overflow-y-auto space-y-3\",\n      children: availableListings.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center py-8\",\n        children: [/*#__PURE__*/_jsxDEV(Car, {\n          className: \"w-12 h-12 mx-auto mb-4 text-primary-400\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 364,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-primary-300\",\n          children: \"No available listings found\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 365,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 363,\n        columnNumber: 11\n      }, this) : availableListings.map(listing => {\n        var _vehicle$images;\n        const vehicle = listing.vehicle || state.vehicles.find(v => v.id === listing.vehicleId);\n        const seller = listing.seller || state.users.find(u => u.id === listing.sellerId);\n        return /*#__PURE__*/_jsxDEV(motion.div, {\n          whileHover: {\n            scale: 1.02\n          },\n          className: \"glass-effect rounded-xl p-4 cursor-pointer hover:bg-primary-800/20 transition-all\",\n          onClick: () => {\n            setTargetListing(listing);\n            setStep('build-offer');\n          },\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center space-x-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-16 h-16 bg-primary-800/30 rounded-lg flex items-center justify-center\",\n              children: vehicle !== null && vehicle !== void 0 && (_vehicle$images = vehicle.images) !== null && _vehicle$images !== void 0 && _vehicle$images[0] ? /*#__PURE__*/_jsxDEV(\"img\", {\n                src: vehicle.images[0],\n                alt: listing.title,\n                className: \"w-full h-full object-cover rounded-lg\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 385,\n                columnNumber: 23\n              }, this) : /*#__PURE__*/_jsxDEV(Car, {\n                className: \"w-8 h-8 text-primary-400\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 391,\n                columnNumber: 23\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 383,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex-1\",\n              children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                className: \"font-semibold text-primary-100\",\n                children: listing.title\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 395,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-sm text-primary-300\",\n                children: vehicle && `${vehicle.year} ${vehicle.make} ${vehicle.model}`\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 396,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center justify-between mt-1\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-green-400 font-bold\",\n                  children: [\"$\", listing.price.toLocaleString()]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 400,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-sm text-primary-400\",\n                  children: [\"by @\", (seller === null || seller === void 0 ? void 0 : seller.username) || 'Unknown']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 403,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 399,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 394,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(ArrowRight, {\n              className: \"w-5 h-5 text-primary-400\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 408,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 382,\n            columnNumber: 17\n          }, this)\n        }, listing.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 373,\n          columnNumber: 15\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 361,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 342,\n    columnNumber: 5\n  }, this);\n  const renderOfferBuilder = () => {\n    var _targetVehicle$images;\n    const targetVehicle = (targetListing === null || targetListing === void 0 ? void 0 : targetListing.vehicle) || state.vehicles.find(v => v.id === (targetListing === null || targetListing === void 0 ? void 0 : targetListing.vehicleId));\n    const targetSeller = (targetListing === null || targetListing === void 0 ? void 0 : targetListing.seller) || state.users.find(u => u.id === (targetListing === null || targetListing === void 0 ? void 0 : targetListing.sellerId));\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setStep('select-listing'),\n          className: \"text-blue-400 hover:text-blue-300 text-sm mb-4\",\n          children: \"\\u2190 Back to listing selection\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 425,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-2xl font-bold text-primary-100 mb-2\",\n          children: existingTrade ? 'Make Counter Offer' : 'Build Your Trade Offer'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 431,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-primary-300\",\n          children: existingTrade ? 'Modify their offer and send your counter proposal' : 'Select vehicles and cash to offer for this listing'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 434,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 424,\n        columnNumber: 9\n      }, this), targetListing && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"glass-effect rounded-xl p-4 border border-blue-500/30\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-16 h-16 bg-primary-800/30 rounded-lg flex items-center justify-center\",\n            children: targetVehicle !== null && targetVehicle !== void 0 && (_targetVehicle$images = targetVehicle.images) !== null && _targetVehicle$images !== void 0 && _targetVehicle$images[0] ? /*#__PURE__*/_jsxDEV(\"img\", {\n              src: targetVehicle.images[0],\n              alt: targetListing.title,\n              className: \"w-full h-full object-cover rounded-lg\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 448,\n              columnNumber: 19\n            }, this) : /*#__PURE__*/_jsxDEV(Car, {\n              className: \"w-8 h-8 text-primary-400\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 454,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 446,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex-1\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"font-semibold text-primary-100\",\n              children: targetListing.title\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 458,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm text-primary-300\",\n              children: targetVehicle && `${targetVehicle.year} ${targetVehicle.make} ${targetVehicle.model}`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 459,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center justify-between mt-1\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-green-400 font-bold\",\n                children: [\"$\", targetListing.price.toLocaleString()]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 463,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-sm text-primary-400\",\n                children: [\"by @\", (targetSeller === null || targetSeller === void 0 ? void 0 : targetSeller.username) || 'Unknown']\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 466,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 462,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 457,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 445,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 444,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-semibold text-primary-100 mb-4\",\n          children: existingTrade ? (_state$currentUser0 => {\n            const listingOwnerId = targetListing === null || targetListing === void 0 ? void 0 : targetListing.sellerId;\n            const isOriginalReceiver = ((_state$currentUser0 = state.currentUser) === null || _state$currentUser0 === void 0 ? void 0 : _state$currentUser0.id) === listingOwnerId;\n            if (isOriginalReceiver) {\n              return 'Select What You Want in Exchange';\n            } else {\n              return 'Your Vehicles (Counter Offer)';\n            }\n          })() : 'Your Vehicles'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 477,\n          columnNumber: 11\n        }, this), availableVehicles.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"glass-effect rounded-xl p-6 text-center\",\n          children: [/*#__PURE__*/_jsxDEV(Car, {\n            className: \"w-12 h-12 mx-auto mb-4 text-primary-400\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 493,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-primary-300\",\n            children: loadingOffererVehicles ? 'Loading available vehicles...' : 'No available vehicles to trade'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 494,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-sm text-primary-400 mt-1\",\n            children: loadingOffererVehicles ? 'Please wait while we fetch the available vehicles' : 'You can only trade vehicles that are not currently in auction'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 497,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 492,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-1 md:grid-cols-2 gap-4\",\n          children: availableVehicles.map(vehicle => {\n            var _vehicle$images2;\n            return /*#__PURE__*/_jsxDEV(motion.div, {\n              whileTap: {\n                scale: 0.98\n              },\n              className: `glass-effect rounded-xl p-4 cursor-pointer transition-all ${selectedVehicles.includes(vehicle.id) ? 'border-2 border-blue-500 bg-blue-500/10' : 'border border-primary-700/30 hover:border-primary-600/50'}`,\n              onClick: () => handleVehicleToggle(vehicle.id),\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center space-x-4\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"w-12 h-12 bg-primary-800/30 rounded-lg flex items-center justify-center relative\",\n                  children: [(_vehicle$images2 = vehicle.images) !== null && _vehicle$images2 !== void 0 && _vehicle$images2[0] ? /*#__PURE__*/_jsxDEV(\"img\", {\n                    src: vehicle.images[0],\n                    alt: `${vehicle.year} ${vehicle.make} ${vehicle.model}`,\n                    className: \"w-full h-full object-cover rounded-lg\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 520,\n                    columnNumber: 25\n                  }, this) : /*#__PURE__*/_jsxDEV(Car, {\n                    className: \"w-6 h-6 text-primary-400\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 526,\n                    columnNumber: 25\n                  }, this), selectedVehicles.includes(vehicle.id) && /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"absolute -top-2 -right-2 w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center\",\n                    children: /*#__PURE__*/_jsxDEV(Check, {\n                      className: \"w-4 h-4 text-white\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 530,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 529,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 518,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex-1\",\n                  children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                    className: \"font-medium text-primary-100\",\n                    children: [vehicle.year, \" \", vehicle.make, \" \", vehicle.model]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 535,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"text-sm text-primary-300\",\n                    children: [vehicle.mileage.toLocaleString(), \" mi\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 538,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"text-green-400 font-medium\",\n                    children: [\"$\", (vehicle.customPrice || vehicle.estimatedValue).toLocaleString()]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 541,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 534,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 517,\n                columnNumber: 19\n              }, this)\n            }, vehicle.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 507,\n              columnNumber: 17\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 505,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 476,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-semibold text-primary-100 mb-4\",\n          children: \"Cash Component\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 554,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"glass-effect rounded-xl p-4\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex space-x-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setCashAmount(Math.abs(cashAmount)),\n                className: `flex-1 p-3 rounded-lg border transition-all ${cashAmount >= 0 ? 'border-green-500 bg-green-500/20 text-green-300' : 'border-primary-600 bg-primary-800/30 text-primary-300'}`,\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center justify-center space-x-2\",\n                  children: [/*#__PURE__*/_jsxDEV(Plus, {\n                    className: \"w-4 h-4\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 568,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"font-medium\",\n                    children: existingTrade ?\n                    // For counter offers, determine labels based on original trade context\n                    ((_existingTrade$offere5, _existingTrade$offere6, _state$currentUser1) => {\n                      const originalOffererId = typeof existingTrade.offererUserId === 'string' ? existingTrade.offererUserId : ((_existingTrade$offere5 = existingTrade.offererUserId) === null || _existingTrade$offere5 === void 0 ? void 0 : _existingTrade$offere5._id) || ((_existingTrade$offere6 = existingTrade.offererUserId) === null || _existingTrade$offere6 === void 0 ? void 0 : _existingTrade$offere6.id);\n                      const isOriginalReceiver = originalOffererId !== ((_state$currentUser1 = state.currentUser) === null || _state$currentUser1 === void 0 ? void 0 : _state$currentUser1.id);\n                      if (isOriginalReceiver) {\n                        // Original receiver countering: if original offerer added cash, say \"They add cash\"\n                        return existingTrade.offererCashAmount >= 0 ? 'They add cash' : 'I\\'ll add cash';\n                      } else {\n                        // Original offerer counter-countering: use their perspective\n                        return 'I\\'ll add cash';\n                      }\n                    })() : 'I\\'ll add cash'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 569,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 567,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 559,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setCashAmount(-Math.abs(cashAmount || 1000)),\n                className: `flex-1 p-3 rounded-lg border transition-all ${cashAmount < 0 ? 'border-blue-500 bg-blue-500/20 text-blue-300' : 'border-primary-600 bg-primary-800/30 text-primary-300'}`,\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center justify-center space-x-2\",\n                  children: [/*#__PURE__*/_jsxDEV(Minus, {\n                    className: \"w-4 h-4\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 599,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"font-medium\",\n                    children: existingTrade ?\n                    // For counter offers, determine labels based on original trade context\n                    ((_existingTrade$offere7, _existingTrade$offere8, _state$currentUser10) => {\n                      const originalOffererId = typeof existingTrade.offererUserId === 'string' ? existingTrade.offererUserId : ((_existingTrade$offere7 = existingTrade.offererUserId) === null || _existingTrade$offere7 === void 0 ? void 0 : _existingTrade$offere7._id) || ((_existingTrade$offere8 = existingTrade.offererUserId) === null || _existingTrade$offere8 === void 0 ? void 0 : _existingTrade$offere8.id);\n                      const isOriginalReceiver = originalOffererId !== ((_state$currentUser10 = state.currentUser) === null || _state$currentUser10 === void 0 ? void 0 : _state$currentUser10.id);\n                      if (isOriginalReceiver) {\n                        // Original receiver countering: if original offerer added cash, say \"I'll add cash\"  \n                        return existingTrade.offererCashAmount >= 0 ? 'I\\'ll add cash' : 'They add cash';\n                      } else {\n                        // Original offerer counter-countering: use their perspective\n                        return 'They add cash';\n                      }\n                    })() : 'They add cash'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 600,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 598,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 590,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 558,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center space-x-4\",\n              children: [/*#__PURE__*/_jsxDEV(DollarSign, {\n                className: `w-6 h-6 ${cashAmount >= 0 ? 'text-green-400' : 'text-blue-400'}`\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 625,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex-1\",\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"number\",\n                  value: Math.abs(cashAmount) === 0 ? '' : Math.abs(cashAmount),\n                  onChange: e => {\n                    const value = Number(e.target.value) || 0;\n                    setCashAmount(cashAmount < 0 ? -value : value);\n                  },\n                  placeholder: \"0\",\n                  className: \"input-field text-lg font-bold\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 627,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-sm text-primary-400 mt-1\",\n                  children: cashAmount > 0 ? (() => {\n                    if (existingTrade) {\n                      var _existingTrade$offere9, _existingTrade$offere0, _state$currentUser11;\n                      const originalOffererId = typeof existingTrade.offererUserId === 'string' ? existingTrade.offererUserId : ((_existingTrade$offere9 = existingTrade.offererUserId) === null || _existingTrade$offere9 === void 0 ? void 0 : _existingTrade$offere9._id) || ((_existingTrade$offere0 = existingTrade.offererUserId) === null || _existingTrade$offere0 === void 0 ? void 0 : _existingTrade$offere0.id);\n                      const isOriginalReceiver = originalOffererId !== ((_state$currentUser11 = state.currentUser) === null || _state$currentUser11 === void 0 ? void 0 : _state$currentUser11.id);\n                      if (isOriginalReceiver) {\n                        // Original receiver countering\n                        if (existingTrade.offererCashAmount >= 0) {\n                          return `They're offering $${cashAmount.toLocaleString()} in addition to vehicles`;\n                        } else {\n                          return `You're offering $${cashAmount.toLocaleString()} in addition to vehicles`;\n                        }\n                      } else {\n                        // Original offerer counter-countering\n                        return `You're offering $${cashAmount.toLocaleString()} in addition to vehicles`;\n                      }\n                    } else {\n                      return `You're offering $${cashAmount.toLocaleString()} in addition to vehicles`;\n                    }\n                  })() : cashAmount < 0 ? (() => {\n                    if (existingTrade) {\n                      var _existingTrade$offere1, _existingTrade$offere10, _state$currentUser12;\n                      const originalOffererId = typeof existingTrade.offererUserId === 'string' ? existingTrade.offererUserId : ((_existingTrade$offere1 = existingTrade.offererUserId) === null || _existingTrade$offere1 === void 0 ? void 0 : _existingTrade$offere1._id) || ((_existingTrade$offere10 = existingTrade.offererUserId) === null || _existingTrade$offere10 === void 0 ? void 0 : _existingTrade$offere10.id);\n                      const isOriginalReceiver = originalOffererId !== ((_state$currentUser12 = state.currentUser) === null || _state$currentUser12 === void 0 ? void 0 : _state$currentUser12.id);\n                      if (isOriginalReceiver) {\n                        // Original receiver countering\n                        if (existingTrade.offererCashAmount >= 0) {\n                          return `You're requesting $${Math.abs(cashAmount).toLocaleString()} from them`;\n                        } else {\n                          return `They're offering $${Math.abs(cashAmount).toLocaleString()} to you`;\n                        }\n                      } else {\n                        // Original offerer counter-countering\n                        return `You're requesting $${Math.abs(cashAmount).toLocaleString()} from them`;\n                      }\n                    } else {\n                      return `You're requesting $${Math.abs(cashAmount).toLocaleString()} from the other party`;\n                    }\n                  })() : \"No cash involved in this trade\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 637,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 626,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 624,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 556,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 555,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 553,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-semibold text-primary-100 mb-4\",\n          children: \"Message (Optional)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 695,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          value: message,\n          onChange: e => setMessage(e.target.value),\n          placeholder: \"Add a personal message to your trade offer...\",\n          className: \"input-field h-24 resize-none\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 696,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 694,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"glass-effect rounded-xl p-4 border border-green-500/30\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-semibold text-primary-100 mb-4\",\n          children: \"Trade Summary\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 706,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-primary-300\",\n              children: [\"Vehicles (\", selectedVehicles.length, \"):\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 709,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-primary-100 font-medium\",\n              children: [\"$\", selectedVehicles.reduce((sum, vId) => {\n                const vehicle = availableVehicles.find(v => v.id === vId);\n                return sum + ((vehicle === null || vehicle === void 0 ? void 0 : vehicle.customPrice) || (vehicle === null || vehicle === void 0 ? void 0 : vehicle.estimatedValue) || 0);\n              }, 0).toLocaleString()]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 710,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 708,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-primary-300\",\n              children: \"Cash:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 718,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: `font-medium ${cashAmount >= 0 ? 'text-green-400' : 'text-red-400'}`,\n              children: [cashAmount >= 0 ? '+' : '', \"$\", cashAmount.toLocaleString()]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 719,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 717,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"border-t border-primary-700/30 pt-2\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex justify-between\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-primary-100 font-semibold\",\n                children: \"Total Offer Value:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 725,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-green-400 font-bold text-lg\",\n                children: [\"$\", totalOfferValue.toLocaleString()]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 726,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 724,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 723,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 707,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 705,\n        columnNumber: 9\n      }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"glass-effect rounded-xl p-4 border border-red-500/30 bg-red-500/10\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-2\",\n          children: [/*#__PURE__*/_jsxDEV(AlertCircle, {\n            className: \"w-5 h-5 text-red-400 flex-shrink-0\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 738,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-red-300\",\n            children: error\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 739,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 737,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 736,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex space-x-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: onClose,\n          className: \"btn-secondary flex-1\",\n          children: \"Cancel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 745,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleSubmitTrade,\n          disabled: loading || selectedVehicles.length === 0 && cashAmount === 0,\n          className: \"btn-primary flex-1\",\n          children: loading ? 'Sending...' : existingTrade ? 'Send Counter Offer' : 'Send Trade Offer'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 751,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 744,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 423,\n      columnNumber: 7\n    }, this);\n  };\n  return /*#__PURE__*/_jsxDEV(motion.div, {\n    initial: {\n      opacity: 0\n    },\n    animate: {\n      opacity: 1\n    },\n    exit: {\n      opacity: 0\n    },\n    className: \"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50\",\n    onClick: e => e.target === e.currentTarget && onClose(),\n    children: /*#__PURE__*/_jsxDEV(motion.div, {\n      initial: {\n        scale: 0.9,\n        opacity: 0\n      },\n      animate: {\n        scale: 1,\n        opacity: 1\n      },\n      exit: {\n        scale: 0.9,\n        opacity: 0\n      },\n      className: \"glass-effect rounded-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center justify-between p-6 border-b border-primary-700/30\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-2xl font-bold text-primary-100\",\n          children: existingTrade ? 'Counter Trade Offer' : step === 'select-listing' ? 'Make Trade Offer' : 'Build Your Offer'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 779,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: onClose,\n          className: \"p-2 hover:bg-primary-800/50 rounded-full transition-colors\",\n          children: /*#__PURE__*/_jsxDEV(X, {\n            className: \"w-6 h-6 text-primary-300\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 787,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 783,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 778,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-6\",\n        children: step === 'select-listing' ? renderListingSelection() : renderOfferBuilder()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 792,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 771,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 764,\n    columnNumber: 5\n  }, this);\n}\n_s(TradeOfferModal, \"y46WkPlVkKPFYc5PvXjUKA/ryXA=\", false, function () {\n  return [useApp];\n});\n_c = TradeOfferModal;\nvar _c;\n$RefreshReg$(_c, \"TradeOfferModal\");","map":{"version":3,"names":["React","useState","useMemo","useEffect","motion","X","Car","DollarSign","Plus","Minus","Search","Check","ArrowRight","AlertCircle","useApp","jsxDEV","_jsxDEV","TradeOfferModal","onClose","selectedListing","existingTrade","_s","_state$currentUser2","_state$currentUser6","_state$currentUser8","state","addTrade","updateTrade","reloadTrades","deleteTrade","getUserVehicles","step","setStep","searchTerm","setSearchTerm","targetListing","setTargetListing","selectedVehicles","setSelectedVehicles","cashAmount","setCashAmount","status","receiverCashAmount","undefined","offererCashAmount","message","setMessage","loading","setLoading","error","setError","cashDirection","setCashDirection","offererVehicles","setOffererVehicles","loadingOffererVehicles","setLoadingOffererVehicles","listing","allListings","find","l","id","listingId","currentUser","listingOwnerId","sellerId","isOriginalReceiver","console","log","currentUserId","existingTradeStatus","existingOffererCash","existingReceiverCash","existingOffererVehicles","offererVehicleIds","existingReceiverVehicles","receiverVehicleIds","initialCashAmount","fetchOffererVehicles","_state$currentUser","_existingTrade$offere","_existingTrade$offere2","offererId","offererUserId","_id","vehicles","availableVehicles","_state$currentUser3","originalTradeEntry","tradeHistory","entry","action","originalOffererId","userId","filter","vehicle","isAuctioned","_state$currentUser4","ownerId","_state$currentUser5","availableListings","_state$currentUser7","isActive","title","toLowerCase","includes","totalOfferValue","vehicleValue","reduce","sum","vId","v","customPrice","estimatedValue","handleVehicleToggle","vehicleId","prev","handleSubmitTrade","_state$currentUser9","updatedTrade","counterMessage","updatedAt","Date","toISOString","now","timestamp","_existingTrade$offere3","_existingTrade$offere4","_existingTrade$receiv","_existingTrade$receiv2","originalReceiverId","receiverUserId","otherPartyId","tradeData","_error$response","_error$response$data","response","data","errorMessage","renderListingSelection","className","children","fileName","_jsxFileName","lineNumber","columnNumber","type","placeholder","value","onChange","e","target","length","map","_vehicle$images","seller","users","u","div","whileHover","scale","onClick","images","src","alt","year","make","model","price","toLocaleString","username","renderOfferBuilder","_targetVehicle$images","targetVehicle","targetSeller","_state$currentUser0","_vehicle$images2","whileTap","mileage","Math","abs","_existingTrade$offere5","_existingTrade$offere6","_state$currentUser1","_existingTrade$offere7","_existingTrade$offere8","_state$currentUser10","Number","_existingTrade$offere9","_existingTrade$offere0","_state$currentUser11","_existingTrade$offere1","_existingTrade$offere10","_state$currentUser12","disabled","initial","opacity","animate","exit","currentTarget","_c","$RefreshReg$"],"sources":["C:/Users/thato/Downloads/car-app/src/components/trades/TradeOfferModal.tsx"],"sourcesContent":["import React, { useState, useMemo, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { \n  X, \n  Car, \n  DollarSign, \n  Plus, \n  Minus, \n  Search, \n  Check,\n  MessageCircle,\n  ArrowRight,\n  AlertCircle\n} from 'lucide-react';\nimport { useApp } from '../../context/AppContext.tsx';\nimport { Listing, Vehicle, Trade } from '../../types/index.ts';\n\ninterface TradeOfferModalProps {\n  onClose: () => void;\n  selectedListing?: Listing | null;\n  existingTrade?: Trade | null; // For counter-offers\n}\n\nexport function TradeOfferModal({ onClose, selectedListing, existingTrade }: TradeOfferModalProps) {\n  const { state, addTrade, updateTrade, reloadTrades, deleteTrade, getUserVehicles } = useApp();\n  const [step, setStep] = useState<'select-listing' | 'build-offer'>(\n    selectedListing || existingTrade ? 'build-offer' : 'select-listing'\n  );\n  const [searchTerm, setSearchTerm] = useState('');\n  const [targetListing, setTargetListing] = useState<Listing | null>(selectedListing || null);\n  const [selectedVehicles, setSelectedVehicles] = useState<string[]>(() => {\n    if (existingTrade) {\n      // We need to wait for targetListing to be set, so start with empty array\n      // The initialization will be handled in a useEffect after targetListing is available\n      return [];\n    }\n    return [];\n  });\n  const [cashAmount, setCashAmount] = useState(() => {\n    if (existingTrade) {\n      // Start with the most recent offer amount as reference\n      // We'll refine this in a useEffect once targetListing is available\n      if (existingTrade.status === 'countered' && existingTrade.receiverCashAmount !== undefined) {\n        return existingTrade.receiverCashAmount;\n      } else {\n        return existingTrade.offererCashAmount;\n      }\n    }\n    return 0;\n  });\n  const [message, setMessage] = useState(existingTrade?.message || '');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [cashDirection, setCashDirection] = useState<'add' | 'request'>(\n    existingTrade ? \n      (existingTrade.offererCashAmount >= 0 ? 'add' : 'request') : \n      'add'\n  );\n\n  const [offererVehicles, setOffererVehicles] = useState<Vehicle[]>([]);\n  const [loadingOffererVehicles, setLoadingOffererVehicles] = useState(false);\n\n  // Initialize target listing from existing trade\n  useEffect(() => {\n    if (existingTrade && !targetListing) {\n      // Find the listing from the existing trade\n      const listing = state.allListings.find(l => l.id === existingTrade.listingId);\n      if (listing) {\n        setTargetListing(listing);\n      }\n    }\n  }, [existingTrade, targetListing, state.allListings]);\n\n  // Initialize selected vehicles and cash amount once targetListing is available\n  useEffect(() => {\n    if (existingTrade && targetListing && state.currentUser) {\n      const listingOwnerId = targetListing.sellerId;\n      const isOriginalReceiver = state.currentUser.id === listingOwnerId;\n      \n      console.log('🔧 Initializing trade modal:', {\n        listingOwnerId,\n        currentUserId: state.currentUser.id,\n        isOriginalReceiver,\n        existingTradeStatus: existingTrade.status,\n        existingOffererCash: existingTrade.offererCashAmount,\n        existingReceiverCash: existingTrade.receiverCashAmount,\n        existingOffererVehicles: existingTrade.offererVehicleIds,\n        existingReceiverVehicles: existingTrade.receiverVehicleIds\n      });\n      \n      // Initialize selected vehicles based on role\n      if (isOriginalReceiver) {\n        // Original receiver countering - pre-select the offerer's vehicles as reference\n        setSelectedVehicles(existingTrade.offererVehicleIds);\n        console.log('🎯 Original receiver - pre-selecting offerer vehicles:', existingTrade.offererVehicleIds);\n      } else {\n        // Original offerer or subsequent counter - start with empty selection\n        setSelectedVehicles([]);\n        console.log('🎯 Original offerer/subsequent counter - starting with empty vehicles');\n      }\n      \n      // Initialize cash amount based on role and trade status\n      let initialCashAmount = 0;\n      if (isOriginalReceiver) {\n        // Original receiver countering - start with the most recent offer amount as reference\n        if (existingTrade.status === 'countered' && existingTrade.receiverCashAmount !== undefined) {\n          initialCashAmount = existingTrade.receiverCashAmount;\n        } else {\n          initialCashAmount = existingTrade.offererCashAmount;\n        }\n      } else {\n        // Original offerer or subsequent counter - use most recent offer as reference\n        if (existingTrade.status === 'countered' && existingTrade.receiverCashAmount !== undefined) {\n          initialCashAmount = existingTrade.receiverCashAmount;\n        } else {\n          initialCashAmount = existingTrade.offererCashAmount;\n        }\n      }\n      \n      console.log('💰 Setting initial cash amount:', initialCashAmount);\n      setCashAmount(initialCashAmount);\n    }\n  }, [existingTrade, targetListing, state.currentUser]);\n\n  // Fetch offerer's vehicles when original receiver is countering\n  useEffect(() => {\n    const fetchOffererVehicles = async () => {\n      if (existingTrade && targetListing) {\n        const listingOwnerId = targetListing.sellerId;\n        const isOriginalReceiver = state.currentUser?.id === listingOwnerId;\n        \n        if (isOriginalReceiver) {\n          // Get the offerer's user ID\n          const offererId = typeof existingTrade.offererUserId === 'string' \n            ? existingTrade.offererUserId \n            : (existingTrade.offererUserId as any)?._id || (existingTrade.offererUserId as any)?.id;\n          \n          if (offererId) {\n            setLoadingOffererVehicles(true);\n            try {\n              const vehicles = await getUserVehicles(offererId);\n              setOffererVehicles(vehicles);\n            } catch (error) {\n              console.error('Error fetching offerer vehicles:', error);\n            } finally {\n              setLoadingOffererVehicles(false);\n            }\n          }\n        }\n      }\n    };\n\n    fetchOffererVehicles();\n  }, [existingTrade, targetListing, state.currentUser?.id, getUserVehicles]);\n\n  // Available vehicles (user's own vehicles that are NOT auctioned)\n  const availableVehicles = useMemo(() => {\n    if (existingTrade) {\n      // Determine the original listing owner (receiver) vs original offerer\n      // We need to check the trade history to find the original roles\n      const originalTradeEntry = existingTrade.tradeHistory.find(entry => entry.action === 'created');\n      const originalOffererId = originalTradeEntry?.userId;\n      \n      // If we can't find the original trade entry, fall back to checking listing ownership\n      const listingOwnerId = targetListing?.sellerId;\n      const isOriginalReceiver = state.currentUser?.id === listingOwnerId;\n      \n      if (isOriginalReceiver) {\n        // Original receiver (listing owner) - show ALL offerer's vehicles to choose what they want\n        return loadingOffererVehicles ? [] : offererVehicles.filter((vehicle: Vehicle) => !vehicle.isAuctioned);\n      } else {\n        // Original offerer or subsequent counter - show your own vehicles\n        return state.vehicles.filter(vehicle => \n          !vehicle.isAuctioned && vehicle.ownerId === state.currentUser?.id\n        );\n      }\n    } else {\n      // For new trades, show user's own vehicles\n      return state.vehicles.filter(vehicle => \n        !vehicle.isAuctioned && vehicle.ownerId === state.currentUser?.id\n      );\n    }\n  }, [state.vehicles, state.currentUser?.id, existingTrade, targetListing, offererVehicles, loadingOffererVehicles]);\n\n  // Available listings to trade for (exclude user's own listings)\n  const availableListings = useMemo(() => {\n    return state.allListings.filter(listing => \n      listing.isActive && listing.sellerId !== state.currentUser?.id &&\n      (!searchTerm || listing.title.toLowerCase().includes(searchTerm.toLowerCase()))\n    );\n  }, [state.allListings, state.currentUser?.id, searchTerm]);\n\n  // Calculate total offer value\n  const totalOfferValue = useMemo(() => {\n    const vehicleValue = selectedVehicles.reduce((sum, vId) => {\n      const vehicle = availableVehicles.find(v => v.id === vId);\n      return sum + (vehicle?.customPrice || vehicle?.estimatedValue || 0);\n    }, 0);\n    return vehicleValue + cashAmount;\n  }, [selectedVehicles, cashAmount, availableVehicles]);\n\n  const handleVehicleToggle = (vehicleId: string) => {\n    setSelectedVehicles(prev => \n      prev.includes(vehicleId) \n        ? prev.filter(id => id !== vehicleId)\n        : [...prev, vehicleId]\n    );\n  };\n\n  const handleSubmitTrade = async () => {\n    if (!targetListing) return;\n\n    setLoading(true);\n    setError(null); // Clear any previous errors\n    try {\n      if (existingTrade) {\n        // Determine if current user is the original listing owner\n        const listingOwnerId = targetListing.sellerId;\n        const isOriginalReceiver = state.currentUser?.id === listingOwnerId;\n        \n        if (isOriginalReceiver) {\n          // Original receiver (listing owner) is countering - update existing trade\n          const updatedTrade = {\n            ...existingTrade,\n            status: 'countered' as const,\n            receiverCashAmount: cashAmount,\n            receiverVehicleIds: selectedVehicles,\n            counterMessage: message,\n            updatedAt: new Date().toISOString(),\n            tradeHistory: [\n              ...existingTrade.tradeHistory,\n              {\n                id: `history_${Date.now()}`,\n                action: 'countered' as const,\n                userId: state.currentUser!.id,\n                timestamp: new Date().toISOString(),\n                offererCashAmount: existingTrade.offererCashAmount,\n                offererVehicleIds: existingTrade.offererVehicleIds,\n                receiverCashAmount: cashAmount,\n                receiverVehicleIds: selectedVehicles,\n                message: `Counter offer: ${message || 'No message'}`\n              }\n            ]\n          };\n          await updateTrade(updatedTrade);\n          await reloadTrades();\n        } else {\n          // Original offerer or subsequent counter - delete and create new trade\n          await deleteTrade(existingTrade.id);\n\n          // Determine the other party (whoever is not the current user)\n          const originalOffererId = typeof existingTrade.offererUserId === 'string' \n            ? existingTrade.offererUserId \n            : (existingTrade.offererUserId as any)?._id || (existingTrade.offererUserId as any)?.id;\n          \n          const originalReceiverId = typeof existingTrade.receiverUserId === 'string' \n            ? existingTrade.receiverUserId \n            : (existingTrade.receiverUserId as any)?._id || (existingTrade.receiverUserId as any)?.id;\n          \n          // The other party is whoever is NOT the current user\n          const otherPartyId = originalOffererId === state.currentUser!.id ? originalReceiverId : originalOffererId;\n\n          // Create new trade with current user as offerer and other party as receiver\n          const tradeData = {\n            listingId: targetListing.id,\n            offererUserId: state.currentUser!.id,\n            receiverUserId: otherPartyId,\n            status: 'countered' as const,\n            offererCashAmount: cashAmount,\n            offererVehicleIds: selectedVehicles,\n            message,\n            tradeHistory: [\n              ...existingTrade.tradeHistory,\n              {\n                id: `history_${Date.now()}`,\n                action: 'countered' as const,\n                userId: state.currentUser!.id,\n                timestamp: new Date().toISOString(),\n                offererCashAmount: cashAmount,\n                offererVehicleIds: selectedVehicles,\n                message: `Counter offer: ${message || 'No message'}`\n              }\n            ]\n          };\n          \n          console.log('🔄 Creating counter trade:', {\n            cashAmount,\n            selectedVehicles,\n            otherPartyId,\n            tradeData\n          });\n          \n          await addTrade(tradeData);\n          await reloadTrades();\n        }\n      } else {\n        // This is a new trade offer\n        const tradeData = {\n          listingId: targetListing.id,\n          offererUserId: state.currentUser!.id,\n          receiverUserId: targetListing.sellerId,\n          status: 'pending' as const,\n          offererCashAmount: cashAmount,\n          offererVehicleIds: selectedVehicles,\n          message,\n          tradeHistory: [{\n            id: `history_${Date.now()}`,\n            action: 'created' as const,\n            userId: state.currentUser!.id,\n            timestamp: new Date().toISOString(),\n            offererCashAmount: cashAmount,\n            offererVehicleIds: selectedVehicles,\n            message\n          }]\n        };\n        await addTrade(tradeData);\n      }\n      \n      onClose();\n    } catch (error: any) {\n      console.error('Error creating trade:', error);\n      \n      // Handle specific error cases\n      if (error.response?.data?.message) {\n        const errorMessage = error.response.data.message;\n        if (errorMessage.includes('already have an active trade')) {\n          setError('You already have an active trade for this listing. Please cancel or complete your existing trade first.');\n        } else if (errorMessage.includes('not found or inactive')) {\n          setError('This listing is no longer available or has been sold.');\n        } else {\n          setError(errorMessage);\n        }\n      } else {\n        setError('Failed to create trade. Please try again.');\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const renderListingSelection = () => (\n    <div className=\"space-y-6\">\n      <div>\n        <h2 className=\"text-2xl font-bold text-primary-100 mb-2\">Select a Listing to Trade For</h2>\n        <p className=\"text-primary-300\">Choose which vehicle you'd like to make a trade offer on</p>\n      </div>\n\n      {/* Search */}\n      <div className=\"relative\">\n        <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-primary-400\" />\n        <input\n          type=\"text\"\n          placeholder=\"Search listings...\"\n          value={searchTerm}\n          onChange={(e) => setSearchTerm(e.target.value)}\n          className=\"input-field pl-10\"\n        />\n      </div>\n\n      {/* Listings Grid */}\n      <div className=\"max-h-96 overflow-y-auto space-y-3\">\n        {availableListings.length === 0 ? (\n          <div className=\"text-center py-8\">\n            <Car className=\"w-12 h-12 mx-auto mb-4 text-primary-400\" />\n            <p className=\"text-primary-300\">No available listings found</p>\n          </div>\n        ) : (\n          availableListings.map((listing) => {\n            const vehicle = (listing as any).vehicle || state.vehicles.find(v => v.id === listing.vehicleId);\n            const seller = (listing as any).seller || state.users.find(u => u.id === listing.sellerId);\n            \n            return (\n              <motion.div\n                key={listing.id}\n                whileHover={{ scale: 1.02 }}\n                className=\"glass-effect rounded-xl p-4 cursor-pointer hover:bg-primary-800/20 transition-all\"\n                onClick={() => {\n                  setTargetListing(listing);\n                  setStep('build-offer');\n                }}\n              >\n                <div className=\"flex items-center space-x-4\">\n                  <div className=\"w-16 h-16 bg-primary-800/30 rounded-lg flex items-center justify-center\">\n                    {vehicle?.images?.[0] ? (\n                      <img\n                        src={vehicle.images[0]}\n                        alt={listing.title}\n                        className=\"w-full h-full object-cover rounded-lg\"\n                      />\n                    ) : (\n                      <Car className=\"w-8 h-8 text-primary-400\" />\n                    )}\n                  </div>\n                  <div className=\"flex-1\">\n                    <h3 className=\"font-semibold text-primary-100\">{listing.title}</h3>\n                    <p className=\"text-sm text-primary-300\">\n                      {vehicle && `${vehicle.year} ${vehicle.make} ${vehicle.model}`}\n                    </p>\n                    <div className=\"flex items-center justify-between mt-1\">\n                      <span className=\"text-green-400 font-bold\">\n                        ${listing.price.toLocaleString()}\n                      </span>\n                      <span className=\"text-sm text-primary-400\">\n                        by @{seller?.username || 'Unknown'}\n                      </span>\n                    </div>\n                  </div>\n                  <ArrowRight className=\"w-5 h-5 text-primary-400\" />\n                </div>\n              </motion.div>\n            );\n          })\n        )}\n      </div>\n    </div>\n  );\n\n  const renderOfferBuilder = () => {\n    const targetVehicle = (targetListing as any)?.vehicle || state.vehicles.find(v => v.id === targetListing?.vehicleId);\n    const targetSeller = (targetListing as any)?.seller || state.users.find(u => u.id === targetListing?.sellerId);\n\n    return (\n      <div className=\"space-y-6\">\n        <div>\n          <button\n            onClick={() => setStep('select-listing')}\n            className=\"text-blue-400 hover:text-blue-300 text-sm mb-4\"\n          >\n            ← Back to listing selection\n          </button>\n          <h2 className=\"text-2xl font-bold text-primary-100 mb-2\">\n            {existingTrade ? 'Make Counter Offer' : 'Build Your Trade Offer'}\n          </h2>\n          <p className=\"text-primary-300\">\n            {existingTrade \n              ? 'Modify their offer and send your counter proposal'\n              : 'Select vehicles and cash to offer for this listing'\n            }\n          </p>\n        </div>\n\n        {/* Target Listing Summary */}\n        {targetListing && (\n          <div className=\"glass-effect rounded-xl p-4 border border-blue-500/30\">\n            <div className=\"flex items-center space-x-4\">\n              <div className=\"w-16 h-16 bg-primary-800/30 rounded-lg flex items-center justify-center\">\n                {targetVehicle?.images?.[0] ? (\n                  <img\n                    src={targetVehicle.images[0]}\n                    alt={targetListing.title}\n                    className=\"w-full h-full object-cover rounded-lg\"\n                  />\n                ) : (\n                  <Car className=\"w-8 h-8 text-primary-400\" />\n                )}\n              </div>\n              <div className=\"flex-1\">\n                <h3 className=\"font-semibold text-primary-100\">{targetListing.title}</h3>\n                <p className=\"text-sm text-primary-300\">\n                  {targetVehicle && `${targetVehicle.year} ${targetVehicle.make} ${targetVehicle.model}`}\n                </p>\n                <div className=\"flex items-center justify-between mt-1\">\n                  <span className=\"text-green-400 font-bold\">\n                    ${targetListing.price.toLocaleString()}\n                  </span>\n                  <span className=\"text-sm text-primary-400\">\n                    by @{targetSeller?.username || 'Unknown'}\n                  </span>\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Your Vehicles */}\n        <div>\n          <h3 className=\"text-lg font-semibold text-primary-100 mb-4\">\n            {existingTrade ? (\n              (() => {\n                const listingOwnerId = targetListing?.sellerId;\n                const isOriginalReceiver = state.currentUser?.id === listingOwnerId;\n                \n                if (isOriginalReceiver) {\n                  return 'Select What You Want in Exchange';\n                } else {\n                  return 'Your Vehicles (Counter Offer)';\n                }\n              })()\n            ) : 'Your Vehicles'}\n          </h3>\n          {availableVehicles.length === 0 ? (\n            <div className=\"glass-effect rounded-xl p-6 text-center\">\n              <Car className=\"w-12 h-12 mx-auto mb-4 text-primary-400\" />\n              <p className=\"text-primary-300\">\n                {loadingOffererVehicles ? 'Loading available vehicles...' : 'No available vehicles to trade'}\n              </p>\n              <p className=\"text-sm text-primary-400 mt-1\">\n                {loadingOffererVehicles \n                  ? 'Please wait while we fetch the available vehicles'\n                  : 'You can only trade vehicles that are not currently in auction'\n                }\n              </p>\n            </div>\n          ) : (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              {availableVehicles.map((vehicle) => (\n                <motion.div\n                  key={vehicle.id}\n                  whileTap={{ scale: 0.98 }}\n                  className={`glass-effect rounded-xl p-4 cursor-pointer transition-all ${\n                    selectedVehicles.includes(vehicle.id)\n                      ? 'border-2 border-blue-500 bg-blue-500/10'\n                      : 'border border-primary-700/30 hover:border-primary-600/50'\n                  }`}\n                  onClick={() => handleVehicleToggle(vehicle.id)}\n                >\n                  <div className=\"flex items-center space-x-4\">\n                    <div className=\"w-12 h-12 bg-primary-800/30 rounded-lg flex items-center justify-center relative\">\n                      {vehicle.images?.[0] ? (\n                        <img\n                          src={vehicle.images[0]}\n                          alt={`${vehicle.year} ${vehicle.make} ${vehicle.model}`}\n                          className=\"w-full h-full object-cover rounded-lg\"\n                        />\n                      ) : (\n                        <Car className=\"w-6 h-6 text-primary-400\" />\n                      )}\n                      {selectedVehicles.includes(vehicle.id) && (\n                        <div className=\"absolute -top-2 -right-2 w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center\">\n                          <Check className=\"w-4 h-4 text-white\" />\n                        </div>\n                      )}\n                    </div>\n                    <div className=\"flex-1\">\n                      <h4 className=\"font-medium text-primary-100\">\n                        {vehicle.year} {vehicle.make} {vehicle.model}\n                      </h4>\n                      <p className=\"text-sm text-primary-300\">\n                        {vehicle.mileage.toLocaleString()} mi\n                      </p>\n                      <p className=\"text-green-400 font-medium\">\n                        ${(vehicle.customPrice || vehicle.estimatedValue).toLocaleString()}\n                      </p>\n                    </div>\n                  </div>\n                </motion.div>\n              ))}\n            </div>\n          )}\n        </div>\n\n        {/* Cash Amount */}\n        <div>\n          <h3 className=\"text-lg font-semibold text-primary-100 mb-4\">Cash Component</h3>\n          <div className=\"glass-effect rounded-xl p-4\">\n            <div className=\"space-y-4\">\n              {/* Cash Direction Selector */}\n              <div className=\"flex space-x-4\">\n                <button\n                  onClick={() => setCashAmount(Math.abs(cashAmount))}\n                  className={`flex-1 p-3 rounded-lg border transition-all ${\n                    cashAmount >= 0\n                      ? 'border-green-500 bg-green-500/20 text-green-300'\n                      : 'border-primary-600 bg-primary-800/30 text-primary-300'\n                  }`}\n                >\n                  <div className=\"flex items-center justify-center space-x-2\">\n                    <Plus className=\"w-4 h-4\" />\n                    <span className=\"font-medium\">\n                      {existingTrade ? (\n                        // For counter offers, determine labels based on original trade context\n                        (() => {\n                          const originalOffererId = typeof existingTrade.offererUserId === 'string' \n                            ? existingTrade.offererUserId \n                            : (existingTrade.offererUserId as any)?._id || (existingTrade.offererUserId as any)?.id;\n                          const isOriginalReceiver = originalOffererId !== state.currentUser?.id;\n                          \n                          if (isOriginalReceiver) {\n                            // Original receiver countering: if original offerer added cash, say \"They add cash\"\n                            return existingTrade.offererCashAmount >= 0 ? 'They add cash' : 'I\\'ll add cash';\n                          } else {\n                            // Original offerer counter-countering: use their perspective\n                            return 'I\\'ll add cash';\n                          }\n                        })()\n                      ) : 'I\\'ll add cash'}\n                    </span>\n                  </div>\n                </button>\n                <button\n                  onClick={() => setCashAmount(-Math.abs(cashAmount || 1000))}\n                  className={`flex-1 p-3 rounded-lg border transition-all ${\n                    cashAmount < 0\n                      ? 'border-blue-500 bg-blue-500/20 text-blue-300'\n                      : 'border-primary-600 bg-primary-800/30 text-primary-300'\n                  }`}\n                >\n                  <div className=\"flex items-center justify-center space-x-2\">\n                    <Minus className=\"w-4 h-4\" />\n                    <span className=\"font-medium\">\n                      {existingTrade ? (\n                        // For counter offers, determine labels based on original trade context\n                        (() => {\n                          const originalOffererId = typeof existingTrade.offererUserId === 'string' \n                            ? existingTrade.offererUserId \n                            : (existingTrade.offererUserId as any)?._id || (existingTrade.offererUserId as any)?.id;\n                          const isOriginalReceiver = originalOffererId !== state.currentUser?.id;\n                          \n                          if (isOriginalReceiver) {\n                            // Original receiver countering: if original offerer added cash, say \"I'll add cash\"  \n                            return existingTrade.offererCashAmount >= 0 ? 'I\\'ll add cash' : 'They add cash';\n                          } else {\n                            // Original offerer counter-countering: use their perspective\n                            return 'They add cash';\n                          }\n                        })()\n                      ) : 'They add cash'}\n                    </span>\n                  </div>\n                </button>\n              </div>\n\n              {/* Cash Amount Input */}\n              <div className=\"flex items-center space-x-4\">\n                <DollarSign className={`w-6 h-6 ${cashAmount >= 0 ? 'text-green-400' : 'text-blue-400'}`} />\n                <div className=\"flex-1\">\n                  <input\n                    type=\"number\"\n                    value={Math.abs(cashAmount) === 0 ? '' : Math.abs(cashAmount)}\n                    onChange={(e) => {\n                      const value = Number(e.target.value) || 0;\n                      setCashAmount(cashAmount < 0 ? -value : value);\n                    }}\n                    placeholder=\"0\"\n                    className=\"input-field text-lg font-bold\"\n                  />\n                  <p className=\"text-sm text-primary-400 mt-1\">\n                    {cashAmount > 0 \n                      ? (() => {\n                          if (existingTrade) {\n                            const originalOffererId = typeof existingTrade.offererUserId === 'string' \n                              ? existingTrade.offererUserId \n                              : (existingTrade.offererUserId as any)?._id || (existingTrade.offererUserId as any)?.id;\n                            const isOriginalReceiver = originalOffererId !== state.currentUser?.id;\n                            \n                            if (isOriginalReceiver) {\n                              // Original receiver countering\n                              if (existingTrade.offererCashAmount >= 0) {\n                                return `They're offering $${cashAmount.toLocaleString()} in addition to vehicles`;\n                              } else {\n                                return `You're offering $${cashAmount.toLocaleString()} in addition to vehicles`;\n                              }\n                            } else {\n                              // Original offerer counter-countering\n                              return `You're offering $${cashAmount.toLocaleString()} in addition to vehicles`;\n                            }\n                          } else {\n                            return `You're offering $${cashAmount.toLocaleString()} in addition to vehicles`;\n                          }\n                        })()\n                      : cashAmount < 0 \n                      ? (() => {\n                          if (existingTrade) {\n                            const originalOffererId = typeof existingTrade.offererUserId === 'string' \n                              ? existingTrade.offererUserId \n                              : (existingTrade.offererUserId as any)?._id || (existingTrade.offererUserId as any)?.id;\n                            const isOriginalReceiver = originalOffererId !== state.currentUser?.id;\n                            \n                            if (isOriginalReceiver) {\n                              // Original receiver countering\n                              if (existingTrade.offererCashAmount >= 0) {\n                                return `You're requesting $${Math.abs(cashAmount).toLocaleString()} from them`;\n                              } else {\n                                return `They're offering $${Math.abs(cashAmount).toLocaleString()} to you`;\n                              }\n                            } else {\n                              // Original offerer counter-countering\n                              return `You're requesting $${Math.abs(cashAmount).toLocaleString()} from them`;\n                            }\n                          } else {\n                            return `You're requesting $${Math.abs(cashAmount).toLocaleString()} from the other party`;\n                          }\n                        })()\n                      : \"No cash involved in this trade\"\n                    }\n                  </p>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Message */}\n        <div>\n          <h3 className=\"text-lg font-semibold text-primary-100 mb-4\">Message (Optional)</h3>\n          <textarea\n            value={message}\n            onChange={(e) => setMessage(e.target.value)}\n            placeholder=\"Add a personal message to your trade offer...\"\n            className=\"input-field h-24 resize-none\"\n          />\n        </div>\n\n        {/* Offer Summary */}\n        <div className=\"glass-effect rounded-xl p-4 border border-green-500/30\">\n          <h3 className=\"text-lg font-semibold text-primary-100 mb-4\">Trade Summary</h3>\n          <div className=\"space-y-2\">\n            <div className=\"flex justify-between\">\n              <span className=\"text-primary-300\">Vehicles ({selectedVehicles.length}):</span>\n              <span className=\"text-primary-100 font-medium\">\n                ${selectedVehicles.reduce((sum, vId) => {\n                  const vehicle = availableVehicles.find(v => v.id === vId);\n                  return sum + (vehicle?.customPrice || vehicle?.estimatedValue || 0);\n                }, 0).toLocaleString()}\n              </span>\n            </div>\n            <div className=\"flex justify-between\">\n              <span className=\"text-primary-300\">Cash:</span>\n              <span className={`font-medium ${cashAmount >= 0 ? 'text-green-400' : 'text-red-400'}`}>\n                {cashAmount >= 0 ? '+' : ''}${cashAmount.toLocaleString()}\n              </span>\n            </div>\n            <div className=\"border-t border-primary-700/30 pt-2\">\n              <div className=\"flex justify-between\">\n                <span className=\"text-primary-100 font-semibold\">Total Offer Value:</span>\n                <span className=\"text-green-400 font-bold text-lg\">\n                  ${totalOfferValue.toLocaleString()}\n                </span>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Submit Button */}\n        {error && (\n          <div className=\"glass-effect rounded-xl p-4 border border-red-500/30 bg-red-500/10\">\n            <div className=\"flex items-center space-x-2\">\n              <AlertCircle className=\"w-5 h-5 text-red-400 flex-shrink-0\" />\n              <p className=\"text-red-300\">{error}</p>\n            </div>\n          </div>\n        )}\n        \n        <div className=\"flex space-x-4\">\n          <button\n            onClick={onClose}\n            className=\"btn-secondary flex-1\"\n          >\n            Cancel\n          </button>\n          <button\n            onClick={handleSubmitTrade}\n            disabled={loading || (selectedVehicles.length === 0 && cashAmount === 0)}\n            className=\"btn-primary flex-1\"\n          >\n            {loading ? 'Sending...' : existingTrade ? 'Send Counter Offer' : 'Send Trade Offer'}\n          </button>\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <motion.div\n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      exit={{ opacity: 0 }}\n      className=\"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50\"\n      onClick={(e) => e.target === e.currentTarget && onClose()}\n    >\n      <motion.div\n        initial={{ scale: 0.9, opacity: 0 }}\n        animate={{ scale: 1, opacity: 1 }}\n        exit={{ scale: 0.9, opacity: 0 }}\n        className=\"glass-effect rounded-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto\"\n      >\n        {/* Header */}\n        <div className=\"flex items-center justify-between p-6 border-b border-primary-700/30\">\n          <h1 className=\"text-2xl font-bold text-primary-100\">\n            {existingTrade ? 'Counter Trade Offer' : \n             step === 'select-listing' ? 'Make Trade Offer' : 'Build Your Offer'}\n          </h1>\n          <button\n            onClick={onClose}\n            className=\"p-2 hover:bg-primary-800/50 rounded-full transition-colors\"\n          >\n            <X className=\"w-6 h-6 text-primary-300\" />\n          </button>\n        </div>\n\n        {/* Content */}\n        <div className=\"p-6\">\n          {step === 'select-listing' ? renderListingSelection() : renderOfferBuilder()}\n        </div>\n      </motion.div>\n    </motion.div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}