{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\thato\\\\Downloads\\\\car-app\\\\src\\\\context\\\\AppContext.tsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useReducer, useEffect } from 'react';\nimport { AuthService } from '../services/authService.ts';\nimport { DataService } from '../services/dataService.ts';\nimport ApiService from '../services/apiService.ts';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst initialState = {\n  currentUser: null,\n  vehicles: [],\n  listings: [],\n  auctions: [],\n  trades: [],\n  messages: [],\n  conversations: [],\n  reviews: [],\n  users: [],\n  isAuthenticated: false,\n  loading: false,\n  error: null\n};\nfunction appReducer(state, action) {\n  switch (action.type) {\n    case 'SET_USER':\n      return {\n        ...state,\n        currentUser: action.payload,\n        isAuthenticated: action.payload !== null\n      };\n    case 'SET_LOADING':\n      return {\n        ...state,\n        loading: action.payload\n      };\n    case 'SET_ERROR':\n      return {\n        ...state,\n        error: action.payload\n      };\n    case 'SET_VEHICLES':\n      return {\n        ...state,\n        vehicles: action.payload\n      };\n    case 'ADD_VEHICLE':\n      return {\n        ...state,\n        vehicles: [...state.vehicles, action.payload]\n      };\n    case 'UPDATE_VEHICLE':\n      return {\n        ...state,\n        vehicles: state.vehicles.map(v => v.id === action.payload.id ? action.payload : v)\n      };\n    case 'DELETE_VEHICLE':\n      return {\n        ...state,\n        vehicles: state.vehicles.filter(v => v.id !== action.payload)\n      };\n    case 'SET_LISTINGS':\n      return {\n        ...state,\n        listings: action.payload\n      };\n    case 'ADD_LISTING':\n      return {\n        ...state,\n        listings: [...state.listings, action.payload]\n      };\n    case 'UPDATE_LISTING':\n      return {\n        ...state,\n        listings: state.listings.map(l => l.id === action.payload.id ? action.payload : l)\n      };\n    case 'DELETE_LISTING':\n      return {\n        ...state,\n        listings: state.listings.filter(l => l.id !== action.payload)\n      };\n    case 'SET_TRADES':\n      return {\n        ...state,\n        trades: action.payload\n      };\n    case 'ADD_TRADE':\n      return {\n        ...state,\n        trades: [...state.trades, action.payload]\n      };\n    case 'UPDATE_TRADE':\n      return {\n        ...state,\n        trades: state.trades.map(t => t.id === action.payload.id ? action.payload : t)\n      };\n    case 'SET_MESSAGES':\n      return {\n        ...state,\n        messages: action.payload\n      };\n    case 'ADD_MESSAGE':\n      return {\n        ...state,\n        messages: [...state.messages, action.payload]\n      };\n    case 'SET_CONVERSATIONS':\n      return {\n        ...state,\n        conversations: action.payload\n      };\n    case 'SET_REVIEWS':\n      return {\n        ...state,\n        reviews: action.payload\n      };\n    case 'SET_USERS':\n      return {\n        ...state,\n        users: action.payload\n      };\n    case 'SET_ALL_LISTINGS':\n      return {\n        ...state,\n        listings: action.payload\n      };\n    default:\n      return state;\n  }\n}\nconst AppContext = /*#__PURE__*/createContext(undefined);\nexport function AppProvider({\n  children\n}) {\n  _s();\n  const [state, dispatch] = useReducer(appReducer, initialState);\n  const [activeTab, setActiveTab] = React.useState('garage');\n  useEffect(() => {\n    // Initialize app state\n    const currentUser = AuthService.getCurrentUser();\n    if (currentUser) {\n      dispatch({\n        type: 'SET_USER',\n        payload: currentUser\n      });\n      loadUserData(currentUser.id);\n    }\n    // Always load all users for the seller profiles\n    dispatch({\n      type: 'SET_USERS',\n      payload: DataService.getAllUsers()\n    });\n  }, []);\n  const loadUserData = async userId => {\n    try {\n      // Load user's vehicles\n      const vehicles = await ApiService.getUserVehicles();\n      const vehiclesWithId = vehicles.map(v => ({\n        ...v,\n        id: v._id || v.id\n      }));\n      dispatch({\n        type: 'SET_VEHICLES',\n        payload: vehiclesWithId\n      });\n\n      // Load user's listings\n      const listings = await ApiService.getUserListings();\n      const listingsWithId = listings.map(l => ({\n        ...l,\n        id: l._id || l.id\n      }));\n      dispatch({\n        type: 'SET_LISTINGS',\n        payload: listingsWithId\n      });\n\n      // Load all public listings for browsing\n      const allListingsResponse = await ApiService.getAllListings();\n      const allListingsWithId = allListingsResponse.listings.map(l => ({\n        ...l,\n        id: l._id || l.id\n      }));\n      dispatch({\n        type: 'SET_ALL_LISTINGS',\n        payload: allListingsWithId\n      });\n    } catch (error) {\n      console.error('Error loading user data:', error);\n    }\n  };\n  const login = async (username, password, rememberMe = false) => {\n    dispatch({\n      type: 'SET_LOADING',\n      payload: true\n    });\n    dispatch({\n      type: 'SET_ERROR',\n      payload: null\n    });\n    try {\n      const result = await ApiService.login(username, password);\n      // Convert MongoDB _id to id for frontend compatibility\n      const mongoUser = result.user;\n      const user = {\n        ...mongoUser,\n        id: mongoUser._id || mongoUser.id\n      };\n      dispatch({\n        type: 'SET_USER',\n        payload: user\n      });\n      await loadUserData(user.id);\n      dispatch({\n        type: 'SET_LOADING',\n        payload: false\n      });\n      return {\n        success: true\n      };\n    } catch (error) {\n      dispatch({\n        type: 'SET_ERROR',\n        payload: error.message || 'Login failed'\n      });\n      dispatch({\n        type: 'SET_LOADING',\n        payload: false\n      });\n      return {\n        success: false,\n        error: error.message || 'Login failed'\n      };\n    }\n  };\n  const register = async userData => {\n    dispatch({\n      type: 'SET_LOADING',\n      payload: true\n    });\n    dispatch({\n      type: 'SET_ERROR',\n      payload: null\n    });\n    try {\n      const result = await ApiService.register(userData);\n      // Convert MongoDB _id to id for frontend compatibility\n      const mongoUser = result.user;\n      const user = {\n        ...mongoUser,\n        id: mongoUser._id || mongoUser.id\n      };\n      dispatch({\n        type: 'SET_USER',\n        payload: user\n      });\n      await loadUserData(user.id);\n      dispatch({\n        type: 'SET_LOADING',\n        payload: false\n      });\n      return {\n        success: true\n      };\n    } catch (error) {\n      dispatch({\n        type: 'SET_ERROR',\n        payload: error.message || 'Registration failed'\n      });\n      dispatch({\n        type: 'SET_LOADING',\n        payload: false\n      });\n      return {\n        success: false,\n        error: error.message || 'Registration failed'\n      };\n    }\n  };\n  const logout = () => {\n    ApiService.logout();\n    dispatch({\n      type: 'SET_USER',\n      payload: null\n    });\n    dispatch({\n      type: 'SET_VEHICLES',\n      payload: []\n    });\n    dispatch({\n      type: 'SET_LISTINGS',\n      payload: []\n    });\n    dispatch({\n      type: 'SET_TRADES',\n      payload: []\n    });\n    dispatch({\n      type: 'SET_MESSAGES',\n      payload: []\n    });\n    dispatch({\n      type: 'SET_CONVERSATIONS',\n      payload: []\n    });\n    setActiveTab('garage');\n  };\n  const updateUser = user => {\n    try {\n      console.log('Context updateUser called with:', user);\n      AuthService.updateUser(user);\n      dispatch({\n        type: 'SET_USER',\n        payload: user\n      });\n      console.log('User updated successfully in context');\n    } catch (error) {\n      console.error('Error in context updateUser:', error);\n      throw error;\n    }\n  };\n  const addVehicle = async vehicleData => {\n    if (!state.currentUser) return;\n    try {\n      const newVehicle = await ApiService.createVehicle(vehicleData);\n      dispatch({\n        type: 'ADD_VEHICLE',\n        payload: newVehicle\n      });\n    } catch (error) {\n      console.error('Error adding vehicle:', error);\n    }\n  };\n  const updateVehicle = async updatedVehicle => {\n    try {\n      const vehicle = await ApiService.updateVehicle(updatedVehicle.id, updatedVehicle);\n      dispatch({\n        type: 'UPDATE_VEHICLE',\n        payload: vehicle\n      });\n    } catch (error) {\n      console.error('Error updating vehicle:', error);\n    }\n  };\n  const deleteVehicle = async vehicleId => {\n    try {\n      await ApiService.deleteVehicle(vehicleId);\n      dispatch({\n        type: 'DELETE_VEHICLE',\n        payload: vehicleId\n      });\n    } catch (error) {\n      console.error('Error deleting vehicle:', error);\n    }\n  };\n  const addListing = async listingData => {\n    if (!state.currentUser) return;\n    try {\n      const newListing = await ApiService.createListing(listingData);\n      dispatch({\n        type: 'ADD_LISTING',\n        payload: newListing\n      });\n\n      // Update vehicle to mark as listed\n      const vehicle = state.vehicles.find(v => v.id === listingData.vehicleId);\n      if (vehicle) {\n        const updatedVehicle = {\n          ...vehicle,\n          isListed: true,\n          listingId: newListing.id,\n          updatedAt: new Date().toISOString()\n        };\n        await updateVehicle(updatedVehicle);\n      }\n    } catch (error) {\n      console.error('Error adding listing:', error);\n    }\n  };\n  const updateListing = async updatedListing => {\n    try {\n      const listing = await ApiService.updateListing(updatedListing.id, updatedListing);\n      dispatch({\n        type: 'UPDATE_LISTING',\n        payload: listing\n      });\n    } catch (error) {\n      console.error('Error updating listing:', error);\n    }\n  };\n  const deleteListing = async listingId => {\n    try {\n      const listing = state.listings.find(l => l.id === listingId);\n      await ApiService.deleteListing(listingId);\n      dispatch({\n        type: 'DELETE_LISTING',\n        payload: listingId\n      });\n\n      // Update vehicle to remove listing status\n      if (listing) {\n        const vehicle = state.vehicles.find(v => v.id === listing.vehicleId);\n        if (vehicle) {\n          const updatedVehicle = {\n            ...vehicle,\n            isListed: false,\n            listingId: undefined,\n            updatedAt: new Date().toISOString()\n          };\n          await updateVehicle(updatedVehicle);\n        }\n      }\n    } catch (error) {\n      console.error('Error deleting listing:', error);\n    }\n  };\n  const renewListing = async listingId => {\n    try {\n      const response = await ApiService.renewListing(listingId);\n      const renewedListing = {\n        ...response.listing,\n        id: response.listing.id\n      };\n      dispatch({\n        type: 'UPDATE_LISTING',\n        payload: renewedListing\n      });\n    } catch (error) {\n      console.error('Error renewing listing:', error);\n    }\n  };\n  const incrementListingViews = async listingId => {\n    try {\n      // The backend automatically increments views when getting a listing\n      await ApiService.getListing(listingId);\n\n      // Update local state by incrementing views\n      const listing = state.listings.find(l => l.id === listingId);\n      if (listing) {\n        const updatedListing = {\n          ...listing,\n          views: listing.views + 1,\n          updatedAt: new Date().toISOString()\n        };\n        dispatch({\n          type: 'UPDATE_LISTING',\n          payload: updatedListing\n        });\n      }\n    } catch (error) {\n      console.error('Error incrementing listing views:', error);\n    }\n  };\n  const loadAllListings = async () => {\n    try {\n      // Load all public listings from the API\n      const response = await ApiService.getAllListings();\n      const listingsWithId = response.listings.map(l => {\n        var _l$vehicleId, _l$vehicleId2, _l$sellerId, _l$sellerId2;\n        return {\n          ...l,\n          id: l._id || l.id,\n          vehicleId: ((_l$vehicleId = l.vehicleId) === null || _l$vehicleId === void 0 ? void 0 : _l$vehicleId._id) || ((_l$vehicleId2 = l.vehicleId) === null || _l$vehicleId2 === void 0 ? void 0 : _l$vehicleId2.id) || l.vehicleId,\n          sellerId: ((_l$sellerId = l.sellerId) === null || _l$sellerId === void 0 ? void 0 : _l$sellerId._id) || ((_l$sellerId2 = l.sellerId) === null || _l$sellerId2 === void 0 ? void 0 : _l$sellerId2.id) || l.sellerId,\n          // Include populated vehicle and seller data\n          vehicle: l.vehicleId && typeof l.vehicleId === 'object' ? {\n            ...l.vehicleId,\n            id: l.vehicleId._id || l.vehicleId.id\n          } : null,\n          seller: l.sellerId && typeof l.sellerId === 'object' ? {\n            ...l.sellerId,\n            id: l.sellerId._id || l.sellerId.id\n          } : null\n        };\n      });\n      dispatch({\n        type: 'SET_ALL_LISTINGS',\n        payload: listingsWithId\n      });\n    } catch (error) {\n      console.error('Error loading all listings:', error);\n      // Fallback to empty array if API fails\n      dispatch({\n        type: 'SET_ALL_LISTINGS',\n        payload: []\n      });\n    }\n  };\n  const addReview = async reviewData => {\n    try {\n      const response = await ApiService.createReview(reviewData);\n      // Reload all data to update ratings\n      await loadAllListings();\n    } catch (error) {\n      console.error('Error adding review:', error);\n    }\n  };\n  const getUserProfile = userId => {\n    return state.users.find(u => u.id === userId) || null;\n  };\n  const sendMessage = async messageData => {\n    try {\n      const newMessage = await ApiService.sendMessage(messageData);\n      dispatch({\n        type: 'ADD_MESSAGE',\n        payload: newMessage\n      });\n\n      // For now, we'll skip reloading conversations since the API method doesn't exist yet\n      // TODO: Implement getUserConversations in ApiService\n    } catch (error) {\n      console.error('Error sending message:', error);\n    }\n  };\n  const markMessagesAsRead = async conversationId => {\n    if (!state.currentUser) return;\n    try {\n      await ApiService.markMessagesAsRead(conversationId);\n      const messages = await ApiService.getUserMessages();\n      dispatch({\n        type: 'SET_MESSAGES',\n        payload: messages\n      });\n      // TODO: Reload conversations when API method is available\n    } catch (error) {\n      console.error('Error marking messages as read:', error);\n    }\n  };\n  const addTrade = async tradeData => {\n    try {\n      const newTrade = await ApiService.createTrade(tradeData);\n      dispatch({\n        type: 'ADD_TRADE',\n        payload: newTrade\n      });\n    } catch (error) {\n      console.error('Error adding trade:', error);\n    }\n  };\n  const updateTrade = updatedTrade => {\n    const trade = {\n      ...updatedTrade,\n      updatedAt: new Date().toISOString()\n    };\n    DataService.updateTrade(trade);\n    dispatch({\n      type: 'UPDATE_TRADE',\n      payload: trade\n    });\n  };\n  const value = {\n    state,\n    dispatch,\n    login,\n    register,\n    logout,\n    updateUser,\n    addVehicle,\n    updateVehicle,\n    deleteVehicle,\n    addListing,\n    updateListing,\n    deleteListing,\n    renewListing,\n    incrementListingViews,\n    loadAllListings,\n    addReview,\n    getUserProfile,\n    sendMessage,\n    markMessagesAsRead,\n    addTrade,\n    updateTrade,\n    activeTab,\n    setActiveTab\n  };\n  return /*#__PURE__*/_jsxDEV(AppContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 466,\n    columnNumber: 10\n  }, this);\n}\n_s(AppProvider, \"JpwclWyOxcRvzhtE291B4vMY+pw=\");\n_c = AppProvider;\nexport function useApp() {\n  _s2();\n  const context = useContext(AppContext);\n  if (context === undefined) {\n    throw new Error('useApp must be used within an AppProvider');\n  }\n  return context;\n}\n_s2(useApp, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nvar _c;\n$RefreshReg$(_c, \"AppProvider\");","map":{"version":3,"names":["React","createContext","useContext","useReducer","useEffect","AuthService","DataService","ApiService","jsxDEV","_jsxDEV","initialState","currentUser","vehicles","listings","auctions","trades","messages","conversations","reviews","users","isAuthenticated","loading","error","appReducer","state","action","type","payload","map","v","id","filter","l","t","AppContext","undefined","AppProvider","children","_s","dispatch","activeTab","setActiveTab","useState","getCurrentUser","loadUserData","getAllUsers","userId","getUserVehicles","vehiclesWithId","_id","getUserListings","listingsWithId","allListingsResponse","getAllListings","allListingsWithId","console","login","username","password","rememberMe","result","mongoUser","user","success","message","register","userData","logout","updateUser","log","addVehicle","vehicleData","newVehicle","createVehicle","updateVehicle","updatedVehicle","vehicle","deleteVehicle","vehicleId","addListing","listingData","newListing","createListing","find","isListed","listingId","updatedAt","Date","toISOString","updateListing","updatedListing","listing","deleteListing","renewListing","response","renewedListing","incrementListingViews","getListing","views","loadAllListings","_l$vehicleId","_l$vehicleId2","_l$sellerId","_l$sellerId2","sellerId","seller","addReview","reviewData","createReview","getUserProfile","u","sendMessage","messageData","newMessage","markMessagesAsRead","conversationId","getUserMessages","addTrade","tradeData","newTrade","createTrade","updateTrade","updatedTrade","trade","value","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","useApp","_s2","context","Error","$RefreshReg$"],"sources":["C:/Users/thato/Downloads/car-app/src/context/AppContext.tsx"],"sourcesContent":["import React, { createContext, useContext, useReducer, useEffect, ReactNode } from 'react';\r\nimport { AppState, User, Vehicle, Listing, Auction, Trade, Message, Conversation, Review, NavigationTab } from '../types/index.ts';\r\nimport { AuthService } from '../services/authService.ts';\r\nimport { DataService } from '../services/dataService.ts';\r\nimport ApiService from '../services/apiService.ts';\r\n\r\ninterface AppContextType {\r\n  state: AppState;\r\n  dispatch: React.Dispatch<AppAction>;\r\n  login: (username: string, password: string, rememberMe?: boolean) => Promise<{ success: boolean; error?: string }>;\r\n  register: (userData: Omit<User, 'id' | 'createdAt'>) => Promise<{ success: boolean; error?: string }>;\r\n  logout: () => void;\r\n  updateUser: (user: User) => void;\r\n  addVehicle: (vehicle: Omit<Vehicle, 'id' | 'createdAt' | 'updatedAt'>) => void;\r\n  updateVehicle: (vehicle: Vehicle) => void;\r\n  deleteVehicle: (vehicleId: string) => void;\r\n  addListing: (listing: Omit<Listing, 'id' | 'createdAt' | 'updatedAt' | 'views'>) => void;\r\n  updateListing: (listing: Listing) => void;\r\n  deleteListing: (listingId: string) => void;\r\n  renewListing: (listingId: string) => void;\r\n  incrementListingViews: (listingId: string) => void;\r\n  loadAllListings: () => void;\r\n  addReview: (review: Omit<Review, 'id' | 'createdAt'>) => void;\r\n  getUserProfile: (userId: string) => User | null;\r\n  sendMessage: (message: Omit<Message, 'id' | 'timestamp' | 'read'>) => void;\r\n  markMessagesAsRead: (conversationId: string) => void;\r\n  addTrade: (trade: Omit<Trade, 'id' | 'createdAt' | 'updatedAt'>) => void;\r\n  updateTrade: (trade: Trade) => void;\r\n  activeTab: NavigationTab;\r\n  setActiveTab: (tab: NavigationTab) => void;\r\n}\r\n\r\ntype AppAction =\r\n  | { type: 'SET_USER'; payload: User | null }\r\n  | { type: 'SET_LOADING'; payload: boolean }\r\n  | { type: 'SET_ERROR'; payload: string | null }\r\n  | { type: 'SET_VEHICLES'; payload: Vehicle[] }\r\n  | { type: 'ADD_VEHICLE'; payload: Vehicle }\r\n  | { type: 'UPDATE_VEHICLE'; payload: Vehicle }\r\n  | { type: 'DELETE_VEHICLE'; payload: string }\r\n  | { type: 'SET_LISTINGS'; payload: Listing[] }\r\n  | { type: 'ADD_LISTING'; payload: Listing }\r\n  | { type: 'UPDATE_LISTING'; payload: Listing }\r\n  | { type: 'DELETE_LISTING'; payload: string }\r\n  | { type: 'SET_TRADES'; payload: Trade[] }\r\n  | { type: 'ADD_TRADE'; payload: Trade }\r\n  | { type: 'UPDATE_TRADE'; payload: Trade }\r\n  | { type: 'SET_MESSAGES'; payload: Message[] }\r\n  | { type: 'ADD_MESSAGE'; payload: Message }\r\n  | { type: 'SET_CONVERSATIONS'; payload: Conversation[] }\r\n  | { type: 'SET_REVIEWS'; payload: Review[] }\r\n  | { type: 'SET_USERS'; payload: User[] }\r\n  | { type: 'SET_ALL_LISTINGS'; payload: Listing[] }\r\n  | { type: 'SET_ACTIVE_TAB'; payload: NavigationTab };\r\n\r\nconst initialState: AppState = {\r\n  currentUser: null,\r\n  vehicles: [],\r\n  listings: [],\r\n  auctions: [],\r\n  trades: [],\r\n  messages: [],\r\n  conversations: [],\r\n  reviews: [],\r\n  users: [],\r\n  isAuthenticated: false,\r\n  loading: false,\r\n  error: null,\r\n};\r\n\r\nfunction appReducer(state: AppState, action: AppAction): AppState {\r\n  switch (action.type) {\r\n    case 'SET_USER':\r\n      return {\r\n        ...state,\r\n        currentUser: action.payload,\r\n        isAuthenticated: action.payload !== null,\r\n      };\r\n    case 'SET_LOADING':\r\n      return { ...state, loading: action.payload };\r\n    case 'SET_ERROR':\r\n      return { ...state, error: action.payload };\r\n    case 'SET_VEHICLES':\r\n      return { ...state, vehicles: action.payload };\r\n    case 'ADD_VEHICLE':\r\n      return { ...state, vehicles: [...state.vehicles, action.payload] };\r\n    case 'UPDATE_VEHICLE':\r\n      return {\r\n        ...state,\r\n        vehicles: state.vehicles.map(v => v.id === action.payload.id ? action.payload : v),\r\n      };\r\n    case 'DELETE_VEHICLE':\r\n      return {\r\n        ...state,\r\n        vehicles: state.vehicles.filter(v => v.id !== action.payload),\r\n      };\r\n    case 'SET_LISTINGS':\r\n      return { ...state, listings: action.payload };\r\n    case 'ADD_LISTING':\r\n      return { ...state, listings: [...state.listings, action.payload] };\r\n    case 'UPDATE_LISTING':\r\n      return {\r\n        ...state,\r\n        listings: state.listings.map(l => l.id === action.payload.id ? action.payload : l),\r\n      };\r\n    case 'DELETE_LISTING':\r\n      return {\r\n        ...state,\r\n        listings: state.listings.filter(l => l.id !== action.payload),\r\n      };\r\n    case 'SET_TRADES':\r\n      return { ...state, trades: action.payload };\r\n    case 'ADD_TRADE':\r\n      return { ...state, trades: [...state.trades, action.payload] };\r\n    case 'UPDATE_TRADE':\r\n      return {\r\n        ...state,\r\n        trades: state.trades.map(t => t.id === action.payload.id ? action.payload : t),\r\n      };\r\n    case 'SET_MESSAGES':\r\n      return { ...state, messages: action.payload };\r\n    case 'ADD_MESSAGE':\r\n      return { ...state, messages: [...state.messages, action.payload] };\r\n    case 'SET_CONVERSATIONS':\r\n      return { ...state, conversations: action.payload };\r\n    case 'SET_REVIEWS':\r\n      return { ...state, reviews: action.payload };\r\n    case 'SET_USERS':\r\n      return { ...state, users: action.payload };\r\n    case 'SET_ALL_LISTINGS':\r\n      return { ...state, listings: action.payload };\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nconst AppContext = createContext<AppContextType | undefined>(undefined);\r\n\r\ninterface AppProviderProps {\r\n  children: ReactNode;\r\n}\r\n\r\nexport function AppProvider({ children }: AppProviderProps) {\r\n  const [state, dispatch] = useReducer(appReducer, initialState);\r\n  const [activeTab, setActiveTab] = React.useState<NavigationTab>('garage');\r\n\r\n  useEffect(() => {\r\n    // Initialize app state\r\n    const currentUser = AuthService.getCurrentUser();\r\n    if (currentUser) {\r\n      dispatch({ type: 'SET_USER', payload: currentUser });\r\n      loadUserData(currentUser.id);\r\n    }\r\n    // Always load all users for the seller profiles\r\n    dispatch({ type: 'SET_USERS', payload: DataService.getAllUsers() });\r\n  }, []);\r\n\r\n  const loadUserData = async (userId: string) => {\r\n    try {\r\n      // Load user's vehicles\r\n      const vehicles = await ApiService.getUserVehicles();\r\n      const vehiclesWithId = vehicles.map((v: any) => ({ ...v, id: v._id || v.id }));\r\n      dispatch({ type: 'SET_VEHICLES', payload: vehiclesWithId });\r\n\r\n      // Load user's listings\r\n      const listings = await ApiService.getUserListings();\r\n      const listingsWithId = listings.map((l: any) => ({ ...l, id: l._id || l.id }));\r\n      dispatch({ type: 'SET_LISTINGS', payload: listingsWithId });\r\n\r\n      // Load all public listings for browsing\r\n      const allListingsResponse = await ApiService.getAllListings();\r\n      const allListingsWithId = allListingsResponse.listings.map((l: any) => ({ ...l, id: l._id || l.id }));\r\n      dispatch({ type: 'SET_ALL_LISTINGS', payload: allListingsWithId });\r\n    } catch (error) {\r\n      console.error('Error loading user data:', error);\r\n    }\r\n  };\r\n\r\n  const login = async (username: string, password: string, rememberMe: boolean = false) => {\r\n    dispatch({ type: 'SET_LOADING', payload: true });\r\n    dispatch({ type: 'SET_ERROR', payload: null });\r\n\r\n    try {\r\n      const result = await ApiService.login(username, password);\r\n      // Convert MongoDB _id to id for frontend compatibility\r\n      const mongoUser = result.user as any;\r\n      const user = { ...mongoUser, id: mongoUser._id || mongoUser.id };\r\n      dispatch({ type: 'SET_USER', payload: user });\r\n      await loadUserData(user.id);\r\n      dispatch({ type: 'SET_LOADING', payload: false });\r\n      return { success: true };\r\n    } catch (error: any) {\r\n      dispatch({ type: 'SET_ERROR', payload: error.message || 'Login failed' });\r\n      dispatch({ type: 'SET_LOADING', payload: false });\r\n      return { success: false, error: error.message || 'Login failed' };\r\n    }\r\n  };\r\n\r\n  const register = async (userData: Omit<User, 'id' | 'createdAt'>) => {\r\n    dispatch({ type: 'SET_LOADING', payload: true });\r\n    dispatch({ type: 'SET_ERROR', payload: null });\r\n\r\n    try {\r\n      const result = await ApiService.register(userData);\r\n      // Convert MongoDB _id to id for frontend compatibility\r\n      const mongoUser = result.user as any;\r\n      const user = { ...mongoUser, id: mongoUser._id || mongoUser.id };\r\n      dispatch({ type: 'SET_USER', payload: user });\r\n      await loadUserData(user.id);\r\n      dispatch({ type: 'SET_LOADING', payload: false });\r\n      return { success: true };\r\n    } catch (error: any) {\r\n      dispatch({ type: 'SET_ERROR', payload: error.message || 'Registration failed' });\r\n      dispatch({ type: 'SET_LOADING', payload: false });\r\n      return { success: false, error: error.message || 'Registration failed' };\r\n    }\r\n  };\r\n\r\n  const logout = () => {\r\n    ApiService.logout();\r\n    dispatch({ type: 'SET_USER', payload: null });\r\n    dispatch({ type: 'SET_VEHICLES', payload: [] });\r\n    dispatch({ type: 'SET_LISTINGS', payload: [] });\r\n    dispatch({ type: 'SET_TRADES', payload: [] });\r\n    dispatch({ type: 'SET_MESSAGES', payload: [] });\r\n    dispatch({ type: 'SET_CONVERSATIONS', payload: [] });\r\n    setActiveTab('garage');\r\n  };\r\n\r\n  const updateUser = (user: User) => {\r\n    try {\r\n      console.log('Context updateUser called with:', user);\r\n      AuthService.updateUser(user);\r\n      dispatch({ type: 'SET_USER', payload: user });\r\n      console.log('User updated successfully in context');\r\n    } catch (error) {\r\n      console.error('Error in context updateUser:', error);\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  const addVehicle = async (vehicleData: Omit<Vehicle, 'id' | 'createdAt' | 'updatedAt'>) => {\r\n    if (!state.currentUser) return;\r\n\r\n    try {\r\n      const newVehicle = await ApiService.createVehicle(vehicleData);\r\n      dispatch({ type: 'ADD_VEHICLE', payload: newVehicle });\r\n    } catch (error) {\r\n      console.error('Error adding vehicle:', error);\r\n    }\r\n  };\r\n\r\n  const updateVehicle = async (updatedVehicle: Vehicle) => {\r\n    try {\r\n      const vehicle = await ApiService.updateVehicle(updatedVehicle.id, updatedVehicle);\r\n      dispatch({ type: 'UPDATE_VEHICLE', payload: vehicle });\r\n    } catch (error) {\r\n      console.error('Error updating vehicle:', error);\r\n    }\r\n  };\r\n\r\n  const deleteVehicle = async (vehicleId: string) => {\r\n    try {\r\n      await ApiService.deleteVehicle(vehicleId);\r\n      dispatch({ type: 'DELETE_VEHICLE', payload: vehicleId });\r\n    } catch (error) {\r\n      console.error('Error deleting vehicle:', error);\r\n    }\r\n  };\r\n\r\n  const addListing = async (listingData: Omit<Listing, 'id' | 'createdAt' | 'updatedAt' | 'views'>) => {\r\n    if (!state.currentUser) return;\r\n\r\n    try {\r\n      const newListing = await ApiService.createListing(listingData);\r\n      dispatch({ type: 'ADD_LISTING', payload: newListing });\r\n\r\n      // Update vehicle to mark as listed\r\n      const vehicle = state.vehicles.find(v => v.id === listingData.vehicleId);\r\n      if (vehicle) {\r\n        const updatedVehicle: Vehicle = {\r\n          ...vehicle,\r\n          isListed: true,\r\n          listingId: newListing.id,\r\n          updatedAt: new Date().toISOString(),\r\n        };\r\n        await updateVehicle(updatedVehicle);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error adding listing:', error);\r\n    }\r\n  };\r\n\r\n  const updateListing = async (updatedListing: Listing) => {\r\n    try {\r\n      const listing = await ApiService.updateListing(updatedListing.id, updatedListing);\r\n      dispatch({ type: 'UPDATE_LISTING', payload: listing });\r\n    } catch (error) {\r\n      console.error('Error updating listing:', error);\r\n    }\r\n  };\r\n\r\n  const deleteListing = async (listingId: string) => {\r\n    try {\r\n      const listing = state.listings.find(l => l.id === listingId);\r\n      \r\n      await ApiService.deleteListing(listingId);\r\n      dispatch({ type: 'DELETE_LISTING', payload: listingId });\r\n\r\n      // Update vehicle to remove listing status\r\n      if (listing) {\r\n        const vehicle = state.vehicles.find(v => v.id === listing.vehicleId);\r\n        if (vehicle) {\r\n          const updatedVehicle: Vehicle = {\r\n            ...vehicle,\r\n            isListed: false,\r\n            listingId: undefined,\r\n            updatedAt: new Date().toISOString(),\r\n          };\r\n          await updateVehicle(updatedVehicle);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Error deleting listing:', error);\r\n    }\r\n  };\r\n\r\n  const renewListing = async (listingId: string) => {\r\n    try {\r\n      const response = await ApiService.renewListing(listingId);\r\n      const renewedListing = { ...response.listing, id: response.listing.id };\r\n      dispatch({ type: 'UPDATE_LISTING', payload: renewedListing });\r\n    } catch (error) {\r\n      console.error('Error renewing listing:', error);\r\n    }\r\n  };\r\n\r\n  const incrementListingViews = async (listingId: string) => {\r\n    try {\r\n      // The backend automatically increments views when getting a listing\r\n      await ApiService.getListing(listingId);\r\n      \r\n      // Update local state by incrementing views\r\n      const listing = state.listings.find(l => l.id === listingId);\r\n      if (listing) {\r\n        const updatedListing: Listing = {\r\n          ...listing,\r\n          views: listing.views + 1,\r\n          updatedAt: new Date().toISOString(),\r\n        };\r\n        dispatch({ type: 'UPDATE_LISTING', payload: updatedListing });\r\n      }\r\n    } catch (error) {\r\n      console.error('Error incrementing listing views:', error);\r\n    }\r\n  };\r\n\r\n  const loadAllListings = async () => {\r\n    try {\r\n      // Load all public listings from the API\r\n      const response = await ApiService.getAllListings();\r\n      const listingsWithId = response.listings.map((l: any) => ({ \r\n        ...l, \r\n        id: l._id || l.id,\r\n        vehicleId: l.vehicleId?._id || l.vehicleId?.id || l.vehicleId,\r\n        sellerId: l.sellerId?._id || l.sellerId?.id || l.sellerId,\r\n        // Include populated vehicle and seller data\r\n        vehicle: l.vehicleId && typeof l.vehicleId === 'object' ? { \r\n          ...l.vehicleId, \r\n          id: l.vehicleId._id || l.vehicleId.id \r\n        } : null,\r\n        seller: l.sellerId && typeof l.sellerId === 'object' ? { \r\n          ...l.sellerId, \r\n          id: l.sellerId._id || l.sellerId.id \r\n        } : null\r\n      }));\r\n      \r\n      dispatch({ type: 'SET_ALL_LISTINGS', payload: listingsWithId });\r\n    } catch (error) {\r\n      console.error('Error loading all listings:', error);\r\n      // Fallback to empty array if API fails\r\n      dispatch({ type: 'SET_ALL_LISTINGS', payload: [] });\r\n    }\r\n  };\r\n\r\n  const addReview = async (reviewData: Omit<Review, 'id' | 'createdAt'>) => {\r\n    try {\r\n      const response = await ApiService.createReview(reviewData);\r\n      // Reload all data to update ratings\r\n      await loadAllListings();\r\n    } catch (error) {\r\n      console.error('Error adding review:', error);\r\n    }\r\n  };\r\n\r\n  const getUserProfile = (userId: string): User | null => {\r\n    return state.users.find(u => u.id === userId) || null;\r\n  };\r\n\r\n  const sendMessage = async (messageData: Omit<Message, 'id' | 'timestamp' | 'read'>) => {\r\n    try {\r\n      const newMessage = await ApiService.sendMessage(messageData);\r\n      dispatch({ type: 'ADD_MESSAGE', payload: newMessage });\r\n      \r\n      // For now, we'll skip reloading conversations since the API method doesn't exist yet\r\n      // TODO: Implement getUserConversations in ApiService\r\n    } catch (error) {\r\n      console.error('Error sending message:', error);\r\n    }\r\n  };\r\n\r\n  const markMessagesAsRead = async (conversationId: string) => {\r\n    if (!state.currentUser) return;\r\n    \r\n    try {\r\n      await ApiService.markMessagesAsRead(conversationId);\r\n      const messages = await ApiService.getUserMessages();\r\n      dispatch({ type: 'SET_MESSAGES', payload: messages });\r\n      // TODO: Reload conversations when API method is available\r\n    } catch (error) {\r\n      console.error('Error marking messages as read:', error);\r\n    }\r\n  };\r\n\r\n  const addTrade = async (tradeData: Omit<Trade, 'id' | 'createdAt' | 'updatedAt'>) => {\r\n    try {\r\n      const newTrade = await ApiService.createTrade(tradeData);\r\n      dispatch({ type: 'ADD_TRADE', payload: newTrade });\r\n    } catch (error) {\r\n      console.error('Error adding trade:', error);\r\n    }\r\n  };\r\n\r\n  const updateTrade = (updatedTrade: Trade) => {\r\n    const trade = { ...updatedTrade, updatedAt: new Date().toISOString() };\r\n    DataService.updateTrade(trade);\r\n    dispatch({ type: 'UPDATE_TRADE', payload: trade });\r\n  };\r\n\r\n  const value: AppContextType = {\r\n    state,\r\n    dispatch,\r\n    login,\r\n    register,\r\n    logout,\r\n    updateUser,\r\n    addVehicle,\r\n    updateVehicle,\r\n    deleteVehicle,\r\n    addListing,\r\n    updateListing,\r\n    deleteListing,\r\n    renewListing,\r\n    incrementListingViews,\r\n    loadAllListings,\r\n    addReview,\r\n    getUserProfile,\r\n    sendMessage,\r\n    markMessagesAsRead,\r\n    addTrade,\r\n    updateTrade,\r\n    activeTab,\r\n    setActiveTab,\r\n  };\r\n\r\n  return <AppContext.Provider value={value}>{children}</AppContext.Provider>;\r\n}\r\n\r\nexport function useApp() {\r\n  const context = useContext(AppContext);\r\n  if (context === undefined) {\r\n    throw new Error('useApp must be used within an AppProvider');\r\n  }\r\n  return context;\r\n} "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}